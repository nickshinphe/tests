/**
 * Copyright 2023 Phenix Real Time Solutions, Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("phenix-web-sdk",[],e):"object"==typeof exports?exports["phenix-web-sdk"]=e():t["phenix-web-sdk"]=e()}(window,function(){return n=[function(t,e,n){function i(t){var e;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var r,s;t.exports=(r=[function(t,e,n){void 0!==(e=function(){"use strict";function o(t){var t=t.split("."),e=[];return u.forEach(t,function(t){e=e.concat(function(t){for(var e="",n=[],i=0,r=0;r<t.length;r++)if("["===t[r]){if(i++,!u.u(e)||1<i)return[t];e&&(n.push(e),e="")}else if("]"===t[r]){if(0!=--i)return[t];n.push(e),e=""}else{if(r===t.length-1)return[t];e+=t[r]}return n}(t))}),e}function u(){}u.clone=function(t){return u.isArray(t)?t.slice():u.h(t)?u.assign({},t):t},u.get=function(t,e,n){if(u.isNullOrUndefined(t))return n;a(t,"objectToTraverse");var i=e;if(u.u(i))i=o(e);else if(!u.isArray(i))throw new Error("Unsupported path type "+typeof e);e=u.reduce(i,function(t,e){if(u.h(t)||u.isArray(t))return t[e]},t);return u.isUndefined(e)?n:e},u.set=function(t,e,r){if(u.h(t)){a(t,"objectToTraverse");var n=t,s=e;if(u.u(s))s=o(e);else if(!u.isArray(s))throw new Error("Unsupported path type "+typeof e);u.forEach(s,function(t,i){(function(t,e,n){if(u.v(parseInt(e))&&u.isArray(t))return t[e]=n;if(u.u(e)&&u.h(t))return t[e]=n;throw new Error("Unsupported type "+typeof e+" when setting property or index")})(n,t,function(t,e){if(t.length-1===i)return r;var n=t[i],t=t[i+1];if(u.isArray(e[n])||u.h(e[n]))return e[n];if(!u.isArray(e[n])&&u.v(parseInt(t)))return[];if(!u.h(e[n])&&u.u(t))return{};throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,n)),n=n[t]})}return t},u.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){var t;if(u.g(e))return t=i.concat(Array.prototype.slice.call(arguments)),e.apply(n,t);throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]")}},u.now=function(){return(new Date).getTime()},u.utc=function(t){return u.v(t)?t:t?Math.floor(t):NaN},u.isoString=function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+u.pad(t.getUTCMonth()+1,2)+"-"+u.pad(t.getUTCDate(),2)+"T"+u.pad(t.getUTCHours(),2)+":"+u.pad(t.getUTCMinutes(),2)+":"+u.pad(t.getUTCSeconds(),2)+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},u.map=function(t,n){a(t,"collection");var i=[];return t.constructor===Array?u.forEach(t,function(t,e){u.u(n)&&u.h(t)?i.push(t[n]):u.g(n)&&i.push(n(t,e))}):u.forOwn(t,function(t,e){u.g(n)&&i.push(n(t,e))}),i},u.values=function(t){return!u.h(t)||u.isArray(t)?[]:u.map(t,function(t){return t})},u.keys=function(t){return u.h(t)||u.isArray(t)?u.map(t,function(t,e){return e}):[]},u.forEach=function(t,e){if(!u.g(e))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof e+"]");s(t,"collection");for(var n=0;n<t.length;n++)if(!1===e(t[n],n))return},u.forOwn=function(t,e){if(!u.g(e))throw new Error("Callback must be a function. Received ["+typeof e+"]");a(t,"objectWithProperties");for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];if((t.hasOwnProperty(r)||Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r))return}},u.argumentsToArray=function(t){if(!u.h(t)||!t.length)throw new Error("Collection must be arguments. Received ["+typeof t+"]");for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},u.assign=function(n){u.isNullOrUndefined(n)&&(n={}),a(n,"target");var t=u.argumentsToArray(arguments);return t.shift(),u.forEach(t,function(t,e){u.isNullOrUndefined(t)||(a(t,"_.assign(sources["+e+"])"),u.forOwn(t,function(t,e){n[e]=t}))}),n},u.includes=function(t,e){if(u.u(t))return h(e,"Includes value and search parameter"),-1<t.indexOf(e);if(u.isUndefined(t)||u.isUndefined(e))return!1;function n(t){if(t===e)return!(i=!0)}a(t,"collection");var i=!1;return t.constructor===Array?u.forEach(t,n):u.forOwn(t,n),i},u.reduce=function(t,n,e){a(t,"collection");var i=e===u.noop()?null:e;return t.constructor===Array?u.forEach(t,function(t,e){i=n(i,t,e)}):u.forOwn(t,function(t,e){i=n(i,t,e)}),i},u.sample=function(t){return s(t,"collection"),t[Math.floor(Math.random()*t.length)]},u.uniqueId=function(){return(u.now()*Math.random()).toString()},u.find=function(t,n,i){s(t,"collection");var r=void 0;return u.forEach(t,function(t,e){if(n(t)&&(i||0)<=e)return r=t,!1}),r},u.findIndex=function(t,n,i){s(t,"collection");var r=-1;return u.forEach(t,function(t,e){if(n(t,e)&&(i||0)<=e)return r=e,!1}),r},u.filter=function(t,e){s(t,"collection");var n=[];return u.forEach(t,function(t){e(t)&&n.push(t)}),n},u.remove=function(t,e){return s(t,"collection"),u.filter(t,function(t){return!e(t)})},u.take=function(t,e){return s(t,"collection"),t.slice(0,e)},u.hasDifferences=function(t,e,n){return 0<u.findDifferences(t,e,n).length},u.findDifferences=function(n,i,r){function t(t,e){o[e]=1,(u.h(t)||u.isArray(t))&&r?u.hasIndexOrKey(i,e)&&u.sameTypes(n[e],i[e])&&!u.hasDifferences(n[e],i[e],r)||s.push(e):n[e]!==i[e]&&s.push(e)}var s=[],o={};if(u.isArray(n)&&u.isArray(i))n.length>i.length?u.forEach(n,t):u.forEach(i,t);else{if(!u.h(n)||!u.h(i)||u.isArray(n)||u.isArray(i))throw new Error("Object types do not match");u.forOwn(n,t),u.forOwn(i,function(t,e){o.hasOwnProperty(e)||s.push(e)})}return s},u.hasIndexOrKey=function(t,e){return u.isArray(t)?t.length>parseInt(e):!!u.h(t)&&t.hasOwnProperty(e)},u.startsWith=function(t,e){return h(t,"value"),h(e,"prefix"),0===t.indexOf(e)},u.endsWith=function(t,e){h(t,"value"),h(e,"postfix");var n=t.length-e.length;return 0<=n&&t.indexOf(e,n)===n},u.sameTypes=function(t,e){return u.isNullOrUndefined(t)||u.isNullOrUndefined(e)?u.isNullOrUndefined(t)&&u.isNullOrUndefined(e):u.isArray(t)||u.isArray(e)?u.isArray(t)&&u.isArray(e):typeof t==typeof e},u.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},u.noop=function(){},u.h=function(t){return null!==t&&"object"==typeof t},u.isArray=function(t){return!!u.h(t)&&t.constructor===Array},u.u=function(t){return"string"==typeof t},u.v=function(t){return!isNaN(t)&&"number"==typeof t},u.k=function(t){return"boolean"==typeof t},u.g=function(t){return"function"==typeof t},u.isNullOrUndefined=function(t){return null===t||u.isUndefined(t)},u.isUndefined=function(t){return void 0===t},u.getEnumName=function(t,e){var n=null,t=u.map(t,function(t){return t});return u.v(e)?n=u.find(t,function(t){return t.id===e}):u.u(e)&&(n=u.find(t,function(t){return t.name.toLowerCase()===e.toLowerCase()})),n?n.name:null},u.toString=function(t){if(u.u(t))return t;if(u.k(t))return t?"true":"false";if(u.v(t))return t.toString();var n,e="";if(t)if(u.g(t.toString))e=t.toString();else if(u.h(t.toString))try{e=t.toString()}catch(t){e="[object invalid toString()]"}return 0!==e.indexOf("[object")?e:(n=[],e+JSON.stringify(t,function(t,e){if(u.h(e)&&!u.isNullOrUndefined(e)){if(u.includes(n,e))return"<recursive>";n.push(e)}return""===t?e:u.toString(e)}))},u.pad=function(t,e){r(t,"value"),r(e,"numberToPad");for(var n=t.toString().length,i=0;i<e-n;i++)t="0"+t.toString();return t.toString()},u.addEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!i):t.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent&&t.attachEvent("on"+e,n)},u.removeEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!i):t.removeEventListener?t.removeEventListener(e,n,!!i):t.detachEvent&&t.detachEvent("on"+e,n)};var s=function(t){if(!u.isArray(t))throw new Error("Input must be an array. Received ["+typeof t+"]")},r=function(t,e){if(h(e,"name"),!u.v(t))throw new Error(e+" must be a number. Received ["+typeof t+"]")},a=function(t,e){if(h(e,"name"),!u.h(t))throw new Error("collection type not supported - "+e+" must be an array or object. Received ["+typeof t+"]")},c=function(t,e){if(h(e,"name"),!u.g(t))throw new Error(e+" must be a function. Received ["+typeof t+"]")},h=function(t,e){if(!u.u(e))throw new Error("Name must be a string. Received ["+typeof e+"]");if(!u.u(t))throw new Error(e+" must be a string. Received ["+typeof t+"]")};return u}.apply(e,[]))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(t){"use strict";return t}.apply(e,n))&&(t.exports=e)}],s={},i.m=r,i.c=s,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1))},function(t,e,n){function i(t){var e;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var r,s;t.exports=(r=[function(t,e,n){n=[n(2)];void 0!==(e=function(i){function r(){}return r.prototype.h=function(t,e){if(r.prototype.u("name",e),!i.h(t))throw new Error('"'+e+'" must be an object. Received ['+typeof t+"]")},r.prototype.isArray=function(t,e){if(r.prototype.u("name",e),!i.isArray(t))throw new Error('"'+e+'" must be an array. Received ['+typeof t+"]")},r.prototype.u=function(t,e){if(!i.u(e))throw new Error('"name" must be a string. Received ['+typeof e+"]");if(!i.u(t))throw new Error('"'+e+'" must be a string. Received ['+typeof t+"]")},r.prototype.k=function(t,e){if(r.prototype.u("name",e),!i.k(t))throw new Error('"'+e+'" must be a boolean. Received ['+typeof t+"]")},r.prototype.v=function(t,e){if(r.prototype.u("name",e),!i.v(t))throw new Error('"'+e+'" must be a number. Received ['+typeof t+"]")},r.prototype.g=function(t,e){if(r.prototype.u("name",e),!i.g(t))throw new Error('"'+e+'" must be a function. Received ['+typeof t+"]")},r.prototype.S=function(t,e){r.prototype.R(t,e)},r.prototype.R=function(t,e){if(r.prototype.u("name",e),r.prototype.u(t,e),""===t)throw new Error('"'+e+'" must not be empty')},r.prototype.I=function(t,e,n){if(r.prototype.u("name",n),!i.h(t))throw new Error('"'+n+'" must be an instance. Received ['+typeof t+"]");if(!(t instanceof e))throw new Error('"'+n+'" must be a valid instance of class '+i.get(e,["name"],"undefined"))},r.prototype.T=function(t,e){if(r.prototype.u("name",e),i.isUndefined(t))throw new Error('"'+e+'" must not be undefined')},r.prototype.M=function(t,e,n){r.prototype.R(n,"name");e=i.getEnumName(e,t);if(i.isNullOrUndefined(e))throw new Error('"'+n+'" must be a valid type. Unable to locate type ['+t+"]");return e},r.prototype.C=function(t,n){r.prototype.u(n,"name"),r.prototype.isArray(t,n),i.forEach(t,function(t,e){r.prototype.u(t,n+"["+e+"]")})},new r}.apply(e,n))&&(t.exports=e)},function(t,e,n){void 0!==(e=function(){"use strict";function o(t){var t=t.split("."),e=[];return u.forEach(t,function(t){e=e.concat(function(t){for(var e="",n=[],i=0,r=0;r<t.length;r++)if("["===t[r]){if(i++,!u.u(e)||1<i)return[t];e&&(n.push(e),e="")}else if("]"===t[r]){if(0!=--i)return[t];n.push(e),e=""}else{if(r===t.length-1)return[t];e+=t[r]}return n}(t))}),e}function u(){}u.clone=function(t){return u.isArray(t)?t.slice():u.h(t)?u.assign({},t):t},u.get=function(t,e,n){if(u.isNullOrUndefined(t))return n;a(t,"objectToTraverse");var i=e;if(u.u(i))i=o(e);else if(!u.isArray(i))throw new Error("Unsupported path type "+typeof e);e=u.reduce(i,function(t,e){if(u.h(t)||u.isArray(t))return t[e]},t);return u.isUndefined(e)?n:e},u.set=function(t,e,r){if(u.h(t)){a(t,"objectToTraverse");var n=t,s=e;if(u.u(s))s=o(e);else if(!u.isArray(s))throw new Error("Unsupported path type "+typeof e);u.forEach(s,function(t,i){(function(t,e,n){if(u.v(parseInt(e))&&u.isArray(t))return t[e]=n;if(u.u(e)&&u.h(t))return t[e]=n;throw new Error("Unsupported type "+typeof e+" when setting property or index")})(n,t,function(t,e){if(t.length-1===i)return r;var n=t[i],t=t[i+1];if(u.isArray(e[n])||u.h(e[n]))return e[n];if(!u.isArray(e[n])&&u.v(parseInt(t)))return[];if(!u.h(e[n])&&u.u(t))return{};throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,n)),n=n[t]})}return t},u.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){var t;if(u.g(e))return t=i.concat(Array.prototype.slice.call(arguments)),e.apply(n,t);throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]")}},u.now=function(){return(new Date).getTime()},u.utc=function(t){return u.v(t)?t:t?Math.floor(t):NaN},u.isoString=function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+u.pad(t.getUTCMonth()+1,2)+"-"+u.pad(t.getUTCDate(),2)+"T"+u.pad(t.getUTCHours(),2)+":"+u.pad(t.getUTCMinutes(),2)+":"+u.pad(t.getUTCSeconds(),2)+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},u.map=function(t,n){a(t,"collection");var i=[];return t.constructor===Array?u.forEach(t,function(t,e){u.u(n)&&u.h(t)?i.push(t[n]):u.g(n)&&i.push(n(t,e))}):u.forOwn(t,function(t,e){u.g(n)&&i.push(n(t,e))}),i},u.values=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.values argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t){return t})},u.keys=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.keys argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t,e){return e})},u.forEach=function(t,e){if(!u.g(e))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof e+"]");s(t,"collection");for(var n=0;n<t.length;n++)if(!1===e(t[n],n))return},u.forOwn=function(t,e){if(!u.g(e))throw new Error("Callback must be a function. Received ["+typeof e+"]");a(t,"objectWithProperties");for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];if((t.hasOwnProperty(r)||Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r))return}},u.argumentsToArray=function(t){if(!u.h(t)||!t.length)throw new Error("Collection must be arguments. Received ["+typeof t+"]");for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},u.assign=function(n){u.isNullOrUndefined(n)&&(n={}),a(n,"target");var t=u.argumentsToArray(arguments);return t.shift(),u.forEach(t,function(t,e){u.isNullOrUndefined(t)||(a(t,"_.assign(sources["+e+"])"),u.forOwn(t,function(t,e){n[e]=t}))}),n},u.includes=function(t,e){if(u.u(t))return h(e,"Includes value and search parameter"),-1<t.indexOf(e);if(u.isUndefined(t)||u.isUndefined(e))return!1;function n(t){if(t===e)return!(i=!0)}a(t,"collection");var i=!1;return t.constructor===Array?u.forEach(t,n):u.forOwn(t,n),i},u.reduce=function(t,n,e){a(t,"collection");var i=e===u.noop()?null:e;return t.constructor===Array?u.forEach(t,function(t,e){i=n(i,t,e)}):u.forOwn(t,function(t,e){i=n(i,t,e)}),i},u.sample=function(t){return s(t,"collection"),t[Math.floor(Math.random()*t.length)]},u.uniqueId=function(){return(u.now()*Math.random()).toString()},u.find=function(t,n,i){s(t,"collection");var r=void 0;return u.forEach(t,function(t,e){if(n(t)&&(i||0)<=e)return r=t,!1}),r},u.findIndex=function(t,n,i){s(t,"collection");var r=-1;return u.forEach(t,function(t,e){if(n(t,e)&&(i||0)<=e)return r=e,!1}),r},u.filter=function(t,e){s(t,"collection");var n=[];return u.forEach(t,function(t){e(t)&&n.push(t)}),n},u.remove=function(t,e){return s(t,"collection"),u.filter(t,function(t){return!e(t)})},u.take=function(t,e){return s(t,"collection"),t.slice(0,e)},u.hasDifferences=function(t,e,n){return 0<u.findDifferences(t,e,n).length},u.findDifferences=function(n,i,r){function t(t,e){o[e]=1,(u.h(t)||u.isArray(t))&&r?u.hasIndexOrKey(i,e)&&u.sameTypes(n[e],i[e])&&!u.hasDifferences(n[e],i[e],r)||s.push(e):n[e]!==i[e]&&s.push(e)}var s=[],o={};if(u.isArray(n)&&u.isArray(i))n.length>i.length?u.forEach(n,t):u.forEach(i,t);else{if(!u.h(n)||!u.h(i)||u.isArray(n)||u.isArray(i))throw new Error("Object types do not match");u.forOwn(n,t),u.forOwn(i,function(t,e){o.hasOwnProperty(e)||s.push(e)})}return s},u.hasIndexOrKey=function(t,e){return u.isArray(t)?t.length>parseInt(e):!!u.h(t)&&t.hasOwnProperty(e)},u.startsWith=function(t,e){return h(t,"value"),h(e,"prefix"),0===t.indexOf(e)},u.endsWith=function(t,e){h(t,"value"),h(e,"postfix");var n=t.length-e.length;return t.indexOf(e,n)===n},u.sameTypes=function(t,e){return u.isNullOrUndefined(t)||u.isNullOrUndefined(e)?u.isNullOrUndefined(t)&&u.isNullOrUndefined(e):u.isArray(t)||u.isArray(e)?u.isArray(t)&&u.isArray(e):typeof t==typeof e},u.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},u.noop=function(){},u.h=function(t){return null!==t&&"object"==typeof t},u.isArray=function(t){return!!u.h(t)&&t.constructor===Array},u.u=function(t){return"string"==typeof t},u.v=function(t){return!isNaN(t)&&"number"==typeof t},u.k=function(t){return"boolean"==typeof t},u.g=function(t){return"function"==typeof t},u.isNullOrUndefined=function(t){return null===t||u.isUndefined(t)},u.isUndefined=function(t){return void 0===t},u.getEnumName=function(t,e){var n=null,t=u.map(t,function(t){return t});return u.v(e)?n=u.find(t,function(t){return t.id===e}):u.u(e)&&(n=u.find(t,function(t){return t.name.toLowerCase()===e.toLowerCase()})),n?n.name:null},u.toString=function(t){if(u.u(t))return t;if(u.k(t))return t?"true":"false";if(u.v(t))return t.toString();var n,e="";if(t)if(u.g(t.toString))e=t.toString();else if(u.h(t.toString))try{e=t.toString()}catch(t){e="[object invalid toString()]"}return 0!==e.indexOf("[object")?e:(n=[],e+JSON.stringify(t,function(t,e){if(u.h(e)&&!u.isNullOrUndefined(e)){if(u.includes(n,e))return"<recursive>";n.push(e)}return""===t?e:u.toString(e)}))},u.pad=function(t,e){r(t,"value"),r(e,"numberToPad");for(var n=t.toString().length,i=0;i<e-n;i++)t="0"+t.toString();return t.toString()},u.addEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!i):t.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent&&t.attachEvent("on"+e,n)},u.removeEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!i):t.removeEventListener?t.removeEventListener(e,n,!!i):t.detachEvent&&t.detachEvent("on"+e,n)};var s=function(t){if(!u.isArray(t))throw new Error("Input must be an array. Received ["+typeof t+"]")},r=function(t,e){if(h(e,"name"),!u.v(t))throw new Error(e+" must be a number. Received ["+typeof t+"]")},a=function(t,e){if(h(e,"name"),!u.h(t))throw new Error("collection type not supported - "+e+" must be an array or object. Received ["+typeof t+"]")},c=function(t,e){if(h(e,"name"),!u.g(t))throw new Error(e+" must be a function. Received ["+typeof t+"]")},h=function(t,e){if(!u.u(e))throw new Error("Name must be a string. Received ["+typeof e+"]");if(!u.u(t))throw new Error(e+" must be a string. Received ["+typeof t+"]")};return u}.apply(e,[]))&&(t.exports=e)},function(t,e,n){n=[n(1)];void 0!==(e=function(t){"use strict";return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(t){return t}.apply(e,n))&&(t.exports=e)}],s={},i.m=r,i.c=s,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3))},function(t,e,n){function i(t){var e;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var r,s;t.exports=(r=[function(t,e,n){n=[n(5)];void 0!==(e=function(t){"use strict";return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0),n(4)];void 0!==(e=function(t,e){"use strict";function n(t){e.g(t,"cleanup"),this.q=t}return n.prototype.dispose=function(){return this.q.call()},n.prototype.toString=function(){return t.toString(this)},n}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(n){"use strict";function t(){this.P=[]}return t.prototype.add=function(t){if(!t||!n.g(t.dispose))throw new Error('"disposable" must be a disposable or implement dispose');this.P.push(t)},t.prototype.dispose=function(){var e=[];return n.forEach(this.P,function(t){e.push(t.dispose())}),this.P=[],e},t.prototype.toString=function(){return n.toString(this)},t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(i){function r(){}return r.prototype.h=function(t,e){if(r.prototype.u("name",e),!i.h(t))throw new Error('"'+e+'" must be an object. Received ['+typeof t+"]")},r.prototype.isArray=function(t,e){if(r.prototype.u("name",e),!i.isArray(t))throw new Error('"'+e+'" must be an array. Received ['+typeof t+"]")},r.prototype.u=function(t,e){if(!i.u(e))throw new Error('"name" must be a string. Received ['+typeof e+"]");if(!i.u(t))throw new Error('"'+e+'" must be a string. Received ['+typeof t+"]")},r.prototype.k=function(t,e){if(r.prototype.u("name",e),!i.k(t))throw new Error('"'+e+'" must be a boolean. Received ['+typeof t+"]")},r.prototype.v=function(t,e){if(r.prototype.u("name",e),!i.v(t))throw new Error('"'+e+'" must be a number. Received ['+typeof t+"]")},r.prototype.g=function(t,e){if(r.prototype.u("name",e),!i.g(t))throw new Error('"'+e+'" must be a function. Received ['+typeof t+"]")},r.prototype.S=function(t,e){r.prototype.R(t,e)},r.prototype.R=function(t,e){if(r.prototype.u("name",e),r.prototype.u(t,e),""===t)throw new Error('"'+e+'" must not be empty')},r.prototype.I=function(t,e,n){if(r.prototype.u("name",n),!i.h(t))throw new Error('"'+n+'" must be an instance. Received ['+typeof t+"]");if(!(t instanceof e))throw new Error('"'+n+'" must be a valid instance of class '+i.get(e,["name"],"undefined"))},r.prototype.T=function(t,e){if(r.prototype.u("name",e),i.isUndefined(t))throw new Error('"'+e+'" must not be undefined')},r.prototype.M=function(t,e,n){r.prototype.R(n,"name");e=i.getEnumName(e,t);if(i.isNullOrUndefined(e))throw new Error('"'+n+'" must be a valid type. Unable to locate type ['+t+"]");return e},r.prototype.C=function(t,n){r.prototype.u(n,"name"),r.prototype.isArray(t,n),i.forEach(t,function(t,e){r.prototype.u(t,n+"["+e+"]")})},new r}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(3)];void 0!==(e=function(t){return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){void 0!==(e=function(){"use strict";function o(t){var t=t.split("."),e=[];return u.forEach(t,function(t){e=e.concat(function(t){for(var e="",n=[],i=0,r=0;r<t.length;r++)if("["===t[r]){if(i++,!u.u(e)||1<i)return[t];e&&(n.push(e),e="")}else if("]"===t[r]){if(0!=--i)return[t];n.push(e),e=""}else{if(r===t.length-1)return[t];e+=t[r]}return n}(t))}),e}function u(){}u.clone=function(t){return u.isArray(t)?t.slice():u.h(t)?u.assign({},t):t},u.get=function(t,e,n){if(u.isNullOrUndefined(t))return n;a(t,"objectToTraverse");var i=e;if(u.u(i))i=o(e);else if(!u.isArray(i))throw new Error("Unsupported path type "+typeof e);e=u.reduce(i,function(t,e){if(u.h(t)||u.isArray(t))return t[e]},t);return u.isUndefined(e)?n:e},u.set=function(t,e,r){if(u.h(t)){a(t,"objectToTraverse");var n=t,s=e;if(u.u(s))s=o(e);else if(!u.isArray(s))throw new Error("Unsupported path type "+typeof e);u.forEach(s,function(t,i){(function(t,e,n){if(u.v(parseInt(e))&&u.isArray(t))return t[e]=n;if(u.u(e)&&u.h(t))return t[e]=n;throw new Error("Unsupported type "+typeof e+" when setting property or index")})(n,t,function(t,e){if(t.length-1===i)return r;var n=t[i],t=t[i+1];if(u.isArray(e[n])||u.h(e[n]))return e[n];if(!u.isArray(e[n])&&u.v(parseInt(t)))return[];if(!u.h(e[n])&&u.u(t))return{};throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,n)),n=n[t]})}return t},u.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){var t;if(u.g(e))return t=i.concat(Array.prototype.slice.call(arguments)),e.apply(n,t);throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]")}},u.now=function(){return(new Date).getTime()},u.utc=function(t){return u.v(t)?t:t?Math.floor(t):NaN},u.isoString=function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+u.pad(t.getUTCMonth()+1,2)+"-"+u.pad(t.getUTCDate(),2)+"T"+u.pad(t.getUTCHours(),2)+":"+u.pad(t.getUTCMinutes(),2)+":"+u.pad(t.getUTCSeconds(),2)+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},u.map=function(t,n){a(t,"collection");var i=[];return t.constructor===Array?u.forEach(t,function(t,e){u.u(n)&&u.h(t)?i.push(t[n]):u.g(n)&&i.push(n(t,e))}):u.forOwn(t,function(t,e){u.g(n)&&i.push(n(t,e))}),i},u.values=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.values argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t){return t})},u.keys=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.keys argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t,e){return e})},u.forEach=function(t,e){if(!u.g(e))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof e+"]");s(t,"collection");for(var n=0;n<t.length;n++)if(!1===e(t[n],n))return},u.forOwn=function(t,e){if(!u.g(e))throw new Error("Callback must be a function. Received ["+typeof e+"]");a(t,"objectWithProperties");for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];if((t.hasOwnProperty(r)||Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r))return}},u.argumentsToArray=function(t){if(!u.h(t)||!t.length)throw new Error("Collection must be arguments. Received ["+typeof t+"]");for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},u.assign=function(n){u.isNullOrUndefined(n)&&(n={}),a(n,"target");var t=u.argumentsToArray(arguments);return t.shift(),u.forEach(t,function(t,e){u.isNullOrUndefined(t)||(a(t,"_.assign(sources["+e+"])"),u.forOwn(t,function(t,e){n[e]=t}))}),n},u.includes=function(t,e){if(u.u(t))return h(e,"Includes value and search parameter"),-1<t.indexOf(e);if(u.isUndefined(t)||u.isUndefined(e))return!1;function n(t){if(t===e)return!(i=!0)}a(t,"collection");var i=!1;return t.constructor===Array?u.forEach(t,n):u.forOwn(t,n),i},u.reduce=function(t,n,e){a(t,"collection");var i=e===u.noop()?null:e;return t.constructor===Array?u.forEach(t,function(t,e){i=n(i,t,e)}):u.forOwn(t,function(t,e){i=n(i,t,e)}),i},u.sample=function(t){return s(t,"collection"),t[Math.floor(Math.random()*t.length)]},u.uniqueId=function(){return(u.now()*Math.random()).toString()},u.find=function(t,n,i){s(t,"collection");var r=void 0;return u.forEach(t,function(t,e){if(n(t)&&(i||0)<=e)return r=t,!1}),r},u.findIndex=function(t,n,i){s(t,"collection");var r=-1;return u.forEach(t,function(t,e){if(n(t,e)&&(i||0)<=e)return r=e,!1}),r},u.filter=function(t,e){s(t,"collection");var n=[];return u.forEach(t,function(t){e(t)&&n.push(t)}),n},u.remove=function(t,e){return s(t,"collection"),u.filter(t,function(t){return!e(t)})},u.take=function(t,e){return s(t,"collection"),t.slice(0,e)},u.hasDifferences=function(t,e,n){return 0<u.findDifferences(t,e,n).length},u.findDifferences=function(n,i,r){function t(t,e){o[e]=1,(u.h(t)||u.isArray(t))&&r?u.hasIndexOrKey(i,e)&&u.sameTypes(n[e],i[e])&&!u.hasDifferences(n[e],i[e],r)||s.push(e):n[e]!==i[e]&&s.push(e)}var s=[],o={};if(u.isArray(n)&&u.isArray(i))n.length>i.length?u.forEach(n,t):u.forEach(i,t);else{if(!u.h(n)||!u.h(i)||u.isArray(n)||u.isArray(i))throw new Error("Object types do not match");u.forOwn(n,t),u.forOwn(i,function(t,e){o.hasOwnProperty(e)||s.push(e)})}return s},u.hasIndexOrKey=function(t,e){return u.isArray(t)?t.length>parseInt(e):!!u.h(t)&&t.hasOwnProperty(e)},u.startsWith=function(t,e){return h(t,"value"),h(e,"prefix"),0===t.indexOf(e)},u.endsWith=function(t,e){h(t,"value"),h(e,"postfix");var n=t.length-e.length;return t.indexOf(e,n)===n},u.sameTypes=function(t,e){return u.isNullOrUndefined(t)||u.isNullOrUndefined(e)?u.isNullOrUndefined(t)&&u.isNullOrUndefined(e):u.isArray(t)||u.isArray(e)?u.isArray(t)&&u.isArray(e):typeof t==typeof e},u.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},u.noop=function(){},u.h=function(t){return null!==t&&"object"==typeof t},u.isArray=function(t){return!!u.h(t)&&t.constructor===Array},u.u=function(t){return"string"==typeof t},u.v=function(t){return!isNaN(t)&&"number"==typeof t},u.k=function(t){return"boolean"==typeof t},u.g=function(t){return"function"==typeof t},u.isNullOrUndefined=function(t){return null===t||u.isUndefined(t)},u.isUndefined=function(t){return void 0===t},u.getEnumName=function(t,e){var n=null,t=u.map(t,function(t){return t});return u.v(e)?n=u.find(t,function(t){return t.id===e}):u.u(e)&&(n=u.find(t,function(t){return t.name.toLowerCase()===e.toLowerCase()})),n?n.name:null},u.toString=function(t){if(u.u(t))return t;if(u.k(t))return t?"true":"false";if(u.v(t))return t.toString();var n,e="";if(t)if(u.g(t.toString))e=t.toString();else if(u.h(t.toString))try{e=t.toString()}catch(t){e="[object invalid toString()]"}return 0!==e.indexOf("[object")?e:(n=[],e+JSON.stringify(t,function(t,e){if(u.h(e)&&!u.isNullOrUndefined(e)){if(u.includes(n,e))return"<recursive>";n.push(e)}return""===t?e:u.toString(e)}))},u.pad=function(t,e){r(t,"value"),r(e,"numberToPad");for(var n=t.toString().length,i=0;i<e-n;i++)t="0"+t.toString();return t.toString()},u.addEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!i):t.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent&&t.attachEvent("on"+e,n)},u.removeEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!i):t.removeEventListener?t.removeEventListener(e,n,!!i):t.detachEvent&&t.detachEvent("on"+e,n)};var s=function(t){if(!u.isArray(t))throw new Error("Input must be an array. Received ["+typeof t+"]")},r=function(t,e){if(h(e,"name"),!u.v(t))throw new Error(e+" must be a number. Received ["+typeof t+"]")},a=function(t,e){if(h(e,"name"),!u.h(t))throw new Error("collection type not supported - "+e+" must be an array or object. Received ["+typeof t+"]")},c=function(t,e){if(h(e,"name"),!u.g(t))throw new Error(e+" must be a function. Received ["+typeof t+"]")},h=function(t,e){if(!u.u(e))throw new Error("Name must be a string. Received ["+typeof e+"]");if(!u.u(t))throw new Error(e+" must be a string. Received ["+typeof t+"]")};return u}.apply(e,[]))&&(t.exports=e)},function(t,e,n){n=[n(1),n(2)];void 0!==(e=function(t,e){return{Disposable:t,DisposableList:e}}.apply(e,n))&&(t.exports=e)}],s={},i.m=r,i.c=s,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6))},function(t,e,n){n=[n(0),n(10),n(68)],e=function(r,t,n){"use strict";var s=window,o=new t(navigator.userAgent).detect(),t=s.RTCPeerConnection,e=s.RTCSessionDescription,i=s.RTCIceCandidate,u=null,a=null,c=null,h=null,f=null,l=null,d=!1,p=function(){};switch(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(u=r.bind(g,null,"input")),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(a=r.bind(g,null,"output")),(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||s.getUserMedia)&&(c=function(t,e,n){var i=r.bind(m,this,t,e,n);return navigator&&navigator.mediaDevices&&r.g(navigator.mediaDevices.getUserMedia)?navigator.mediaDevices.getUserMedia(t).then(function(t){return i(t)}).catch(function(t){return n(t)}):navigator&&r.g(navigator.getUserMedia)?navigator.getUserMedia(t,i,n):s&&r.g(s.getUserMedia)?s.getUserMedia(t,i,n):void 0}),o.browser){case"Firefox":h=y,l=b,p=function(t,e,n,i){t.getStats(e).then(n).catch(i)},d=!0;break;case"Opera":h=y,l=b,p=function(t,e,n,i){t.getStats(e).then(n).catch(i)},d=!0;break;case"Chrome":h=y,l=b,p=function(t,e,n,i){o.version<=66?t.getStats(n,e,i):t.getStats(e).then(n).catch(i)},d=!0;break;case"Edge":h=y,l=b,p=function(t,e,n,i){t.getStats(e).then(n).catch(i)},d=!0;break;case"Safari":h=function(t,e,n){return r.h(e)&&(t.__phenixHasPlayedWebRtc=!0),y(t,e,n)},f=function(t,e){return t.__phenixHasPlayedWebRtc?((t=new n(t,e,!1).getElement()).play(),t):w(t,e)},l=b,p=function(t,e,n,i){t.getStats(e).then(n).catch(i)},d=!0;break;case"ReactNative":h=function(){},f=function(){},l=function(){},p=function(t,e,n,i){t.getStats(e).then(n).catch(i)},d=!0;break;default:!function(){console.log.apply(console,arguments)}("Browser version does not appear to be WebRTC-capable",o.browser,o.version)}function m(r,s,o,u){setTimeout(function(){for(var t=u.getTracks(),e=0;e<t.length;e++){var n=t[e];if(n.onended=function(t){t.timeStamp,n.id,n.label},n.id,n.label,t[e].kind,t[e].readyState,"ended"===n.readyState)return v("User media not available",o,t)}var i=(r.audio?1:0)+(r.video?1:0);if(t.length!==i)return v("Unable to get all requested user media.",o,t);s(u)},100)}function v(t,e,n){try{var i=new Error(t);i.code="unavailable",e(i)}finally{for(var r=n,s=0;s<r.length;s++)r[s].stop()}}function g(n,i){if("input"!==n&&"output"!==n)throw new Error("Unsupported device type "+n);navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices().then(function(t){var e=[];t.forEach(function(t){t.kind==="audio"+n?e.push({kind:"audio",id:t.deviceId,label:t.label}):t.kind==="video"+n&&e.push({kind:"video",id:t.deviceId,label:t.label})}),i(e)})}function y(t,e,n){void 0!==t.srcObject?t.srcObject=e:void 0!==t.mozSrcObject?t.mozSrcObject=e:void 0!==t.src&&(t.src=URL.createObjectURL(e));e=t.play();return void 0===e?"function"==typeof n&&n():e.then(function(){"function"==typeof n&&n()}).catch(function(t){"function"==typeof n&&n(t)}),t}function w(t,e){return t.src=e,t.play(),t}function b(t,e){return t.src=e.src,t}function k(){var t=r.get(s,["navigator","userAgent"],"");return/iPad|iPhone|iPod/.test(t)&&!s.MSStream}return{global:s,browser:o.browser,browserVersion:o.version,RTCPeerConnection:t,RTCSessionDescription:e,RTCIceCandidate:i,getSources:u,getDestinations:a,getUserMedia:c,getStats:p,attachMediaStream:h,attachUriStream:f||w,reattachMediaStream:l,webrtcSupported:d,isAndroid:(t=r.get(s,["navigator","userAgent"],""),/(android)/i.test(t)),isIOS:k(),isMobile:(e=r.get(s,["navigator","userAgent"],""),k()||/Android|webOS|BlackBerry|IEMobile|Opera Mini|mobile|CriOS/i.test(e)),shouldUseNativeHls:(i=r.get(s,["navigator","userAgent"],""),u=/SamsungBrowser/.test(i),k()||"Safari"===o.browser||u),PhenixFlashVideo:n}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(24),n(48),n(49)],e=function(t,e,n){"use strict";return{Observable:t,ObservableArray:e,ObservableMonitor:n}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){function i(t){var e;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var r,s;t.exports=(r=[function(t,e,n){n=[n(8)];void 0!==(e=function(t){"use strict";return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(4)];void 0!==(e=function(t){return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(7)];void 0!==(e=function(s,o,n){"use strict";function t(){this.O=[]}function i(e,n,t){function i(){s.forEach(r.O,function(t){t.apply(n,e)})}var r=this;s.isNullOrUndefined(e)&&(e=[]),o.isArray(e,"args"),t?setTimeout(function(){i(),t()},0):i()}return t.prototype.fire=function(t,e){i.call(this,t,e)},t.prototype.fireAsync=function(t,e,n){i.call(this,t,e,n||function(){})},t.prototype.listen=function(e){var t=this;return o.g(e,"listener"),t.O.push(e),new n.Disposable(function(){t.O=s.remove(t.O,function(t){return t===e})})},t.prototype.size=function(){return this.O.length},t.prototype.dispose=function(){this.O=[]},t.prototype.toString=function(){return"Event|"+this.size()},t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2)];void 0!==(e=function(i,r,n){"use strict";function t(){this.A={}}return t.prototype.fire=function(t,e,n){r.R(t,"name"),i.includes(i.keys(this.A),t)&&this.A[t].fire(e,n)},t.prototype.fireAsync=function(t,e,n){r.R(t,"name"),i.includes(i.keys(this.A),t)&&this.A[t].fireAsync(e,n)},t.prototype.listen=function(t,e){return r.R(t,"name"),(i.includes(i.keys(this.A),t)?this.A[t]:this.A[t]=new n).listen(e)},t.prototype.size=function(t){return i.includes(i.keys(this.A),t)?this.A[t].size():0},t.prototype.dispose=function(){i.forOwn(this.A,function(t){t.dispose()}),this.A={}},t.prototype.toString=function(){return"NamedEvents|"+i.keys(this.A).length},t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(i){function r(){}return r.prototype.h=function(t,e){if(r.prototype.u("name",e),!i.h(t))throw new Error('"'+e+'" must be an object. Received ['+typeof t+"]")},r.prototype.isArray=function(t,e){if(r.prototype.u("name",e),!i.isArray(t))throw new Error('"'+e+'" must be an array. Received ['+typeof t+"]")},r.prototype.u=function(t,e){if(!i.u(e))throw new Error('"name" must be a string. Received ['+typeof e+"]");if(!i.u(t))throw new Error('"'+e+'" must be a string. Received ['+typeof t+"]")},r.prototype.k=function(t,e){if(r.prototype.u("name",e),!i.k(t))throw new Error('"'+e+'" must be a boolean. Received ['+typeof t+"]")},r.prototype.v=function(t,e){if(r.prototype.u("name",e),!i.v(t))throw new Error('"'+e+'" must be a number. Received ['+typeof t+"]")},r.prototype.g=function(t,e){if(r.prototype.u("name",e),!i.g(t))throw new Error('"'+e+'" must be a function. Received ['+typeof t+"]")},r.prototype.S=function(t,e){r.prototype.R(t,e)},r.prototype.R=function(t,e){if(r.prototype.u("name",e),r.prototype.u(t,e),""===t)throw new Error('"'+e+'" must not be empty')},r.prototype.I=function(t,e,n){if(r.prototype.u("name",n),!i.h(t))throw new Error('"'+n+'" must be an instance. Received ['+typeof t+"]");if(!(t instanceof e))throw new Error('"'+n+'" must be a valid instance of class '+i.get(e,["name"],"undefined"))},r.prototype.T=function(t,e){if(r.prototype.u("name",e),i.isUndefined(t))throw new Error('"'+e+'" must not be undefined')},r.prototype.M=function(t,e,n){r.prototype.R(n,"name");e=i.getEnumName(e,t);if(i.isNullOrUndefined(e))throw new Error('"'+n+'" must be a valid type. Unable to locate type ['+t+"]");return e},r.prototype.C=function(t,n){r.prototype.u(n,"name"),r.prototype.isArray(t,n),i.forEach(t,function(t,e){r.prototype.u(t,n+"["+e+"]")})},new r}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)];void 0!==(e=function(t,e){"use strict";function n(t){e.g(t,"cleanup"),this.q=t}return n.prototype.dispose=function(){return this.q.call()},n.prototype.toString=function(){return t.toString(this)},n}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(n){"use strict";function t(){this.P=[]}return t.prototype.add=function(t){if(!t||!n.g(t.dispose))throw new Error('"disposable" must be a disposable or implement dispose');this.P.push(t)},t.prototype.dispose=function(){var e=[];return n.forEach(this.P,function(t){e.push(t.dispose())}),this.P=[],e},t.prototype.toString=function(){return n.toString(this)},t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(5),n(6)];void 0!==(e=function(t,e){return{Disposable:t,DisposableList:e}}.apply(e,n))&&(t.exports=e)},function(t,e,n){void 0!==(e=function(){"use strict";function o(t){var t=t.split("."),e=[];return u.forEach(t,function(t){e=e.concat(function(t){for(var e="",n=[],i=0,r=0;r<t.length;r++)if("["===t[r]){if(i++,!u.u(e)||1<i)return[t];e&&(n.push(e),e="")}else if("]"===t[r]){if(0!=--i)return[t];n.push(e),e=""}else{if(r===t.length-1)return[t];e+=t[r]}return n}(t))}),e}function u(){}u.clone=function(t){return u.isArray(t)?t.slice():u.h(t)?u.assign({},t):t},u.get=function(t,e,n){if(u.isNullOrUndefined(t))return n;a(t,"objectToTraverse");var i=e;if(u.u(i))i=o(e);else if(!u.isArray(i))throw new Error("Unsupported path type "+typeof e);e=u.reduce(i,function(t,e){if(u.h(t)||u.isArray(t))return t[e]},t);return u.isUndefined(e)?n:e},u.set=function(t,e,r){if(u.h(t)){a(t,"objectToTraverse");var n=t,s=e;if(u.u(s))s=o(e);else if(!u.isArray(s))throw new Error("Unsupported path type "+typeof e);u.forEach(s,function(t,i){(function(t,e,n){if(u.v(parseInt(e))&&u.isArray(t))return t[e]=n;if(u.u(e)&&u.h(t))return t[e]=n;throw new Error("Unsupported type "+typeof e+" when setting property or index")})(n,t,function(t,e){if(t.length-1===i)return r;var n=t[i],t=t[i+1];if(u.isArray(e[n])||u.h(e[n]))return e[n];if(!u.isArray(e[n])&&u.v(parseInt(t)))return[];if(!u.h(e[n])&&u.u(t))return{};throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,n)),n=n[t]})}return t},u.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){var t;if(u.g(e))return t=i.concat(Array.prototype.slice.call(arguments)),e.apply(n,t);throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]")}},u.now=function(){return(new Date).getTime()},u.utc=function(t){return u.v(t)?t:t?Math.floor(t):NaN},u.isoString=function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+u.pad(t.getUTCMonth()+1,2)+"-"+u.pad(t.getUTCDate(),2)+"T"+u.pad(t.getUTCHours(),2)+":"+u.pad(t.getUTCMinutes(),2)+":"+u.pad(t.getUTCSeconds(),2)+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},u.map=function(t,n){a(t,"collection");var i=[];return t.constructor===Array?u.forEach(t,function(t,e){u.u(n)&&u.h(t)?i.push(t[n]):u.g(n)&&i.push(n(t,e))}):u.forOwn(t,function(t,e){u.g(n)&&i.push(n(t,e))}),i},u.values=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.values argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t){return t})},u.keys=function(t){if(!u.h(t)||u.isArray(t))throw new Error("_.keys argument, Collection, must be an object. Received ["+typeof t+"]");return u.map(t,function(t,e){return e})},u.forEach=function(t,e){if(!u.g(e))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof e+"]");s(t,"collection");for(var n=0;n<t.length;n++)if(!1===e(t[n],n))return},u.forOwn=function(t,e){if(!u.g(e))throw new Error("Callback must be a function. Received ["+typeof e+"]");a(t,"objectWithProperties");for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];if((t.hasOwnProperty(r)||Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r))return}},u.argumentsToArray=function(t){if(!u.h(t)||!t.length)throw new Error("Collection must be arguments. Received ["+typeof t+"]");for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},u.assign=function(n){u.isNullOrUndefined(n)&&(n={}),a(n,"target");var t=u.argumentsToArray(arguments);return t.shift(),u.forEach(t,function(t,e){u.isNullOrUndefined(t)||(a(t,"_.assign(sources["+e+"])"),u.forOwn(t,function(t,e){n[e]=t}))}),n},u.includes=function(t,e){if(u.u(t))return h(e,"Includes value and search parameter"),-1<t.indexOf(e);if(u.isUndefined(t)||u.isUndefined(e))return!1;function n(t){if(t===e)return!(i=!0)}a(t,"collection");var i=!1;return t.constructor===Array?u.forEach(t,n):u.forOwn(t,n),i},u.reduce=function(t,n,e){a(t,"collection");var i=e===u.noop()?null:e;return t.constructor===Array?u.forEach(t,function(t,e){i=n(i,t,e)}):u.forOwn(t,function(t,e){i=n(i,t,e)}),i},u.sample=function(t){return s(t,"collection"),t[Math.floor(Math.random()*t.length)]},u.uniqueId=function(){return(u.now()*Math.random()).toString()},u.find=function(t,n,i){s(t,"collection");var r=void 0;return u.forEach(t,function(t,e){if(n(t)&&(i||0)<=e)return r=t,!1}),r},u.findIndex=function(t,n,i){s(t,"collection");var r=-1;return u.forEach(t,function(t,e){if(n(t,e)&&(i||0)<=e)return r=e,!1}),r},u.filter=function(t,e){s(t,"collection");var n=[];return u.forEach(t,function(t){e(t)&&n.push(t)}),n},u.remove=function(t,e){return s(t,"collection"),u.filter(t,function(t){return!e(t)})},u.take=function(t,e){return s(t,"collection"),t.slice(0,e)},u.hasDifferences=function(t,e,n){return 0<u.findDifferences(t,e,n).length},u.findDifferences=function(n,i,r){function t(t,e){o[e]=1,(u.h(t)||u.isArray(t))&&r?u.hasIndexOrKey(i,e)&&u.sameTypes(n[e],i[e])&&!u.hasDifferences(n[e],i[e],r)||s.push(e):n[e]!==i[e]&&s.push(e)}var s=[],o={};if(u.isArray(n)&&u.isArray(i))n.length>i.length?u.forEach(n,t):u.forEach(i,t);else{if(!u.h(n)||!u.h(i)||u.isArray(n)||u.isArray(i))throw new Error("Object types do not match");u.forOwn(n,t),u.forOwn(i,function(t,e){o.hasOwnProperty(e)||s.push(e)})}return s},u.hasIndexOrKey=function(t,e){return u.isArray(t)?t.length>parseInt(e):!!u.h(t)&&t.hasOwnProperty(e)},u.startsWith=function(t,e){return h(t,"value"),h(e,"prefix"),0===t.indexOf(e)},u.endsWith=function(t,e){h(t,"value"),h(e,"postfix");var n=t.length-e.length;return t.indexOf(e,n)===n},u.sameTypes=function(t,e){return u.isNullOrUndefined(t)||u.isNullOrUndefined(e)?u.isNullOrUndefined(t)&&u.isNullOrUndefined(e):u.isArray(t)||u.isArray(e)?u.isArray(t)&&u.isArray(e):typeof t==typeof e},u.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},u.noop=function(){},u.h=function(t){return null!==t&&"object"==typeof t},u.isArray=function(t){return!!u.h(t)&&t.constructor===Array},u.u=function(t){return"string"==typeof t},u.v=function(t){return!isNaN(t)&&"number"==typeof t},u.k=function(t){return"boolean"==typeof t},u.g=function(t){return"function"==typeof t},u.isNullOrUndefined=function(t){return null===t||u.isUndefined(t)},u.isUndefined=function(t){return void 0===t},u.getEnumName=function(t,e){var n=null,t=u.map(t,function(t){return t});return u.v(e)?n=u.find(t,function(t){return t.id===e}):u.u(e)&&(n=u.find(t,function(t){return t.name.toLowerCase()===e.toLowerCase()})),n?n.name:null},u.toString=function(t){if(u.u(t))return t;if(u.k(t))return t?"true":"false";if(u.v(t))return t.toString();var n,e="";if(t)if(u.g(t.toString))e=t.toString();else if(u.h(t.toString))try{e=t.toString()}catch(t){e="[object invalid toString()]"}return 0!==e.indexOf("[object")?e:(n=[],e+JSON.stringify(t,function(t,e){if(u.h(e)&&!u.isNullOrUndefined(e)){if(u.includes(n,e))return"<recursive>";n.push(e)}return""===t?e:u.toString(e)}))},u.pad=function(t,e){r(t,"value"),r(e,"numberToPad");for(var n=t.toString().length,i=0;i<e-n;i++)t="0"+t.toString();return t.toString()},u.addEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!i):t.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent&&t.attachEvent("on"+e,n)},u.removeEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!i):t.removeEventListener?t.removeEventListener(e,n,!!i):t.detachEvent&&t.detachEvent("on"+e,n)};var s=function(t){if(!u.isArray(t))throw new Error("Input must be an array. Received ["+typeof t+"]")},r=function(t,e){if(h(e,"name"),!u.v(t))throw new Error(e+" must be a number. Received ["+typeof t+"]")},a=function(t,e){if(h(e,"name"),!u.h(t))throw new Error("collection type not supported - "+e+" must be an array or object. Received ["+typeof t+"]")},c=function(t,e){if(h(e,"name"),!u.g(t))throw new Error(e+" must be a function. Received ["+typeof t+"]")},h=function(t,e){if(!u.u(e))throw new Error("Name must be a string. Received ["+typeof e+"]");if(!u.u(t))throw new Error(e+" must be a string. Received ["+typeof t+"]")};return u}.apply(e,[]))&&(t.exports=e)},function(t,e,n){n=[n(2),n(3)];void 0!==(e=function(t,e){return{Event:t,NamedEvents:e}}.apply(e,n))&&(t.exports=e)}],s={},i.m=r,i.c=s,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9))},function(t,e,n){e=function(){"use strict";return{networkStates:{networkEmpty:{id:0,name:"NETWORK_EMPTY"},networkIdle:{id:1,name:"NETWORK_IDLE"},networkLoading:{id:2,name:"NETWORK_LOADING"},networkNoSource:{id:3,name:"NETWORK_NO_SOURCE"}},types:{realTime:{id:0,name:"real-time"},dash:{id:1,name:"dash"},hls:{id:2,name:"hls"},rtmp:{id:3,name:"rtmp"}},streamEvents:{playerEnded:{id:0,name:"playerended"},playerError:{id:1,name:"playererror"},stopped:{id:2,name:"stopped"}},rendererEvents:{ended:{id:0,name:"ended"},error:{id:1,name:"error"},autoMuted:{id:2,name:"autoMuted"},failedToPlay:{id:3,name:"failedToPlay"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(45)],e=function(t){"use strict";return t()}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(66)],e=function(t){"use strict";return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(44),n(47),n(16)],e=function(t,e,n){"use strict";return{createLogger:function(){return new t},Logger:t,ConsoleAppender:e,level:n.level}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){function i(t){var e;return(s[t]||(e=s[t]={i:t,l:!1,exports:{}},r[t].call(e.exports,e,e.exports,i),e.l=!0,e)).exports}var r,s;t.exports=(r=[function(t,e,n){n=[n(2)];void 0!==(e=function(s){"use strict";function t(t){this.U=t||""}return t.prototype.detect=function(){var t="Unknown",e="?",n=this.U.match(/(Chrome|Chromium|Firefox|Opera|Safari)+\//),i=this.U.match(/(Chrome|Chromium|Firefox|Version)+\/([0-9]+)\./),r=!1;return n&&2<=n.length?t=n[1]:this.U.match(/^\(?Mozilla/)&&(t="Mozilla",this.U.match(/MSIE/)||this.U.match(/; Trident\/.*rv:[0-9]+/))&&(t="IE",(i=this.U.match(/MSIE ([0-9]+)/))?(e=parseInt(i[1],10),(i=this.U.match(/MSIE [0-9]+.*MSIE ([0-9]+)/))&&(e=parseInt(i[1],10))):(i=this.U.match(/rv:([0-9]+)/))&&(e=parseInt(i[1],10))),"Chrome"===t&&this.U.match(/OPR\//)?(t="Opera",i=this.U.match(/(OPR)\/([0-9]+)\./)):"Chrome"===t&&this.U.match(/Edge\//)?(t="Edge",i=this.U.match(/(Edge)\/([0-9]+)\./)):"Firefox"!==t&&"IE"!==t||!this.U.match(/Opera/)?"Mozilla"===t&&(this.U.match(/iphone|ipod|ipad/i)||this.U.match(/AppleWebKit/i))&&(e=this.U.match(/iphone|ipod|ipad/i)?(t="Safari",parseInt(s.get(this.U.match(/OS\s([0-9]+)/),[1]),10)):(t="Safari",13),r=!0):(t="Opera",i=this.U.match(/(Opera) ([0-9]+)\./)),"Chrome"===t&&(this.U.match(/; wv/)||this.U.match(/Android/)&&this.U.match(/Version\/[0-9].[0-9]/))&&(r=!0),"IE"!==t&&i&&3<=i.length&&(e=parseInt(i[2],10)),"ReactNative"===navigator.product&&(t="ReactNative",e=navigator.productSub||"?"),{browser:t,version:e,isWebview:r}},t}.apply(e,n))&&(t.exports=e)},function(t,e,n){void 0!==(e=function(){"use strict";function o(t){var t=t.split("."),e=[];return u.forEach(t,function(t){e=e.concat(function(t){for(var e="",n=[],i=0,r=0;r<t.length;r++)if("["===t[r]){if(i++,!u.u(e)||1<i)return[t];e&&(n.push(e),e="")}else if("]"===t[r]){if(0!=--i)return[t];n.push(e),e=""}else{if(r===t.length-1)return[t];e+=t[r]}return n}(t))}),e}function u(){}u.clone=function(t){return u.isArray(t)?t.slice():u.h(t)?u.assign({},t):t},u.get=function(t,e,n){if(u.isNullOrUndefined(t))return n;a(t,"objectToTraverse");var i=e;if(u.u(i))i=o(e);else if(!u.isArray(i))throw new Error("Unsupported path type "+typeof e);e=u.reduce(i,function(t,e){if(u.h(t)||u.isArray(t))return t[e]},t);return u.isUndefined(e)?n:e},u.set=function(t,e,r){if(u.h(t)){a(t,"objectToTraverse");var n=t,s=e;if(u.u(s))s=o(e);else if(!u.isArray(s))throw new Error("Unsupported path type "+typeof e);u.forEach(s,function(t,i){(function(t,e,n){if(u.v(parseInt(e))&&u.isArray(t))return t[e]=n;if(u.u(e)&&u.h(t))return t[e]=n;throw new Error("Unsupported type "+typeof e+" when setting property or index")})(n,t,function(t,e){if(t.length-1===i)return r;var n=t[i],t=t[i+1];if(u.isArray(e[n])||u.h(e[n]))return e[n];if(!u.isArray(e[n])&&u.v(parseInt(t)))return[];if(!u.h(e[n])&&u.u(t))return{};throw new Error("Unsupported type "+typeof n+" when setting property or index")}(s,n)),n=n[t]})}return t},u.bind=function(e,n){var i=Array.prototype.slice.call(arguments,2);return function(){var t;if(u.g(e))return t=i.concat(Array.prototype.slice.call(arguments)),e.apply(n,t);throw new TypeError("_.bind - callback must be a function. Received ["+typeof e+"]")}},u.now=function(){return(new Date).getTime()},u.utc=function(t){return u.v(t)?t:t?Math.floor(t):NaN},u.isoString=function(){var t=new Date;return t.toISOString?t.toISOString():t.getUTCFullYear()+"-"+u.pad(t.getUTCMonth()+1,2)+"-"+u.pad(t.getUTCDate(),2)+"T"+u.pad(t.getUTCHours(),2)+":"+u.pad(t.getUTCMinutes(),2)+":"+u.pad(t.getUTCSeconds(),2)+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},u.map=function(t,n){a(t,"collection");var i=[];return t.constructor===Array?u.forEach(t,function(t,e){u.u(n)&&u.h(t)?i.push(t[n]):u.g(n)&&i.push(n(t,e))}):u.forOwn(t,function(t,e){u.g(n)&&i.push(n(t,e))}),i},u.values=function(t){return!u.h(t)||u.isArray(t)?[]:u.map(t,function(t){return t})},u.keys=function(t){return u.h(t)||u.isArray(t)?u.map(t,function(t,e){return e}):[]},u.forEach=function(t,e){if(!u.g(e))throw new Error("_.forEach argument, Callback, must be a function. Received ["+typeof e+"]");s(t,"collection");for(var n=0;n<t.length;n++)if(!1===e(t[n],n))return},u.forOwn=function(t,e){if(!u.g(e))throw new Error("Callback must be a function. Received ["+typeof e+"]");a(t,"objectWithProperties");for(var n=Object.keys(t),i=0;i<n.length;i++){var r=n[i];if((t.hasOwnProperty(r)||Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r))return}},u.argumentsToArray=function(t){if(!u.h(t)||!t.length)throw new Error("Collection must be arguments. Received ["+typeof t+"]");for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},u.assign=function(n){u.isNullOrUndefined(n)&&(n={}),a(n,"target");var t=u.argumentsToArray(arguments);return t.shift(),u.forEach(t,function(t,e){u.isNullOrUndefined(t)||(a(t,"_.assign(sources["+e+"])"),u.forOwn(t,function(t,e){n[e]=t}))}),n},u.includes=function(t,e){if(u.u(t))return h(e,"Includes value and search parameter"),-1<t.indexOf(e);if(u.isUndefined(t)||u.isUndefined(e))return!1;function n(t){if(t===e)return!(i=!0)}a(t,"collection");var i=!1;return t.constructor===Array?u.forEach(t,n):u.forOwn(t,n),i},u.reduce=function(t,n,e){a(t,"collection");var i=e===u.noop()?null:e;return t.constructor===Array?u.forEach(t,function(t,e){i=n(i,t,e)}):u.forOwn(t,function(t,e){i=n(i,t,e)}),i},u.sample=function(t){return s(t,"collection"),t[Math.floor(Math.random()*t.length)]},u.uniqueId=function(){return(u.now()*Math.random()).toString()},u.find=function(t,n,i){s(t,"collection");var r=void 0;return u.forEach(t,function(t,e){if(n(t)&&(i||0)<=e)return r=t,!1}),r},u.findIndex=function(t,n,i){s(t,"collection");var r=-1;return u.forEach(t,function(t,e){if(n(t,e)&&(i||0)<=e)return r=e,!1}),r},u.filter=function(t,e){s(t,"collection");var n=[];return u.forEach(t,function(t){e(t)&&n.push(t)}),n},u.remove=function(t,e){return s(t,"collection"),u.filter(t,function(t){return!e(t)})},u.take=function(t,e){return s(t,"collection"),t.slice(0,e)},u.hasDifferences=function(t,e,n){return 0<u.findDifferences(t,e,n).length},u.findDifferences=function(n,i,r){function t(t,e){o[e]=1,(u.h(t)||u.isArray(t))&&r?u.hasIndexOrKey(i,e)&&u.sameTypes(n[e],i[e])&&!u.hasDifferences(n[e],i[e],r)||s.push(e):n[e]!==i[e]&&s.push(e)}var s=[],o={};if(u.isArray(n)&&u.isArray(i))n.length>i.length?u.forEach(n,t):u.forEach(i,t);else{if(!u.h(n)||!u.h(i)||u.isArray(n)||u.isArray(i))throw new Error("Object types do not match");u.forOwn(n,t),u.forOwn(i,function(t,e){o.hasOwnProperty(e)||s.push(e)})}return s},u.hasIndexOrKey=function(t,e){return u.isArray(t)?t.length>parseInt(e):!!u.h(t)&&t.hasOwnProperty(e)},u.startsWith=function(t,e){return h(t,"value"),h(e,"prefix"),0===t.indexOf(e)},u.endsWith=function(t,e){h(t,"value"),h(e,"postfix");var n=t.length-e.length;return t.indexOf(e,n)===n},u.sameTypes=function(t,e){return u.isNullOrUndefined(t)||u.isNullOrUndefined(e)?u.isNullOrUndefined(t)&&u.isNullOrUndefined(e):u.isArray(t)||u.isArray(e)?u.isArray(t)&&u.isArray(e):typeof t==typeof e},u.freeze=function(t){return"freeze"in Object?Object.freeze(t):t},u.noop=function(){},u.h=function(t){return null!==t&&"object"==typeof t},u.isArray=function(t){return!!u.h(t)&&t.constructor===Array},u.u=function(t){return"string"==typeof t},u.v=function(t){return!isNaN(t)&&"number"==typeof t},u.k=function(t){return"boolean"==typeof t},u.g=function(t){return"function"==typeof t},u.isNullOrUndefined=function(t){return null===t||u.isUndefined(t)},u.isUndefined=function(t){return void 0===t},u.getEnumName=function(t,e){var n=null,t=u.map(t,function(t){return t});return u.v(e)?n=u.find(t,function(t){return t.id===e}):u.u(e)&&(n=u.find(t,function(t){return t.name.toLowerCase()===e.toLowerCase()})),n?n.name:null},u.toString=function(t){if(u.u(t))return t;if(u.k(t))return t?"true":"false";if(u.v(t))return t.toString();var n,e="";if(t)if(u.g(t.toString))e=t.toString();else if(u.h(t.toString))try{e=t.toString()}catch(t){e="[object invalid toString()]"}return 0!==e.indexOf("[object")?e:(n=[],e+JSON.stringify(t,function(t,e){if(u.h(e)&&!u.isNullOrUndefined(e)){if(u.includes(n,e))return"<recursive>";n.push(e)}return""===t?e:u.toString(e)}))},u.pad=function(t,e){r(t,"value"),r(e,"numberToPad");for(var n=t.toString().length,i=0;i<e-n;i++)t="0"+t.toString();return t.toString()},u.addEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixAddEventListener?t.phenixAddEventListener.call(t,e,n,!!i):t.addEventListener?t.addEventListener(e,n,!!i):t.attachEvent&&t.attachEvent("on"+e,n)},u.removeEventListener=function(t,e,n,i){a(t,"target"),h(e,"eventName"),c(n,"listener"),t.phenixRemoveEventListener?t.phenixRemoveEventListener.call(t,e,n,!!i):t.removeEventListener?t.removeEventListener(e,n,!!i):t.detachEvent&&t.detachEvent("on"+e,n)};var s=function(t){if(!u.isArray(t))throw new Error("Input must be an array. Received ["+typeof t+"]")},r=function(t,e){if(h(e,"name"),!u.v(t))throw new Error(e+" must be a number. Received ["+typeof t+"]")},a=function(t,e){if(h(e,"name"),!u.h(t))throw new Error("collection type not supported - "+e+" must be an array or object. Received ["+typeof t+"]")},c=function(t,e){if(h(e,"name"),!u.g(t))throw new Error(e+" must be a function. Received ["+typeof t+"]")},h=function(t,e){if(!u.u(e))throw new Error("Name must be a string. Received ["+typeof e+"]");if(!u.u(t))throw new Error(e+" must be a string. Received ["+typeof t+"]")};return u}.apply(e,[]))&&(t.exports=e)},function(t,e,n){n=[n(1)];void 0!==(e=function(t){"use strict";return t}.apply(e,n))&&(t.exports=e)},function(t,e,n){n=[n(0)];void 0!==(e=function(t){return t}.apply(e,n))&&(t.exports=e)}],s={},i.m=r,i.c=s,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3))},function(t,e,n){n=[n(0),n(1),n(5)],e=function(n,i,r){"use strict";function t(t,e){i.h(t,"logger"),this.D=t,this.F=new r.Event,this.N=null,this.j=!1,this.L=null,this.B={pollFrequency:500,previousWidth:0,previousHeight:0},e&&e.pollFrequency&&(this.B.pollFrequency=15<=e.pollFrequency?e.pollFrequency:15),this._=null}function s(){var t;this.j&&!this.N&&0!==this.F.size()&&((t=this).B.previousWidth=this.L.videoWidth,this.B.previousHeight=this.L.videoHeight,this.N=setInterval(function(){t.L.videoWidth===t.B.previousWidth&&t.L.videoHeight===t.B.previousHeight||(t.B.previousWidth=t.L.videoWidth,t.B.previousHeight=t.L.videoHeight,t.F.fireAsync([t._,{width:t.L.videoWidth,height:t.L.videoHeight}]))},t.B.pollFrequency))}return t.prototype.start=function(t,e){!function(t,e){e&&!n.isUndefined(e.videoWidth)||this.D.warn("Attempting to start dimensions changed monitor without providing proper 'video' element."),this._=t,this.L=e,this.j=!0,s.call(this)}.call(this,t,e)},t.prototype.stop=function(){!function(){this.j=!1,this.N&&(clearInterval(this.N),this.N=null),this.F.dispose()}.call(this)},t.prototype.addVideoDisplayDimensionsChangedCallback=function(t){return i.g(t,"addVideoDisplayDimensionsChangedCallback"),s.call(this),this.F.listen(t)},t.prototype.toString=function(){return"DimensionsChangedMonitor[pollFrequency="+this.B.pollFrequency+", previousHeight="+this.B.previousHeight+", previousWidth="+this.B.previousHeight+", state="+(this.N?"running":"stopped")+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(10)],e=function(i,t){"use strict";var e={},r=new t(navigator.userAgent).detect();function s(t){var e=t.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return e&&{href:t,protocol:e[1],host:e[2],hostname:e[3],port:e[4],pathname:e[5],search:e[6],hash:e[7],origin:e[1]+"//"+e[2]}}return e.getEnvironmentFromUrl=function(t){try{var e=URL&&"IE"!==r.browser?new URL(t):s(t);return e.port?e.protocol+"//"+e.hostname+":"+e.port:e.protocol+"//"+e.hostname}catch(t){return""}},e.parseEnvFromPcastBaseUri=function(t){return t=t.toLowerCase(),i.includes(t,"local")?"local":i.includes(t,"stg")?"staging":"production"},e.getTelemetryServerUri=function(e){if(!e)return"";try{var t=URL&&"IE"!==r.browser?new URL(e):s(e),n=t.hostname.split(".");switch(2===n.length||3===n.length&&n[n.length-2].length<=2&&n[n.length-1].length<=3?n.unshift("telemetry"):i.startsWith(n[0],"stg-")||i.endsWith(n[0],"-stg")||i.includes(n[0],"-stg-")||"stg"===n[0]?n[0]="telemetry-stg":i.startsWith(n[0],"local")||i.endsWith(n[0],"local")||(n[0]="telemetry"),t.hostname=n.join("."),t.protocol){case"ws:":t.protocol="http:";break;case"wss:":t.protocol="https:"}return t.port?t.protocol+"//"+t.hostname+":"+t.port+"/telemetry":t.protocol+"//"+t.hostname+"/telemetry"}catch(t){return e}},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(70)],e=function(t){"use strict";return new t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{roles:{participant:{id:0,name:"Participant"},moderator:{id:1,name:"Moderator"},presenter:{id:2,name:"Presenter"},audience:{id:3,name:"Audience"}},states:{active:{id:0,name:"Active"},passive:{id:1,name:"Passive"},handRaised:{id:2,name:"HandRaised"},inactive:{id:3,name:"Inactive"},offline:{id:4,name:"Offline"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{types:{directChat:{id:0,name:"DirectChat"},multiPartyChat:{id:1,name:"MultiPartyChat"},moderatedChat:{id:2,name:"ModeratedChat"},townHall:{id:3,name:"TownHall"},channel:{id:4,name:"Channel"}},events:{memberJoined:{id:0,name:"MemberJoined"},memberLeft:{id:1,name:"MemberLeft"},memberUpdated:{id:2,name:"MemberUpdated"},roomUpdated:{id:3,name:"RoomUpdated"},roomEnded:{id:4,name:"RoomEnded"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{level:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(9),n(12),n(50)],e=function(t,s,o,u,a){"use strict";function e(){}return e.prototype.createPCastLogger=function(t,e,n){t&&s.R(t,"baseUri");var i=new o.Logger,r=u.getEnvironmentFromUrl(t),t=a.getAppender(t);return i.setEnvironment(r),n?t.setThreshold(n):t.setThreshold(o.level.INFO),e||i.addAppender(new o.ConsoleAppender),i.addAppender(t),i.isPCastLogger=!0,i},new e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(52),n(63),n(26)],e=function(t,e,n){return{MQWebSocket:t,BatchHttpProto:e,MQService:n}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(1),n(0),n(2),n(74)],e=function(r,u,s,a){"use strict";function t(t,e,n,i){r.R(t,"version"),r.R(e,"baseUri"),r.h(n,"logger"),this.W=t,this.V=e,this.D=n,this.H=new s.DisposableList,this.G=i}function c(t,e){var n;4===t.readyState&&(200===t.status?(n=t.getAllResponseHeaders(),n=u.reduce(n.trim().split(/[\r\n]+/),function(t,e){var e=e.split(": "),n=e.shift(),e=e.join(": ");return n&&(t[n]=e),t},{}),e(null,{data:t.response||t.responseText,headers:n,rawXhr:t})):((n=new Error(0===t.status?"timeout":"Status=["+t.status+"]")).code=t.status,e(n)))}return t.DefaultPCastUri="https://pcast.phenixrts.com",t.prototype.getBaseUri=function(){return this.V},t.prototype.resolveUri=function(t){return function(t,n){var i,e=0===t.lastIndexOf("wss:",0),r=0===t.lastIndexOf("ws:",0),s=0===t.lastIndexOf("https:",0),o=0===t.lastIndexOf("http:",0);e||r?n(void 0,{uri:t+"/ws",roundTripTime:0}):s||o?function(t,n){t=function(t){var e=new XMLHttpRequest;if("withCredentials"in e)e.open("GET",t,!0);else{if("undefined"==typeof XDomainRequest)return;(e=new XDomainRequest).open("GET",t)}return e}(t+"/pcast/endPoints?version=2023-11-28T17:29:11Z&_="+u.now());t.addEventListener("readystatechange",u.bind(c,this,t,function(t,e){if(t)return n(new Error("Failed to resolve an end point",t));t=e.data.split(",");t.length<1&&n(new Error("Failed to discover end points")),n(void 0,t)})),t.timeout=15e3,t.send(null)}.call(i=this,t,function(t,e){if(t)return n(t);t=new a({logger:i.D,version:i.W},n,function(t,e){t?503===t.code?i.D.debug("The end point [%s] is temporarily disabled",u.get(e,["endPoint"])):i.D.warn("An error occurred in resolving an endpoint [%s]",u.get(e,["endPoint"]),t):(t=0===e.endPoint.lastIndexOf("https:",0),i.G.recordMetric("RoundTripTime",{uint64:e.time},null,{resource:e.endPoint,kind:t?"https":"http"}))});t.resolveAll(e),i.H.add(t)}):n(new Error("Uri not supported ["+t+"]"))}.call(this,this.V,t)},t.prototype.dispose=function(){this.H.dispose()},t.prototype.toString=function(){return"PCastEndPoint["+this.V+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(3)],e=function(f,r){"use strict";function t(){}function l(t,e,n,i,r){return f.v(t)?t:f.v(e)?e:f.v(n)?n:f.v(i)?i:r}function d(t,e,n,i,r){return f.u(t)?t:f.u(e)?e:f.u(n)?n:f.v(i)?i:r}function p(t,e){t=parseInt(t,e);if(!isNaN(t))return t}function m(t){t=parseFloat(t);if(!isNaN(t))return t}function v(t){return f.includes(t.id,"send")||f.includes(t.id,"outbound")||"outboundrtp"===t.type||"outbound-rtp"===t.type||"kOutboundRtp"===t.type}function g(t){return f.includes(t.id,"recv")||"inboundrtp"===t.type||"inbound-rtp"===t.type||"kInboundRtp"===t.type}return t.convertPeerConnectionStats=function(t,e){var o,u,a,c,i,h=e;return t?(o=[],e=t,i={},"Chrome"===r.browser&&r.browserVersion<=66?e.result().forEach(function(e){var n={id:e.id,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),n.timestamp=e.timestamp.getTime(),i[n.id]=n}):(e.forEach(function(t){i[t.id]=t}),f.forOwn(i,function(e){"inbound-rtp"===e.type&&e.jitter&&(e.jitter=(1e3*e.jitter).toString()),"remote-inbound-rtp"===e.type&&f.forOwn(i,function(t){e.localId===t.id&&(t.fractionLost=e.fractionLost,t.jitter||(t.jitter=(1e3*e.jitter).toString()),t.packetsLost=e.packetsLost,t.roundTripTime=1e3*e.roundTripTime,t.roundTripTimeMeasurements=e.roundTripTimeMeasurements,t.totalRoundTripTime=e.totalRoundTripTime)}),"candidate-pair"===e.type&&f.forOwn(i,function(t){"audio"!==t.mediaType&&"video"!==t.mediaType||(!t.roundTripTime&&e.currentRoundTripTime&&(t.roundTripTime=1e3*e.currentRoundTripTime),t.currentRoundTripTime=1e3*e.currentRoundTripTime)}),"media-source"===e.type&&f.forOwn(i,function(t){t.mediaSourceId===e.id&&("audio"===t.mediaType&&e.audioLevel&&(g(t)?t.audioOutputLevel=(1e5*e.audioLevel).toString():v(t)&&e.audioLevel&&(t.audioInputLevel=(1e5*e.audioLevel).toString()),t.echoReturnLoss=e.echoReturnLoss,t.echoReturnLossEnhancement=e.echoReturnLossEnhancement,t.totalAudioEnergy=e.totalAudioEnergy,t.totalSamplesDuration=e.totalSamplesDuration,t.trackIdentifier=e.trackIdentifier),"video"===t.mediaType)&&(t.frames=e.frames,t.framesPerSecond=e.framesPerSecond,t.height=e.height,t.width=e.width)})})),t=i,u=!1,c=a="",f.forOwn(t,n),!u&&o.length<=0&&t.forEach&&t.forEach(n),o):null;function n(t){var e,n,i,r,s;u=u||!0,f.hasIndexOrKey(t,"ssrc")&&t.ssrc&&!f.includes(t.id,"rtcp")?(e=t.id||t.ssrc,f.hasIndexOrKey(h,e)||(h[e]={timestamp:f.now()}),s="?",r=parseFloat(t.timestamp)-h[e].timestamp,n=function(t,e,n){if(!f.isUndefined(e))return t?8*(t-(e||0))/n:0}(parseFloat(t.bytesSent),h[e].bytesSent,r),i=function(t,e,n){if(!f.isUndefined(e))return t?8*(t-(e||0))/n:0}(parseFloat(t.bytesReceived),h[e].bytesReceived,r),r=function(t,e,n){if(!f.isUndefined(e))return(t-e)/(n/1e3)}(l(p(t.framesEncoded),p(t.framesDecoded)),h[e].framesEncoded||h[e].framesDecoded,r),v(t)&&(s="upload"),g(t)&&(s="download"),s={uploadRate:n,downloadRate:i,mediaType:t.mediaType,ssrc:t.ssrc,direction:s,nativeReport:t,rtt:l(p(t.rtt),p(t.googRtt),p(t.roundTripTime),p(t.currentRoundTripTime)),bitrateMean:p(t.bitrateMean,10)||1e3*(v(t)?n:i),targetDelay:p(d(t.targetDelay,t.googTargetDelayMs),10),currentDelay:p(d(t.currentDelay,t.currentDelayMs,t.googCurrentDelayMs),10)},f.assign(h[e],t),"video"===t.mediaType&&(s=f.assign(s,{droppedFrames:p(t.droppedFrames,10)||0,framerateMean:l(t.framerateMean,t.framesPerSecond,r)||0,cpuLimitedResolution:d(t.cpuLimitedResolution,t.googCpuLimitedResolution),avgEncode:p(d(t.avgEncode,t.avgEncodeMs,t.googAvgEncodeMs),10)}),""!==c)&&(s.nativeReport.codecId=c),"audio"===t.mediaType&&(s=f.assign(s,{audioInputLevel:d(t.audioInputLevel,t.googAudioInputLevel),audioOutputLevel:d(t.audioOutputLevel,t.googAudioOutputLevel),jitter:p(d(t.jitter,t.jitterReceived,t.googJitterReceived),10),jitterBuffer:p(d(t.jitterBuffer,t.jitterBufferMs,t.googJitterBufferMs),10),totalSamplesDuration:m(t.totalSamplesDuration),totalAudioEnergy:m(t.totalAudioEnergy)}),""!==a)&&(s.nativeReport.codecId=a),o.push(s)):"codec"===t.type&&void 0!==t.mimeType&&(n=t.mimeType.match(/([^/]+)\/(.+)/))&&("audio"===n[1]&&(a=n[2]),"video"===n[1])&&(c=n[2])}},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(22),n(37)],e=function(i,r,s,t,e){"use strict";var n=t.types,o=e.states,u="pcast://phenixp2p.com/";function a(t,e,n,i){this.init(t,e,n,i)}function c(t){return i.includes(t,u)?u:"pcast://phenixrts.com/"}function h(t){var n={},t=t.split("?");return 2===t.length&&(t=t[1].split("&"),i.forEach(t,function(t){var t=t.split("="),e=t[0],t=decodeURIComponent(t[1]);n[e]=t,"capabilities"===e&&(n[e]=t&&t.split(",")||[])})),n}function f(t){return r.M(t,n,"streamType"),i.getEnumName(n,t)}function l(t){return r.M(t,o,"trackState"),i.getEnumName(o,t)}return a.prototype.init=function(t,e,n,i){r.u(t,"uri"),this.J=new s.Observable(t),this.K=new s.Observable(e,f),this.X=new s.Observable(n||o.trackEnabled.name,l),this.Z=new s.Observable(i||o.trackEnabled.name,l),this.$=a.parsePCastStreamIdFromStreamUri(t)},a.prototype.getUri=function(){return this.J.getValue()},a.prototype.getType=function(){return this.K.getValue()},a.prototype.getObservableAudioState=function(){return this.X},a.prototype.getObservableVideoState=function(){return this.Z},a.prototype.toJson=function(){return{uri:this.J.getValue(),type:this.K.getValue(),audioState:this.X.getValue(),videoState:this.Z.getValue()}},a.prototype.Y=function(t){var e,n;i.h(t)&&(Object.prototype.hasOwnProperty.call(t,"uri")&&t.uri!==this.J.getValue()&&(e=t.uri,n=this.J.getValue(),a.parsePCastStreamIdFromStreamUri(e)===a.parsePCastStreamIdFromStreamUri(n))&&(this.J.setValue(t.uri),this.$=a.parsePCastStreamIdFromStreamUri(t.uri)),Object.prototype.hasOwnProperty.call(t,"audioState")&&this.X.setValue(t.audioState),Object.prototype.hasOwnProperty.call(t,"videoState"))&&this.Z.setValue(t.videoState)},a.prototype.isPCastStream=function(){return!!this.$},a.prototype.getPCastStreamId=function(){return this.$},a.prototype.getInfo=function(){return h(this.J.getValue())},a.getPCastPrefix=function(){return u},a.parsePCastStreamIdFromStreamUri=function(t){return i.includes(t,c(t))?t.replace(c(t),"").split("?")[0]:null},a.getInfoFromStreamUri=h,a}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{types:{user:{id:0,name:"User"},presentation:{id:1,name:"Presentation"},audio:{id:2,name:"Audio"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(17),n(8),n(13),n(12),n(29),n(71),n(19),n(76),n(77),n(30),n(11),n(78),n(80),n(81),n(20),n(83),n(84),n(88),n(6),n(32),n(3),n(31)],e=function(b,k,r,s,e,i,o,S,N,j,u,L,B,_,W,V,l,z,H,d,p,G,R,J,E,m){"use strict";var K=50,Q=/^(?:room|channel)Id[:](.*)$/,X=/^(?:room|channel)Alias[:](.*)$/;function t(t){k.h(t=t||{},"options"),t.streamingSourceMapping&&(k.h(t.streamingSourceMapping,"options.streamingSourceMapping"),k.R(t.streamingSourceMapping.replacement,"options.streamingSourceMapping.replacement"),t.streamingSourceMapping.patternToReplace instanceof RegExp||k.R(t.streamingSourceMapping.patternToReplace,"options.streamingSourceMapping.patternToReplace")),b.isNullOrUndefined(t.disableMultiplePCastInstanceWarning)||k.k(t.disableMultiplePCastInstanceWarning,"options.disableMultiplePCastInstanceWarning"),b.isNullOrUndefined(t.disableGlobalErrorListener)||k.k(t.disableGlobalErrorListener,"options.disableGlobalErrorListener"),b.isNullOrUndefined(t.disableBeforeUnload)||k.k(t.disableBeforeUnload,"options.disableBeforeUnload"),b.isNullOrUndefined(t.disableConsoleLogging)||k.k(t.disableConsoleLogging,"options.disableConsoleLogging"),b.isNullOrUndefined(t.loggingLevel)||k.v(t.loggingLevel,"options.loggingLevel"),b.isNullOrUndefined(t.treatBackgroundAsOffline)||k.k(t.treatBackgroundAsOffline,"options.treatBackgroundAsOffline"),b.isNullOrUndefined(t.reAuthenticateOnForeground)||k.k(t.reAuthenticateOnForeground,"options.reAuthenticateOnForeground"),!0===t.treatBackgroundAsOffline&&!1===t.reAuthenticateOnForeground&&this.D.warn('Conflicting options "reAuthenticateOnForeground" can not be false when "treatBackgroundAsOffline" is true. Will reauthenticate upon entering foreground.'),t.shakaLoader&&k.g(t.shakaLoader,"options.shakaLoader"),t.webPlayerLoader&&k.g(t.webPlayerLoader,"options.webPlayerLoader"),this.tt=new r.Observable("offline"),this.et=new r.Observable(0),this.nt=new r.Observable(null),this.it=t.deviceId||"",this.W="2023-11-28T17:29:11Z";var e=this.parseTypeFromToken.call(this,t.authToken);if("publish"===e||"stream"===e)throw new Error('Cannot authorize. Please use token without type or token with type "auth".');function n(t){t=t?t.error:"Unknown Error";i.D.error("Window Error Event Triggered with pcast in [%s] state [%s]",i.tt.getValue(),t,t)}this.rt=t.authToken;var e=this.parseUriFromToken.call(this,t.authToken),i=(e?(this.V=e,a.call(this,t),this.D.info("Base uri is set to [%s] from authToken [%s]",e,t.authToken)):(this.V=t.uri||u.DefaultPCastUri,a.call(this,t)),this.st=new L(t,this.D),this.ot=t.shakaLoader,this.ut=t.webPlayerLoader,this.ct=t.rtmp||{},this.ht=t.streamingSourceMapping,this.H=new s.DisposableList,this.ft=t.disableMultiplePCastInstanceWarning,this.lt=!0===t.treatBackgroundAsOffline,this.dt=!0===t.reAuthenticateOnForeground,this.vt=0,this.gt=0,this.yt=!0,this.wt=[],this.bt=[],this.kt={},this.St={},this);b.addEventListener(E.global,"unload",function(){return i.D.info("Window Unload Event Triggered"),i.stop("window-unload")}),t.disableGlobalErrorListener||(b.addEventListener(E.global,"error",n),E.global.__phenixGlobalErrorListenerDisposable&&E.global.__phenixGlobalErrorListenerDisposable.dispose(),E.global.__phenixGlobalErrorListenerDisposable=new s.Disposable(function(){b.removeEventListener(E.global,"unload",n)})),t.disableBeforeUnload||b.addEventListener(E.global,"beforeunload",function(){return i.D.info("Window Before Unload Event Triggered"),i.stop("window-beforeunload")}),E.webrtcSupported||"ReactNative"!==E.browser||E.shim(),E.webrtcSupported&&"online"===this.tt.getValue()&&(function(){var n=this,i=new E.RTCPeerConnection;"Safari"===E.browser&&10<E.browserVersion&&(i.addTransceiver("audio"),i.addTransceiver("video"));try{var t=function(t){var e=m.getH264ProfileIds(t.sdp);if(n.bt=m.getSupportedCodecs(t.sdp),n.D.info("Supported WebRTC video codecs [%s]",n.bt),0===e.length)return n.D.info("Unable to find local h264 profile level id",t.sdp);n.D.info("Found local h264 profile level ids [%s]",e,t.sdp),n.wt=e,i.close&&i.close()},e=function(t){n.D.error("Unable to create offer to get local h264 profile level id",t),i.close&&i.close()},r={offerToReceiveAudio:!0,offerToReceiveVideo:!0};if("function"==typeof E.global.Promise)return i.createOffer(r).then(t).catch(e);i.createOffer(t,e,r)}catch(t){n.D.error("Failed to set environment defaults. Creating the Offer failed",t),i.close&&i.close()}}.call(this),g.call(this))}function a(t){this.D=t.logger||e.createPCastLogger(this.V,t.disableConsoleLogging,t.loggingLevel),this.Rt=t.metricsTransmitter||V.createMetricsTransmitter(this.V)}function n(e){if(!b.startsWith(e,"DIGEST:"))throw this.D.warn("Failed to parse the `token` [%s]",e),new Error("Bad `token`");try{var n=e.split(":")[1],t=E.global.atob(n),i=JSON.parse(t).token;return JSON.parse(i)}catch(t){n=this.getProtocol().getSessionId();throw this.D.warn("[%s] Failed to parse the `token` [%s]",n,e),new Error(t)}}function Z(){var n,i,r=this;r.Et?r.D.warn("[%s] Skip connect due to stopped state",r):(f.call(r)&&"offline"===r.tt.getValue()&&(this.D.warn("[PCast] connected after being offline. Reconnecting."),c.call(r)),this.It=!0,n=r.Tt,i=++r.vt,n.authenticate(r.rt,function(t,e){n!==r.Tt?r.D.info("Ignoring authentication response as reset took place"):i!==r.vt?r.D.info("Ignoring authentication response as a latter request is already underway"):r.Mt&&(t?(r.D.error("Failed to authenticate [%s]",t),O.call(r,"unauthorized"),r.Mt.call(r,r,"unauthorized","")):"ok"!==e.status?(r.D.warn("Failed to authenticate, status [%s]",e.status),O.call(r,"unauthorized"),r.Mt.call(r,r,"unauthorized","")):(O.call(r,"online"),r.Mt.call(r,r,e.status,e.sessionId)))}))}function c(){O.call(this,"reconnecting")}function h(t){t&&k.u("reason",t),O.call(this,"reconnected",t),this.D.info("Attempting to re-authenticate after reconnected event [%s]",t),function(){var i,r,s=this;s.Et?s.D.info("Skip re-authentication due to stopped state"):(i=s.Tt,r=++s.gt,i.authenticate(s.rt,function(t,e){var n=!0===s.It;if(i!==s.Tt)s.D.info("Ignoring re-authentication response as reset took place");else{if(r===s.gt)return t?(s.D.error("Unable to authenticate after reconnect to WebSocket [%s]",t),O.call(s,"reconnect-failed")):"ok"!==e.status?(s.D.warn("Unable to authenticate after reconnect to WebSocket, status [%s]",e.status),t="capacity"===e.status?e.status:"reconnect-failed",O.call(s,t)):(s.It=!0,s.D.info("Successfully authenticated after reconnect to WebSocket"),O.call(s,"online",null,n));s.D.info("Ignoring re-authentication response as a latter request is already underway")}}))}.call(this)}function $(){if(f.call(this)&&"reconnecting"===this.tt.getValue())return this.D.warn("[PCast] disconnected after attempting to reconnect. Going offline."),O.call(this,"critical-network-issue"),this.stop("critical-network-issue");this.It=!1,O.call(this,"offline")}function f(){return b.reduce(this.Ct,function(t,e){return t&&"closed"===e.iceConnectionState},!0)}function Y(t){var e=t.streamId,t=t.reason;return v.call(this,e,t)}function tt(t){var e=t.streamId,n=t.status,t=t.reason,i=this.qt[e],i=(i&&i.dataQualityChangedCallback(n,t),this.xt[e]);i&&b.g(i.dataQualityChangedCallback)&&i.dataQualityChangedCallback(i,n,t)}function v(t,e){this.D.info("[%s] Stream ended with reason [%s]",t,e);var n=this.qt[t],n=(n&&n.streamEndedCallback(d.getStreamEndedStatus(e),e,!0),delete this.qt[t],this.xt[t]),n=(n&&b.g(n.publisherEndedCallback)&&n.publisherEndedCallback(n,d.getStreamEndedStatus(e),e),delete this.xt[t],this.Ct[t]);n&&A.call(this,t,n,"ended"),delete this.Ct[t]}function y(r,s,o,u,a,c){function t(t){if(!s.failed&&!l){var n,e=m.getNumberOfActiveSections(o),t=t.stream||b.get(t,["streams",0]),i="real-time";if(!t)return s.failed=!0,f.D.warn("[%s] No remote stream",r),a.call(f,void 0,"failed");h&&clearTimeout(h),e!==t.getTracks().length&&"ReactNative"!==E.browser?h=setTimeout(function(){return s.failed=!0,f.D.warn("[%s] Did not receive all tracks within [%s] ms",r,3e3),a.call(f,void 0,"failed")},3e3):(l=!0,f.D.info("[%s] Got remote stream",r),u.setProperty("kind",i),e=b.assign({networkLag:f.Pt},c),t=new G(r,t,o,u,e,f.D),(n=new d(i,t,f.D)).on(R.streamEvents.playerError.name,function(t,e){f.D.info("Phenix Real-Time stream error [%s] [%s]",t,e),n.streamErrorCallback(i,e)}),n.on(R.streamEvents.stopped.name,function(t){!s.stopped&&f.Tt&&(f.D.info("[%s] media stream has stopped with reason [%s]",r,t),A.call(f,r,o,"stop"),f.Tt.destroyStream(r,t||"",function(t,e){t?f.D.error("[%s] failed to destroy stream [%s]",r,t):"ok"!==e.status?f.D.warn("[%s] failed to destroy stream, status [%s]",r,e.status):f.D.info("[%s] destroyed stream",r)}),s.stopped=!0)}),f.qt[r]=n,a.call(f,t))}}var h,f=this,l=!1;b.addEventListener(o,"addstream",t),b.addEventListener(o,"track",t)}function w(e,t,n){var i=this;b.addEventListener(t,"icecandidate",function(t){t=t.candidate;t?i.D.info("[%s] ICE candidate: [%s] [%s] [%s]",e,t.sdpMid,t.sdpMLineIndex,t.candidate):i.D.info("[%s] ICE candidate discovery complete",e),n&&n(t)})}function I(e,n){var i=this;b.addEventListener(n,"negotiationneeded",function(t){i.D.info("[%s] Negotiation needed",e)}),b.addEventListener(n,"iceconnectionstatechange",function(t){i.D.info("[%s] ICE connection state changed [%s]",e,n.iceConnectionState)}),b.addEventListener(n,"icegatheringstatechange ",function(t){i.D.info("[%s] ICE gathering state changed [%s]",e,n.iceGatheringState)}),b.addEventListener(n,"signalingstatechange",function(t){i.D.info("[%s] Signaling state changed [%s]",e,n.signalingState)}),b.addEventListener(n,"connectionstatechange",function(t){i.D.info("[%s] Connection state changed [%s]",e,n.connectionState)})}function g(e){var n=this;if("Edge"===E.browser)return E.getDestinations(function(t){0===b.filter(t,function(t){return"audio"===t.kind}).length?(n.yt&&n.D.info("Detected no audio devices attached to machine"),n.yt=!1):n.yt=!0,e&&e()});e&&e()}function et(t,i,e,n,r,s){if("IE"===E.browser)throw new Error("Subscribing in real-time not supported on IE");function o(t){a.failed||(t instanceof Error&&(u.D.info("[%s] Failed to setup peer connection",i,t),t="failed"),a.failed=!0,a.stopped=!0,delete u.Ct[i],delete u.qt[i],delete u.Ot[i],A.call(u,i,f,"failure"),r.call(u,void 0,t||"failed"))}var u=this,a={failed:!1,stopped:!1},c=e.match(/a=crypto:/i),h=e.match(/m=application /i),f=new E.RTCPeerConnection(t,{optional:[{DtlsSrtpKeyAgreement:!c},{RtpDataChannels:h}]}),c=(F(f),u.Ct[i]=f,"Firefox"!==E.browser&&"Edge"!==E.browser||(e.match(/(\nm=video)/g)&&e.match(/(\nm=audio)/g)&&(e=e.replace(t=/(a=candidate)((.|\n)*)(?=m=)/g,e.match(t)+"a=end-of-candidates\n")),e=(e+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")),"ReactNative"===E.browser&&(e=m.setGroupLineOrderToMatchMediaSectionOrder(e)),y.call(u,i,a,f,n,r,s),w.call(u,i,f,function(t){u.Ot[i]&&u.Ot[i](t)}),I.call(u,i,f),new E.RTCSessionDescription({type:"offer",sdp:e})),l={mandatory:{}};if("Chrome"===E.browser||"ReactNative"===E.browser?(l.mandatory.OfferToReceiveVideo=!1!==s.receiveVideo,l.mandatory.OfferToReceiveAudio=!1!==s.receiveAudio):(l.mandatory.offerToReceiveVideo=!1!==s.receiveVideo,l.mandatory.offerToReceiveAudio=!1!==s.receiveAudio),"function"==typeof E.global.Promise)return f.setRemoteDescription(c).then(b.bind(M,u,f)).then(function(){return f.createAnswer(l)}).then(b.bind(C,u)).then(function(n){return new E.global.Promise(function(t,e){q.call(u,i,n,t,e)})}).then(function(t){return f.setLocalDescription(t)}).then(b.bind(T,u,f)).then(function(){u.D.info("[%s] Peer connection setup completed",i)}).catch(o);u.D.info("[%s] Using legacy peer connection api to subscribe",i),f.setRemoteDescription(c,function(){M.call(u,f),f.createAnswer(function(t){C.call(u,t),q.call(u,i,t,function(t){f.setLocalDescription(t,function(){T.call(u,f),u.D.info("[%s] Peer connection setup completed",i)},o)},o)},o,l)},o)}function T(t){this.D.debug("Set local description [%s] [%s]",b.get(t,["localDescription","type"]),b.get(t,["localDescription","sdp"]))}function M(t){this.D.debug("Set remote description [%s] [%s]",b.get(t,["localDescription","type"]),b.get(t,["remoteDescription","sdp"]))}function C(t){return this.D.info("Created answer [%s]",t.sdp),t}function q(n,t,i,r){var s=this;s.Tt.setAnswerDescription(n,t.sdp,function(t,e){if(t)return s.D.error("Failed to set answer description [%s]",t),r();if("ok"!==e.status)return s.D.warn("Failed to set answer description, status [%s]",e.status),r(e.status);e&&b.includes(e.options,"ice-candidates")&&(s.Ot[n]=b.bind(nt,s,n));t=e.sessionDescription.sdp,E.isIOS&&(s.D.info("iOS Version is [%s]",E.browserVersion),E.browserVersion<11)&&(t=t.replace("BUNDLE audio video","BUNDLE video audio")),e=new E.RTCSessionDescription({type:"answer",sdp:t});i(e)})}function nt(t,e){var n=this,i=(i=this.kt[t])||(this.kt[t]=[]);e&&b.get(e,["candidate"])?i.push(e):(n.St[t]&&(n.D.debug("[%s] Dismissing scheduled batch for adding ICE candidates. Sending candidates immediately because there are no more candidates.",t),clearTimeout(n.St[t])),x.call(n,t,["completed"]),delete this.kt[t],delete this.St[t]),this.St[t]?n.D.debug("[%s] Using existing batch for adding ICE candidates",t):(this.St[t]=setTimeout(function(){x.call(n,t,[]),delete n.St[t]},K),this.H.add(new s.Disposable(function(){n.St[t]&&clearTimeout(n.St[t]),delete n.kt[t],delete n.St[t]})))}function x(n,t){var i,e=this.kt[n]||[];0===e.length&&0===t.length||(delete(i=this).kt[n],this.D.info("[%s] Adding [%s] ICE Candidates with Options [%s]",n,e.length,t),this.Tt.addIceCandidates(n,e,t,function(t,e){return t?i.D.error("Failed to add ICE candidate [%s]",t):"ok"!==e.status?i.D.warn("Failed to add ICE candidate, status [%s]",e.status):void(b.includes(e.options,"cancel")&&delete i.Ot[n])}))}function it(t,e,n,i,r){var s=this,o=/a=x-rtmp:(rtmp:\/\/[^\n]*)/m,u=e.match(o),a=e.match(/a=x-playlist:([^\n]*[.]mpd\??[^\s]*)/m),c=e.match(/a=x-playlist:([^\n]*[.]m3u8\??[^\s]*)/m),h=b.get(a,[1],""),f=b.get(c,[1],""),a=a&&2===a.length,c=c&&2===c.length,l=!!u,d=[],a=((a||c)&&d.push("streaming"),l&&d.push("rtmp"),this.getSupportedFeatureAndCapabilityFromCapabilities(d,!0));if("ok"!==a.status)s.D.warn("[%s] Creating live viewer stream failed: [%s].",t,a.status);else{switch(this.ht&&(h=h.replace(this.ht.patternToReplace,this.ht.replacement),f=f.replace(this.ht.patternToReplace,this.ht.replacement)),a.feature){case R.types.rtmp.name:var p=[],m=S.parseEnvFromPcastBaseUri(this.V);for(this.D.info("Selecting flash playback for rtmp.");u;){var v=b.get(u,[1],""),g=b.get(v.match(/(rtmp:\/\/[^\n\s]*)/),[0]),y=b.get(v.match(/bitrate=([^\n\s;]*)/),[1]),w=b.get(v.match(/resolution=([^\n\s;]*)/),[1]);e=e.replace(v,""),g&&p.push({uri:g,bitrate:y,resolution:w}),u=e.match(o)}return P.call(s,t,p,R.types.rtmp.name,n,i,b.assign({env:m},this.ct,r));case R.types.dash.name:return this.D.info("Selecting dash playback for live stream."),r.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(h)||/x-widevine-service-certificate/.test(e),r.isDrmProtectedContent&&(r.widevineServiceCertificateUrl=e.match(/a=x-widevine-service-certificate:([^\n][^\s]*)/m)[1],r.playreadyLicenseUrl=e.match(/a=x-playready-license-url:([^\n][^\s]*)/m)[1]),P.call(s,t,h,R.types.dash.name,n,i,r);case R.types.hls.name:return this.D.info("Selecting hls playback for live stream."),r.isDrmProtectedContent=/[?&]drmToken=([^&]*)/.test(f),r.hlsTargetDuration&&(k.v(r.hlsTargetDuration,"options.hlsTargetDuration"),f=f+(-1<f.indexOf("?")?"&":"?")+"targetDuration="+r.hlsTargetDuration),P.call(s,t,f,R.types.hls.name,n,i,b.assign({preferNative:E.shouldUseNativeHls},r))}s.D.warn("[%s] Unhandled stream type encountered: [%s]. Creating live viewer stream failed.",t,a.feature)}return i.call(s,void 0,"failed")}function P(i,e,r,s,o,u){var a=this,n=0,c=null,h=null;return this.ot||this.ut?(this.ot&&n++,this.ut&&n++,this.ot&&this.ot(function(t){if(c=t,0==--n)return f()}),this.ut&&this.ut(function(t){if(h=t,0==--n)return f()}),0===n?f():void 0):(a.D.warn("[%s] No player available for [%s] and uri [%s]. Please provide a loader via options.",i,r,e),a.Tt.destroyStream(i,"unsupported-features",function(t,e){t?a.D.error("[%s] failed to destroy stream with unsupported features, [%s]",i,t):"ok"!==e.status&&a.D.warn("[%s] failed to destroy stream with unsupported features, status [%s]",i,e.status)}),o.call(a,void 0,"unsupported-features"));function f(){if(!c&&!h)return a.D.warn("[%s] No player available for [%s] and uri [%s]. Please make sure the loader properly provides the player.",i,r,e),o.call(a,void 0,"unsupported-features");var t=new p(r,i,e,s,u,c,h,a.D),n=new d(r,t,a.D);s.setProperty("kind",r),n.on(R.streamEvents.playerError.name,function(t,e){a.D.warn("Phenix Live Stream Player Error [%s] [%s]",t,e),n.streamErrorCallback(t,e)}),n.on(R.streamEvents.stopped.name,function(t){if(!a.Tt)return a.D.warn("Unable to destroy stream [%s]",i);a.Tt.destroyStream(i,t||"",function(t,e){t?a.D.error("[%s] failed to destroy stream, [%s]",i,t):"ok"!==e.status&&a.D.warn("[%s] failed to destroy stream, status [%s]",i,e.status)})}),a.qt[i]=n,o.call(a,n.getPhenixMediaStream())}}function O(t,e,n){var i=this.getStatus();if(i!==t&&("critical-network-issue"!==i&&"offline"!==i||"offline"!==t)){this.tt.setValue(t);var r=this.getProtocol(),r=r?r.getSessionId():"";if(this.D.debug("[%s] Transition from [%s] to [%s] with reason [%s]",r,i,t,e),!n)switch(t){case"connecting":case"reconnecting":case"reconnected":break;case"critical-network-issue":case"unauthorized":case"reconnect-failed":case"offline":return this.At.call(this);case"online":return this.Ut.call(this)}}}function A(t,e,n){"closed"===e.signalingState||e.__closing?this.D.debug("[%s] Peer connection is already closed [%s]",t,n):(this.D.debug("[%s] close peer connection [%s]",t,n),e.close(),e.__closing=!0)}function rt(){(this.lt||this.dt)&&h.call(this,"entered-foreground")}function st(){this.lt&&O.call(this,"offline","entered-background")}function U(t){var e,n;return t&&(e=b.isArray(t)?[]:{},n=b.bind(ot,null,e),b.isArray(t)?b.forEach(t,n):b.forOwn(t,n),e)}function ot(t,e,n){var i;if(null!==e)return b.h(e)||b.isArray(e)?t[n]=U(e):b.u(e)&&b.u(n)?(i=b.startsWith(e.toLowerCase(),n.toLowerCase())?e.substring(n.length,e.length).toLowerCase():e,void(t[n]=i)):t[n]=e}function D(t){switch(E.browser){case"Firefox":t&&b.forEach(t.iceServers,function(t){t.urls=b.filter(t.urls,function(t){return!b.startsWith(t,"turns")})});break;case"Edge":t&&b.forEach(t.iceServers,function(t){t.urls=b.map(t.urls,function(t){return t.replace("transport=tcp","transport=udp")})})}return t}t.prototype.getBaseUri=function(){return this.V},t.prototype.getStatus=function(){return this.tt.getValue()},t.prototype.getObservableStatus=function(){return this.tt},t.prototype.getRemoteDescriptionSdp=function(t){if(k.R(t,"streamId"),this.Ct)return b.get(this.Ct,[t,"remoteDescription","sdp"])},t.prototype.isStarted=function(){return this.Dt},t.prototype.reAuthenticate=function(t){if(k.R(t,"authToken"),"online"===this.tt.getValue())return this.D.warn("Already authenticated. Denying request to re-authenticate");this.D.info("Attempting to re-authenticate with new auth token [%s]",t),this.rt=t,h.call(this)},t.prototype.start=function(t,e,n){if(k.g(t,"authenticationCallback"),k.g(e,"onlineCallback"),k.g(n,"offlineCallback"),this.Dt)throw new Error('"Already started"');b.v(E.global.__phenixInstantiatedPCastCount)?E.global.__phenixInstantiatedPCastCount++:E.global.__phenixInstantiatedPCastCount=1,1<E.global.__phenixInstantiatedPCastCount&&!this.ft&&this.D.warn("Avoid using multiple instances of PCast as this uses unnecessary resources and will reduce performance. This is your [%s] simultaneous instance. Remember to dispose all resources when done with them by calling .stop() or .dispose()",E.global.__phenixInstantiatedPCastCount),this.Et=!1,this.Dt=!0,this.Mt=t,this.Ut=e,this.At=n,this.G=new z(this.D,this.Rt),this.Ft=new u(this.W,this.V,this.D,this.G),O.call(this,"connecting"),this.Ct={},this.qt={},this.Ot={},this.xt={},this.Nt=[],this.H.add(this.Ft),this.H.add(this.G),this.H.add(o.onBackground(b.bind(st,this))),this.H.add(o.onForeground(b.bind(rt,this)));var i=this;i.Ft.resolveUri(function(t,e){if(t){if(i.D.error("Failed to connect to [%s]",i.V,t),i.Mt)switch(t.code){case 0:i.Mt.call(i,i,"network-unavailable","");break;case 503:i.Mt.call(i,i,"capacity","");break;default:return void i.Mt.call(i,i,"critical-network-issue","")}O.call(i,"offline"),i.Et=!0,i.Dt=!1}else i.D.info("Discovered end point [%s] with RTT [%s]",e.uri,e.roundTripTime),i.Pt=e.roundTripTime/2,i.jt=e.uri,i.Dt&&function(t){this.Tt=new j(t,this.it,this.W,this.D),this.Tt.onEvent("connected",b.bind(Z,this)),this.Tt.onEvent("reconnecting",b.bind(c,this)),this.Tt.onEvent("reconnected",b.bind(h,this)),this.Tt.onEvent("disconnected",b.bind($,this)),this.Tt.onEvent("pcast.StreamEnded",b.bind(Y,this)),this.Tt.onEvent("pcast.StreamDataQuality",b.bind(tt,this)),this.D.setObservableSessionId&&this.D.setObservableSessionId(this.Tt.getObservableSessionId()),this.Lt&&(this.Lt.dispose(),this.G.setSessionId(null)),this.Bt&&this.Bt.dispose(),this.Bt=this.Tt.getObservableSessionId().subscribe(b.bind(function(t){this.nt.setValue(t)},this)),this.Lt=this.Tt.getObservableSessionId().subscribe(b.bind(this.G.setSessionId,this.G))}.call(i,e.uri)})},t.prototype.stop=function(n){if(n=n||"",k.u(n,"reason"),this.Dt){this.D.info("Stopping pcast instance with reason [%s]",n),this.Et=!0,this.Dt=!1,delete this.Mt;try{var i=this;b.forOwn(this.qt,function(t,e){v.call(i,e,n)}),b.forOwn(this.xt,function(t,e){v.call(i,e,n),b.includes(t.getOptions(),"detached")||t.stop(n,!0)}),b.forOwn(this.Ct,function(t,e){v.call(i,e,n)}),b.forEach(this.Nt,function(t){t=t.getTracks();b.forEach(t,function(t){t.stop()})})}catch(t){i.D.warn("Pcast stop caught an error",t)}finally{if(this.Tt){try{this.Tt.disconnect()}catch(t){i.D.warn("Failed to disconnect pcast",t)}this.Tt=null}this.D.setObservableSessionId&&this.D.setObservableSessionId(null),this.Lt&&(this.Lt.dispose(),this.G.setSessionId(null)),this.Bt&&(this.Bt.dispose(),this.nt.setValue(null)),E.global.__phenixInstantiatedPCastCount--,this.H.dispose()}}},t.prototype.getUserMedia=function(t,e,n){if("IE"===E.browser)throw new Error("Publishing not supported on IE");return k.h(t,"options"),k.g(e,"callback"),n&&k.g(n,"onScreenShare"),new B(this.D,this.st,n).getUserMedia(t,e)},t.prototype.publish=function(t,o,u,e,a){if("IE"===E.browser)throw new Error("Publishing not supported on IE");if(!this.Dt)throw new Error("PCast not started. Unable to publish. Please start pcast first.");if(e=e||[],a=a||{},k.R(t,"token"),k.g(u,"callback"),k.isArray(e,"tags"),k.h(a,"options"),!b.h(o)&&!b.u(o))throw new Error('"streamToPublish" must be an object or URI');var c=this,h=b.assign({},a,{negotiate:!0}),f=(b.u(o)?(h.negotiate=!1,h.connectUri=o):h.connectUri=a.connectUri,0<e.length&&(h.tags=e),new l(this.getProtocol().getSessionId(),this.D,this.Rt));f.setProperty("resource","upload"),this.Tt.setupStream("upload",t,h,2*c.Pt,function(t,e){if(t)return c.D.error("Failed to create uploader [%s]",t),u.call(c,c,"failed");var n,i,r,s;if("ok"===e.status)return t=e.createStreamResponse.streamId,f.setStreamId(t),f.setStartOffset(e.createStreamResponse.offset),f.recordMetric("Provisioned"),f.recordMetric("RoundTripTime",{uint64:2*c.Pt},null,{resource:c.jt,kind:"https"}),!0===h.negotiate?(n=e.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,i=D(U(e.createStreamResponse.rtcConfiguration)),"Opera"===E.browser&&0<c.wt.length&&(r=b.get(m.getH264ProfileIds(n),[0]),(s=m.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(c.wt,r))?r!==s&&(c.D.info("[%s] Replacing publisher h264 profile level id [%s] with new value [%s] in offer sdp",t,r,s),n=m.replaceH264ProfileId(n,r,s)):c.D.warn("[%s] Unable to find h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",t,r,c.wt)),function(t,o,u,e,n,a,i,c){var h=this,f={failed:!1,stopped:!1},r=e.match(/a=crypto:/i),s=e.match(/m=application /i),l=new E.RTCPeerConnection(t,{optional:[{DtlsSrtpKeyAgreement:!r},{RtpDataChannels:s}]}),d=null,p=null;function m(t){f.failed||(t instanceof Error&&(h.D.info("[%s] Failed to setup peer connection",u,t),t="failed"),f.failed=!0,f.stopped=!0,delete h.Ct[u],delete h.xt[u],delete h.Ot[u],A.call(h,u,l,"failure"),a.call(h,void 0,t||"failed"))}function v(){var n=/(b=AS:([0-9]*)[\n\r]*)/gi,i=/(mid:video)([\n\r]*)/gi,r=0,t=n.exec(e),s=(t&&3<=t.length&&(r=1e3*t[2]),{getStreamId:function(){return u},getStream:function(){return o},isActive:function(){return!f.stopped},hasEnded:function(){switch(l.iceConnectionState){case"new":case"checking":case"connected":case"completed":return!1;default:return!0}},stop:function(t){!f.stopped&&h.Tt&&(h.D.info("[%s] stopping publisher with reason [%s]",u,t||"client-action"),A.call(h,u,l,"closed"),h.Tt.destroyStream(u,t||"",function(t,e){t?h.D.error("[%s] failed to destroy stream [%s]",u,t):"ok"!==e.status?h.D.warn("[%s] failed to destroy stream, status [%s]",u,e.status):h.D.info("[%s] destroyed stream",u)}),f.stopped=!0)},setPublisherEndedCallback:function(t){k.g(t,"callback"),this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){k.g(t,"callback"),this.dataQualityChangedCallback=t},limitBandwidth:function(t){if("Edge"===E.browser)return h.D.warn("Limit bandwidth not support on [%s]",E.browser);k.v(t,"bandwidthLimit");var s=r?Math.min(t,r):t,e=l.remoteDescription,t=(h.D.info("Changing bandwidth limit to [%s]",s),(t=e.sdp.replace(n,"")).replace(i,function(t,e,n,i,r){return[e,n,"b=AS:",Math.ceil(s/1e3),n].join("")})),t=new E.RTCSessionDescription({type:e.type,sdp:t});return l.setRemoteDescription(t),{dispose:function(){l.setRemoteDescription(e)}}},getMonitor:function(){return p},monitor:function(t,n){k.h(t,"options"),k.g(n,"callback");var e=new _(u,l,h.D);return t.direction="outbound",t.setNetworkRTT=function(t){h.et.setValue(t)},e.start(t,function(){return h.xt[u]===s&&!f.stopped},function(t,e){return t&&h.D.warn("[%s] Publisher monitor triggered unrecoverable error [%s]",t),h.D.warn("[%s] Publisher triggered monitor condition for [%s]",u,e.reasons),n(s,"client-side-failure",e)}),b.forEach(o.getTracks(),function(t){b.addEventListener(t,"readystatechange",function(){if("ended"===t.readyState)return h.D.warn("[%s] Publisher track has failed [%s]",u,t),n(s,"camera-track-failure",{type:t.kind+"-track-ended",message:"Publisher "+t.kind+" track has ended in an unrecoverable way. This may require reconfiguring your camera or microphone."})})}),p=e},addBitRateThreshold:function(t,e){return new J("Publisher",p,function(){return r}).addThreshold(t,e)},setRemoteMediaStreamCallback:function(t){k.g(t,"callback"),this.remoteMediaStreamCallback=t,d&&t(s,d)},getOptions:function(){return c},getStats:function(e){k.g(e,"callback"),this._t||(this._t={});var n=this;return E.getStats(l,null,function(t){e(H.convertPeerConnectionStats(t,n._t))})},networkRTT:h.et});h.xt[u]=s,a.call(h,s)}F(l),(h.Ct[u]=l).addStream(o),"Firefox"!==E.browser&&"Edge"!==E.browser||(e.match(/(\nm=video)/g)&&e.match(/(\nm=audio)/g)&&(e=e.replace(t=/(a=candidate)((.|\n)*)(?=m=)/g,e.match(t)+"a=end-of-candidates\n")),e=(e+="a=end-of-candidates").replace(/(\na=ice-options:trickle)/g,"")),y.call(h,u,f,l,n,function(t){var e=h.xt[u];d=t,e&&e.remoteMediaStreamCallback&&e.remoteMediaStreamCallback(e,t)},i),w.call(h,u,l,function(t){h.Ot[u]&&h.Ot[u](t)}),I.call(h,u,l);var r=new E.RTCSessionDescription({type:"offer",sdp:e}),g={mandatory:{}};if("Chrome"===E.browser||"ReactNative"===E.browser?(g.mandatory.OfferToReceiveVideo=!0===i.receiveVideo,g.mandatory.OfferToReceiveAudio=!0===i.receiveAudio):(g.mandatory.offerToReceiveVideo=!0===i.receiveVideo,g.mandatory.offerToReceiveAudio=!0===i.receiveAudio),"function"==typeof E.global.Promise)return l.setRemoteDescription(r).then(b.bind(M,h,l)).then(function(){return l.createAnswer(g)}).then(b.bind(C,h)).then(function(n){return new E.global.Promise(function(t,e){q.call(h,u,n,t,e)})}).then(function(t){return l.setLocalDescription(t)}).then(b.bind(T,h,l)).then(function(){h.D.info("[%s] Peer connection setup completed",u)}).then(v).catch(m);h.D.info("[%s] Using legacy peer connection api to publish",u),l.setRemoteDescription(r,function(){M.call(h,l),l.createAnswer(function(t){C.call(h,t),q.call(h,u,t,function(t){l.setLocalDescription(t,function(){T.call(h,l),h.D.info("[%s] Peer connection setup completed",u),v()},m)},m)},m,g)},m)}.call(c,i,o,t,n,f,function(t,e){f.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?u.call(c,c,"failed",null):u.call(c,c,"ok",t)},a,e.createStreamResponse.options)):function(n,t,e){var i=this,r={stopped:!1},s={getStreamId:function(){return n},getStream:function(){return i.D.debug("[%s] Unable to get stream for remote origin.",n),null},getStats:function(){return i.D.debug("[%s] Unable to get stream stats for remote origin.",n),null},isActive:function(){return!r.stopped},hasEnded:function(){return r.stopped},stop:function(t){r.stopped||(i.D.info("[%s] stopping publisher with reason [%s]",n,t),i.Tt.destroyStream(n,t||"",function(t,e){t?i.D.error("[%s] failed to destroy stream [%s]",n,t):"ok"!==e.status?i.D.warn("[%s] failed to destroy stream, status [%s]",n,e.status):i.D.info("[%s] destroyed stream",n)}),r.stopped=!0)},setPublisherEndedCallback:function(t){k.g(t,"callback"),this.publisherEndedCallback=t},setDataQualityChangedCallback:function(t){k.g(t,"callback"),this.dataQualityChangedCallback=t},getOptions:function(){return e},monitor:function(t,e){k.h(t,"options"),k.g(e,"callback")},getMonitor:function(){return null}};t(i.xt[n]=s)}.call(c,t,function(t,e){f.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?u.call(c,c,"failed",null):u.call(c,c,"ok",t)},e.createStreamResponse.options);switch(c.D.warn("Failed to create uploader, status [%s]",e.status),e.status){case"timeout":case"capacity":case"unauthorized":return u.call(c,c,e.status);default:return u.call(c,c,"failed")}})},t.prototype.subscribe=function(n,u,i){if(!this.Dt)throw new Error("PCast not started. Unable to subscribe. Please start pcast first.");i=i||{},k.R(n,"token"),k.g(u,"callback"),k.h(i,"options");var a=this;g.call(a,function(){var t="download",e=b.assign({},i,{negotiate:!1!==i.negotiate}),s=new l(a.getProtocol().getSessionId(),a.D,a.Rt),o=b.assign({},i);o.canPlaybackAudio=a.yt,o.capabilities=a.parseCapabilitiesFromToken(n),!a.yt&&i.disableAudioIfNoOutputFound&&!1!==i.receiveAudio&&(e.receiveAudio=!1,o.receiveAudio=!1,o.forcedAudioDisabled=!0),i.originStreamId&&(e.originStreamId=i.originStreamId),s.setProperty("resource",t),a.Tt.setupStream(t,n,e,2*a.Pt,function(t,e){var n,i,r;return t?(a.D.error("Failed to create downloader [%s]",t),u.call(a,a,"failed")):"ok"!==e.status?(a.D.warn("Failed to create downloader, status [%s]",e.status),u.call(a,a,e.status)):(t=e.createStreamResponse.streamId,n=e.createStreamResponse.createOfferDescriptionResponse.sessionDescription.sdp,i=D(U(e.createStreamResponse.rtcConfiguration)),i=b.bind(et,a,i),(r=!(n.match(/m=audio /)||n.match(/m=video /))&&(n.match(/a=x-playlist:/)||n.match(/a=x-rtmp:/)))&&(i=it),s.setStreamId(t),s.setStartOffset(e.createStreamResponse.offset),s.recordMetric("Provisioned"),s.recordMetric("RoundTripTime",{uint64:2*a.Pt},null,{resource:a.getBaseUri(),kind:"https"}),o.originStartTime=b.now()-e.createStreamResponse.offset+a.Pt,!r&&("Chrome"===E.browser&&62<=E.browserVersion&&E.isMobile||"Opera"===E.browser)&&0<a.wt.length&&(e=b.get(m.getH264ProfileIds(n),[0]),(r=m.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel(a.wt,e))?e!==r&&(a.D.info("[%s] Replacing subscriber h264 profile level id [%s] with new value [%s] in offer sdp",t,e,r),n=m.replaceH264ProfileId(n,e,r)):a.D.warn("[%s] Unable to find new subscriber h264 profile level id to replace [%s]. Rejected environment defaults of [%s]",t,e,a.wt)),i.call(a,t,n,s,function(t,e){s.recordMetric("SetupCompleted",{string:e?"failed":"ok"}),e?u.call(a,a,"failed",null):u.call(a,a,"ok",t)},o))})})},t.prototype.getProtocol=function(){return this.Tt},t.prototype.getLogger=function(){return this.D},t.prototype.getObservableSessionId=function(){return this.nt},t.prototype.toString=function(){var t=this.getProtocol();return"PCast["+(t?t.getSessionId():"")||!1},t.prototype.parseTypeFromToken=function(t){return b.get(n.call(this,t),["type"],"")},t.prototype.parseCapabilitiesFromToken=function(t){return b.get(n.call(this,t),["capabilities"],[])},t.prototype.parseUriFromToken=function(t){return b.get(n.call(this,t),["uri"],"")},t.prototype.parseRoomOrChannelIdFromToken=function(t){t=b.get(n.call(this,t),["requiredTag"],"").match(Q);return t?t[1]:null},t.prototype.parseRoomOrChannelAliasFromToken=function(t){t=b.get(n.call(this,t),["requiredTag"],"").match(X);return t?t[1]:null},t.prototype.getSupportedFeatureAndCapabilityFromCapabilities=function(t,e){k.isArray(t,"capabilities");var n=[],i=["real-time","streaming","on-demand","rtmp"],r={status:null,capability:"",feature:null};if(b.forEach(t,function(t){b.includes(i,t)&&n.push(r.capability=t)}),1<n.length)return this.D.warn("Multiple conflicting capabilities encountered: [%s]",n),{status:"conflicting-capability"};switch(r.capability){case"real-time":r.feature=e?null:R.types.realTime.name;break;case"streaming":case"on-demand":r.feature=(E.shouldUseNativeHls?R.types.hls:R.types.dash).name;break;case"rtmp":r.feature=R.types.rtmp.name;break;default:r.capability="real-time",r.feature=e?null:R.types.realTime.name}return this.isFeatureSupported(r.feature)?r.status="ok":(this.D.warn("Device does not support [%s] playback.",r.capability),r.status="unsupported-features"),r},t.prototype.isFeatureSupported=function(t){switch(t&&k.R(t,"feature"),b.getEnumName(R.types,t)){case R.types.realTime.name:return E.webrtcSupported;case R.types.dash.name:case R.types.hls.name:case R.types.rtmp.name:return p.canPlaybackType(t);default:return!1}};var F=function(n){var e,t;b.isUndefined(n.onaddstream)&&(e=[],t=[],b.addEventListener(n,"track",function(t){b.forEach(t.streams,function(t){b.includes(e,t)||e.push(t)})}),n.getRemoteStreams=function(){return e},n.getLocalStreams=function(){return t},n.addStream=function(e){b.includes(t,e)||t.push(e),b.forEach(e.getTracks(),function(t){n.addTrack(t,e)})})};return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2)],e=function(s,o,u){"use strict";function t(t,e){this.latestValue=null,this.subscribeCallbacks={},this.subscriptionTimeout=100,this.subscriptionCount=0,this.resetOnChange=!1,this.lastChangeTime=0,this.isPendingChanges=!1,this.beforeChange=e,i.call(this,t)}function n(t){return null!=t&&s.isArray(t)?t.slice():t}function i(t){var e=t;this.beforeChange&&(e=this.beforeChange(t)),this.latestValue=n(e)}function a(t,e){if(this.lastChangeTime=s.now(),!this.isPendingChanges&&0!==this.subscriptionCount){if(this.isPendingChanges=!0,e)return c.call(this);r.call(this,t)}}function r(t){var e=this;setTimeout(function(){var t=s.now()-e.lastChangeTime;e.resetOnChange&&t<e.subscriptionTimeout?r.call(e,e.subscriptionTimeout-t):c.call(e)},t)}function c(){try{!function(){var e=this;s.forOwn(e.subscribeCallbacks,function(t){s.g(t)&&t(e.latestValue)})}.call(this)}finally{this.isPendingChanges=!1}}return t.prototype.getValue=function(){return n(this.latestValue)},t.prototype.setValue=function(t){t!==this.latestValue&&(i.call(this,t),a.call(this,this.subscriptionTimeout))},t.prototype.subscribe=function(t,e){o.g(t,"callback"),e&&o.h(e,"options");var n,i=this,r=s.uniqueId();return i.subscribeCallbacks[r]=t,i.subscriptionCount+=1,e&&("notify"===e.initial&&a.call(i,i.subscriptionTimeout,!0),e.listenForChanges)&&(n=setInterval(function(){var t=e.listenForChanges.callback();t!==i.latestValue&&i.setValue(t)},e.listenForChanges.timeout)),new u.Disposable(function(){delete i.subscribeCallbacks[r],n&&(clearInterval(n),n=null),--i.subscriptionCount})},t.prototype.extend=function(t){switch(o.h(t,"options"),t.method){case"notifyWhenChangesStop":this.subscriptionTimeout=t.timeout,this.resetOnChange=!0;break;case"notifyAtFixedRate":this.subscriptionTimeout=t.timeout}return s.v(t.rateLimit)&&(this.subscriptionTimeout=t.rateLimit),this},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(55)],e=function(t){"use strict";return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(2),n(27),n(60)],e=function(c,o,s,i,u,a){"use strict";var h="continuation",f=18e3;function t(t,e,n,i,r){o.h(t,"logger"),o.g(e,"sendCallback"),o.g(n,"receiveCallback"),this.D=t,this.Wt=new u(i,r),this.Vt=0,this.zt=new s.NamedEvents,this.Ht={},this.Gt={},this.Jt={},this.Kt={},this.Qt={},this.Xt={},this.Zt=n,this.$t=e,n(c.bind(l,this))}function l(t){if(this.Yt)return this.D.warn("Proto already disposed of. Unable process message");var e,n,i;try{e=this.Wt.decode("mq.Message",a.toByteArray(t.data)),i=this.Ht[e.requestId],this.D.info(">> [%s] [%s]",e.messageType,e.type),n=this.Wt.decode(e.type,e.payload)}catch(t){if(this.D.error(t),i)return i(t);throw t}switch(function(t,e,n){var i=c.now(),r=this.Qt[t.requestId];c.v(r)&&(t.wallTime=[i-r].concat(t.wallTime)),this.zt.fireAsync("received",[{key:t.requestId,messageType:t.messageType,type:t.type,wallTime:t.wallTime,received:i,bytes:n,payload:e}]),delete this.Qt[t.requestId]}.call(this,e,n,t.data.length),e.messageType){case"Response":return n.status!==h&&delete this.Ht[e.requestId],clearTimeout(this.Kt[e.requestId]),delete this.Kt[e.requestId],i?"mq.Error"===e.type?i(n,null):i(null,n):void 0;case"Request":var r=c.bind(this.sendResponse,this,e.requestId,e.type+"Response"),s=this.Jt[e.type];this.Gt[e.requestId]=c.now(),s?s(n,r):this.D.info("Received request without a subscribed listener");break;case"Event":return function(t,e){this.zt.fire(t,e,this)}.call(this,e.type,[n]);default:return this.D.warn(">> Unsupported message type [%s]",e.messageType)}}function d(t,e,n,i,r,s,o){return o&&o.status===h?(!this.Xt[t]&&this.Ht[t]&&(this.Xt[t]=function(t,e){return setTimeout(c.bind(v,this,t,3e5,e),3e5)}.call(this,t,r)),function(t,e,n,i,r,s){var o,u,a;return i&&(i.continuationId||i.routeKey)?(o=c.assign({},n,{continuationId:i.continuationId,routeKey:i.routeKey}),u={requestId:t,type:e,payload:this.Wt.encode(e,o),messageType:"Request"},a=this,setTimeout(function(){if(a.Ht[t])return p.call(a,t,u,o,r,s)},2e3)):(this.D.warn("Received request for continuation without a continuationId or routeKey"),s())}.call(this,t,e,n,o,i,r)):(clearTimeout(this.Xt[t]),delete this.Xt[t],r(s,o))}function p(t,e,n,i,r){this.Kt[t]&&clearTimeout(this.Kt[t]);i=i||f;return this.Kt[t]=setTimeout(c.bind(v,this,t,i,r),i),m.call(this,e,n)}function m(t,e){var n=a.toString(this.Wt.encode("mq.Message",t));return function(t,e,n){var i=c.now();this.Qt[t.requestId]=i,this.zt.fireAsync("sent",[{key:t.requestId,messageType:t.messageType,type:t.type,received:i,bytes:n,payload:e}])}.call(this,t,e,n.length),this.$t(n)}function v(t,e,n){if(this.Ht[t])return function(t,e){this.zt.fireAsync("timeout",[{key:t,timeout:e}]),delete this.Qt[t]}.call(this,t,e),this.D.warn("Request [%s] has not completed in [%s] ms. Dropping request.",t,e),delete this.Ht[t],n(null,{status:"timeout"})}return t.prototype.onEvent=function(t,e){return this.Yt?this.D.warn("Proto already disposed of. Unable to listen for event"):(o.R(t,"eventName"),o.g(e,"handler"),this.zt.listen(t,e))},t.prototype.onRequest=function(t,e){if(this.Yt)return this.D.warn("Proto already disposed of. Unable to listen for request");o.R(t,"requestName"),o.g(e,"handler"),this.Jt[t]&&this.D.warn("May not set multiple handlers for the same request. Overriding existing handlers for request [%s]",t),this.Jt[t]=e;var n=this;return new i.Disposable(function(){n.Jt[t]=null})},t.prototype.sendRequest=function(t,e,n,i){if(this.Yt)return this.D.warn("Proto already disposed of. Unable to send request"),n(null,{status:"proto-disposed"});i=i||{},o.R(t,"type"),o.h(e,"message"),o.h(i,"settings"),n&&o.g(n,"callback"),i.timeout&&o.v(i.timeout,"settings.timeout");var r="C"+(this.Vt++).toString(),s={requestId:r,type:t,payload:this.Wt.encode(t,e),messageType:"Request"};return this.Ht[r]=c.bind(d,this,r,t,e,i.timeout,n),p.call(this,r,s,e,i.timeout,n)},t.prototype.sendResponse=function(t,e,n,i){if(this.Yt)return this.D.warn("Proto already disposed of. Unable to send response"),i(null,{status:"proto-disposed"});o.R(t,"requestId"),o.R(e,"type"),o.h(n,"message");var r=this.Gt[t],e=(r||(this.D.error("Already responded to request [%s]",t),i(new Error("no-response-handler"))),{requestId:t,type:e,payload:this.Wt.encode(e,n),messageType:"Response",wallTime:[c.now()-r]});return m.call(this,e,n),delete this.Gt[t],i(null,{status:"ok"})},t.prototype.disposeOfRequests=function(){c.forOwn(this.Kt,function(t){clearTimeout(t)}),c.forOwn(this.Xt,function(t){clearTimeout(t)}),this.Ht={},this.Gt={},this.Jt={},this.Kt={},this.Qt={},this.Xt={}},t.prototype.dispose=function(){this.Yt=!0,this.Zt=null,this.$t=null,this.disposeOfRequests(),this.zt.dispose()},t.prototype.getApiVersion=function(){return this.Wt.getApiVersion()},t.prototype.toString=function(){return"Proto["+this.te.toString()+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(56),n(58),n(59)],e=function(r,s,i,o){"use strict";function t(t,e){var n=this;this.ee={},this.ee[o.package]=new i(o),r.forEach(t,function(t){n.ee[t.package]=new i(t)}),this.ne=e||3}return t.prototype.getApiVersion=function(){return this.ne},t.prototype.encode=function(t,e){if("string"!=typeof t)throw new Error("'type' must be a string");if("object"!=typeof e)throw new Error("'data' must be an object");var t=t.split("."),n=r.get(t,[0]),t=r.get(t,[1]),n=r.get(this.ee,[n]),i=new s;return n.write(t,e,i),i.finish()},t.prototype.decode=function(t,e){if("string"!=typeof t)throw new Error("'type' must be a string");var t=t.split("."),n=r.get(t,[0]),t=r.get(t,[1]),n=r.get(this.ee,[n]),e=new s(e);return n.read(t,e)},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{package:"telemetry",messages:[{name:"LogData",fields:[{rule:"required",type:"LogLevel",name:"level",id:1},{rule:"required",type:"string",name:"timestamp",id:2},{rule:"required",type:"string",name:"category",id:3},{rule:"required",type:"string",name:"message",id:4},{rule:"optional",type:"string",name:"source",id:5},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"sessionId",id:6},{rule:"optional",type:"string",name:"userId",id:7},{rule:"optional",type:"string",name:"environment",id:8},{rule:"optional",type:"string",name:"version",id:9},{rule:"optional",type:"float",name:"runtime",id:10}]},{name:"StoreLogRecords",fields:[{rule:"repeated",type:"LogData",name:"records",id:1}]},{name:"StoreLogRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]},{name:"MetricValue",fields:[{rule:"optional",type:"string",name:"string",id:1},{rule:"optional",type:"float",name:"float",id:2},{rule:"optional",type:"uint64",name:"uint64",id:3},{rule:"optional",type:"int64",name:"int64",id:4},{rule:"optional",type:"bool",name:"boolean",id:5},{rule:"optional",type:"string",name:"timestamp",id:6}]},{name:"MetricData",fields:[{rule:"required",type:"string",name:"timestamp",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"streamId",id:3},{rule:"optional",type:"string",name:"source",id:4},{rule:"optional",type:"string",name:"resource",id:5},{rule:"optional",type:"string",name:"kind",id:6},{rule:"required",type:"Metric",name:"metric",id:7},{rule:"optional",type:"MetricValue",name:"value",id:8},{rule:"optional",type:"MetricValue",name:"previousValue",id:9},{rule:"optional",type:"uint64",name:"elapsed",id:10},{rule:"optional",type:"string",name:"fullQualifiedName",id:11},{rule:"optional",type:"string",name:"environment",id:12},{rule:"optional",type:"string",name:"version",id:13},{rule:"optional",type:"string",name:"tool",id:14},{rule:"optional",type:"string",name:"toolVersion",id:15},{rule:"required",type:"float",name:"runtime",id:16}]},{name:"SubmitMetricRecords",fields:[{rule:"repeated",type:"MetricData",name:"records",id:1}]},{name:"SubmitMetricRecordsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"required",type:"uint64",name:"storedRecords",id:2}]}],enums:[{name:"LogLevel",values:[{name:"Trace",id:0},{name:"Debug",id:1},{name:"Info",id:2},{name:"Warn",id:3},{name:"Error",id:4},{name:"Fatal",id:5}]},{name:"Metric",values:[{name:"RoundTripTime",id:0},{name:"DownlinkThroughputCapacity",id:26},{name:"Initialized",id:1},{name:"Provisioned",id:2},{name:"SetupCompleted",id:3},{name:"Offset",id:4},{name:"TimeToFirstFrame",id:5},{name:"Playing",id:6},{name:"Stalled",id:7},{name:"Buffering",id:8},{name:"Seeking",id:22},{name:"Stopped",id:9},{name:"BitRateAdaptation",id:10},{name:"ResolutionChanged",id:11},{name:"DisplayResolutionChanged",id:23},{name:"VideoBitRate",id:28},{name:"AudioBitRate",id:29},{name:"FrameRateChanged",id:12},{name:"FramesDropped",id:13},{name:"PacketsLost",id:14},{name:"PictureLost",id:15},{name:"PlayoutDelayChanged",id:16},{name:"CodecChanged",id:17},{name:"PlayerEvent",id:21},{name:"MetricDropped",id:18},{name:"NetworkOffline",id:19},{name:"NetworkOnline",id:20},{name:"NetworkType",id:27},{name:"ApplicationForeground",id:24},{name:"ApplicationBackground",id:25}]}]}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(3)],e=function(t){"use strict";function e(){this.init()}return e.prototype.init=function(){if(!t.global.AudioContext&&!t.global.webkitAudioContext)throw new Error("Browser does not support AudioContext");this.ie=new(t.global.AudioContext||t.global.webkitAudioContext)},e.prototype.getNativeAudioContext=function(){return this.ie},e.prototype.toString=function(){return"AudioContext"},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(3),n(31),n(20)],e=function(k,r,s,S,R,u){"use strict";function t(t,e,n){r.u(t,"name"),r.h(e,"peerConnection"),r.h(n,"logger"),this.re=t,this.se=e,this.D=n,this._t={}}function E(t){var e,n=I(t),t=T(t);return 0!==n.length&&0!==t.length?(e=[],k.forEach(n,function(t){e.push(t)}),k.forEach(t,function(t){e.push(t)}),e):0!==n.length?n:0!==t.length?t:[]}function I(t){var e=t.getSenders?k.map(t.getSenders(),function(t){return t.track}):[];return 0===(e=k.filter(e,function(t){return!k.isNullOrUndefined(t)})).length?(t=t.getLocalStreams?t.getLocalStreams():[],k.reduce(t,function(t,e){return t.concat(e.getTracks())},[])):e}function T(t){var e=t.getReceivers?k.map(t.getReceivers(),function(t){return t.track}):[];return 0===(e=k.filter(e,function(t){return!k.isNullOrUndefined(t)})).length?(t=t.getRemoteStreams?t.getRemoteStreams():[],k.reduce(t,function(t,e){return t.concat(e.getTracks())},[])):e}function M(e,t){var t=k.filter(t,function(t){return t.kind===e}),n=k.filter(this.oe,function(t){return t.kind===e});return k.reduce(t,function(t,e){return t&&(t=!!k.find(n,function(t){return t.id===e.id}),!e.enabled||t)},!0)}return t.prototype.start=function(t,e,n){if(r.h(t,"options"),r.g(e,"activeCallback"),r.g(n,"monitorCallback"),"inbound"!==t.direction&&"outbound"!==t.direction)throw new Error("Invalid monitoring direction");var i;if(!Object.prototype.hasOwnProperty.call(t,"monitoringInterval")||0<t.monitoringInterval)return this.ue=t.frameRateThreshold||2,this.ae=t.videoBitRateThreshold||1e3,this.ce=t.audioBitRateThreshold||5e3,this.he=t.conditionCountForNotificationThreshold||3,this.fe=Math.max(500,t.monitoringInterval||4e3),this.le=Math.max(500,t.conditionMonitoringInterval||1500),this.de=!Object.prototype.hasOwnProperty.call(t,"monitorFrameRate")||t.monitorFrameRate,this.pe=!Object.prototype.hasOwnProperty.call(t,"monitorBitRate")||t.monitorBitRate,this.me=!Object.prototype.hasOwnProperty.call(t,"monitorState")||t.monitorState,this.oe=[],this.ve=new s.Event,"Edge"===S.browser&&(i=this.le*this.he,this.fe=Math.max(this.fe,6e3),this.le=Math.max(this.le,6e3),this.he=Math.max(Math.ceil(i/this.fe),2),this.D.info("Using modified options for optimal monitoring of PeerConnection on [Edge]. Monitor Interval [%s], Condition Monitor Interval [%s], Condition Count For Notification [%s]",this.fe,this.le,this.he)),function(f,l,d,p,m){var v=this,g=0,y=void 0,w=void 0,b=void 0;setTimeout(function h(){!function(t,e,n,i,r,s){if(!i())return this.D.info("[%s] Finished monitoring of peer connection",this.re);var o=this;S.getStats(t,null,function(t){t=u.convertPeerConnectionStats(t,o._t),t=k.filter(t,function(t){return"inbound"===e.direction&&"download"===t.direction||"outbound"===e.direction&&"upload"===t.direction});r(t)},function(t){s(t)})}.call(v,l,d,null,p,function(t){var e=!1,n=!1,i=!1;if(!p())return v.D.info("[%s] Finished monitoring of peer connection",f);if(!t)throw new Error("Report must be a valid PeerConnection.getStats Report");if(k.forEach(t,function(t){if("outbound"===d.direction&&"upload"===t.direction)switch(t.mediaType){case"video":v.D.debug("[%s] [%s] [%s] [%s] with RTT [%s], bitrate [%s], dropped frames [%s], frame rate [%s] and average encoding time [%s] ms (CPU limited=[%s])",f,d.direction,t.mediaType,t.ssrc,t.rtt,t.bitrateMean,t.droppedFrames,t.framerateMean,t.avgEncode,t.cpuLimitedResolution),y=t.framerateMean,w=t.uploadRate&&1e3*t.uploadRate,n=e=!0,d.setNetworkRTT&&d.setNetworkRTT(t.rtt),"Edge"===S.browser&&(e=!1);break;case"audio":v.D.debug("[%s] [%s] [%s] [%s] with RTT [%s], jitter [%s] and audio input level [%s]",f,d.direction,t.mediaType,t.ssrc,t.rtt,t.jitter,t.audioInputLevel),i=!0,b=t.uploadRate&&1e3*t.uploadRate,d.setNetworkRTT&&d.setNetworkRTT(t.rtt)}if("inbound"===d.direction&&"download"===t.direction)switch(t.mediaType){case"video":v.D.debug("[%s] [%s] [%s] [%s] with framerate [%s], current delay [%s] ms and target delay [%s] ms",f,d.direction,t.mediaType,t.ssrc,t.framerateMean,t.currentDelay,t.targetDelay),e=!0,y=t.framerateMean||0,n=!0,w=t.downloadRate&&1e3*t.downloadRate,"Edge"===S.browser&&(e=!1);break;case"audio":v.D.debug("[%s] [%s] [%s] [%s] with jitter [%s], jitter buffer [%s] ms, audio output level [%s], total audio energy [%s] and total samples duration [%s]",f,d.direction,t.mediaType,t.ssrc,t.jitter,t.jitterBuffer,t.audioOutputLevel,t.totalAudioEnergy,t.totalSamplesDuration),i=!0,b=t.downloadRate&&1e3*t.downloadRate}}),k.isUndefined(b)&&k.isUndefined(w))return setTimeout(h,v.fe);var r=R.hasActiveAudio(l),s=R.hasActiveVideo(l),o=((n&&0===w||i&&0===b||e&&0===y)&&(n=n&&s,i=i&&r,e=e&&s),(i||n||e)&&(v.D.debug("[%s] [%s] Current bit rate is [%s] bps for audio and [%s] bps for video with [%s] FPS",f,d.direction,Math.ceil(b||0),Math.ceil(w||0),y||"?"),0<k.values(v._t).length)&&v.ve.fire([{videoBitRate:w,audioBitRate:b,frameRate:y}]),[]);if(v.me&&("closed"===l.connectionState||"disconnected"===l.connectionState||"failed"===l.connectionState||"disconnected"===l.iceConnectionState||"failed"===l.iceConnectionState)){var u=r&&s,a=E.call(v,l);if(!u&&R.hasMediaSectionsInLocalSdp(l))return void v.D.info("[%s] [%s] Finished monitoring of peer connection with [%s] inactive tracks",f,d.direction,a.length);o.push("connection")}function c(){v.D.info("[%s] [%s] Failure has been acknowledged",f,d.direction),g=Number.MIN_VALUE,setTimeout(h,v.fe)}u=("outbound"===d.direction?I:T).call(this,l);v.de&&e&&y<=v.ue&&!M.call(v,"video",u)&&o.push("frameRate"),v.pe&&i&&b<=v.ce&&!M.call(v,"audio",u)&&o.push("audioBitRate"),v.pe&&n&&w<=v.ae&&!M.call(v,"video",u)&&o.push("videoBitRate"),0===w&&s&&!M.call(v,"video",u)&&o.push("noVideoData"),0===b&&r&&!M.call(v,"audio",u)&&o.push("noAudioData"),0<o.length?g++:g=0,g>=v.he?(a="["+f+"] ["+d.direction+"] Failure detected with frame rate ["+y+"] FPS, audio bit rate ["+b+"] bps, video bit rate ["+w+"] bps, connection state ["+l.connectionState+"], and ice connection state ["+l.iceConnectionState+"] after ["+g+"] checks",m(null,{type:"condition",reasons:o,message:a,report:t,frameRate:y,videoBitRate:w,audioBitRate:b,acknowledgeFailure:c})?c():v.D.info(a+": [%s]",t)):setTimeout(h,0<g?v.le:v.fe)},function(t){m(t,{type:"error",message:"Unable to get Connection statistics. Connection may have failed."})})},v.fe)}.call(this,this.re,this.se,t,e,n);this.D.info("[%s] Monitoring is disabled",name)},t.prototype.setMonitorTrackState=function(e,t){r.h(e,"track"),r.k(t,"state");try{var n=E.call(this,this.se);if(!k.find(n,function(t){return t.id===e.id}))return this.D.warn("[%s] Unable to find track [%s] [%s] in peer connection",this.re,e.kind,e.id)}catch(t){"Firefox"===S.browser&&"InvalidStateError: Peer connection is closed"===t.message?this.D.debug("Failed to verify monitor track due to closed peer connection"):this.D.warn("Failed to verify monitor track due to [%s]",t.message)}if(!t)return this.D.info("[%s] Pausing monitoring of track [%s] [%s]",this.re,e.kind,e.id),this.oe.push(e);n=this.oe.length;this.oe=k.filter(this.oe,function(t){return t.id!==e.id}),n!==this.oe.length&&this.D.info("[%s] Starting monitoring of track [%s] [%s] after it was paused",this.re,e.kind,e.id)},t.prototype.on=function(t,e){if(r.R(t,"eventName"),r.g(e,"listener"),"calculatedmetrics"!==t)throw new Error("Unsupported event "+t);return this.ve.listen(e)},t.prototype.toString=function(){return"PeerConnectionMonitor["+this.re+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(s,o){"use strict";var u=/profile-level-id=[^;\n]*/,n=/vp8/i,i=/vp9/i,r=/h264/i,a=/h265/i;function t(){}return t.prototype.getH264ProfileIds=function(t){o.R(t,"offerSdp");for(var e=[],n=t.match(u),i=t;n;){var r=s.get(n,"0","");e.push(r.split("=")[1]),n=(i=i.substring(n.index+r.length,t.length)).match(u)}return e},t.prototype.replaceH264ProfileId=function(t,e,n){o.R(t,"offerSdp"),o.R(n,"newProfileId");var i=this.getH264ProfileIds(t);return s.includes(i,e)?t.replace("profile-level-id="+e,"profile-level-id="+n):t},t.prototype.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel=function(t,e){return s.includes(t,e)?e:(t=s.reduce(t,function(t,e){var n=parseInt(t.substring(0,2),16),i=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return n!==r||s<=i?t:e},e))===e?null:t},t.prototype.getH264ProfileIdWithSameOrHigherProfileAndEqualToOrHigherLevel=function(t,e){return this.getH264ProfileIdWithSameProfileAndEqualToOrHigherLevel(t,e)||((t=s.reduce(t,function(t,e){var n=parseInt(t.substring(0,2),16),i=parseInt(t.substring(4,6),16),r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(4,6),16);return n<r||!(r<n||s<i)?e:t},e))===e?null:t)},t.prototype.getSupportedCodecs=function(t){o.R(t,"offerSdp");var e=[];return n.test(t)&&e.push("VP8"),i.test(t)&&e.push("VP9"),r.test(t)&&e.push("H264"),a.test(t)&&e.push("H265"),e},t.prototype.hasMediaSectionsInLocalSdp=function(t){return this.findInSdpSections(t,function(t){return s.startsWith(t,"video")||s.startsWith(t,"audio")})<0},t.prototype.hasActiveAudio=function(t){return this.findInSdpSections(t,function(t,e,n){return!!s.startsWith(t,"audio")&&!s.includes(t,"a=inactive")&&!s.includes(n[e],"a=inactive")})<0},t.prototype.hasActiveVideo=function(t){return this.findInSdpSections(t,function(t,e,n){return!!s.startsWith(t,"video")&&!s.includes(t,"a=inactive")&&!s.includes(n[e],"a=inactive")})<0},t.prototype.findInSdpSections=function(t,n){var e=this.getLocalSdp(t).split("m="),i=this.getRemoteSdp(t).split("m=");return e.length===i.length&&s.findIndex(e,function(t,e){return n(t,e,i)})},t.prototype.getNumberOfActiveSections=function(t){t=(this.getLocalSdp(t)||this.getRemoteSdp(t)).split("m=");return s.filter(t,function(t){return!s.includes(t,"a=inactive")&&(s.startsWith(t,"audio")||s.startsWith(t,"video"))}).length},t.prototype.getLocalSdp=function(t){return s.get(t,["localDescription","sdp"],"")},t.prototype.getRemoteSdp=function(t){return s.get(t,["remoteDescription","sdp"],"")},t.prototype.setGroupLineOrderToMatchMediaSectionOrder=function(n){var t=n.match(/(?=a=group:BUNDLE).*/),t=s.get(s.get(t,[0],"").split("a=group:BUNDLE "),[1],""),e=t.split(" ").sort(function(t,e){return n.indexOf("m="+t)-n.indexOf("m="+e)});return n=0<e.length?n.replace(t,e.join(" ")):n},new t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(d,i){"use strict";function t(t,e,n){i.R(t,"name"),i.h(e,"monitor"),i.g(n,"getLimit"),this.re=t,this.ge=e,this.ye=n||d.noop}return t.prototype.addThreshold=function(t,c){var h=function(t){var e=[];if(d.isArray(t))d.forEach(t,function(t){i.v(t,"threshold")}),e=t.sort();else if(d.h(t)){i.v(t.levels,"threshold.levels");for(var n=0;n<t.levels;n++)e.push(n/t.levels)}else i.v(t,"threshold"),e.push(t);return e.push(3),e}(t),f=null,l=this;return l.ge.on("calculatedmetrics",function(t){var i,r,e=l.ye(),t=t.videoBitRate+t.audioBitRate,n=(r=t/e,d.reduce(i=h,function(t,e,n){return null===t&&r<=e||e<i[t]&&r<=e?n:t},null)),s=d.get(h,[n]),o=s*e,u=d.get(h,[f],1),a=u*e;if(0!==e)return null===f?f=n:void(n!==f&&(n<f?c({isIncreasing:!1,bitRate:t,currentThreshold:o,targetBitRate:e,index:n,lastIndex:f,message:l.re+" bit rate is below "+s+" * "+e+" threshold of "+o+" with a bit rate of "+t}):f<n&&c({isIncreasing:!0,bitRate:t,currentThreshold:a,targetBitRate:e,index:n,lastIndex:f,message:l.re+" bit rate is above "+u+" * "+e+" threshold of "+a+" with a bit rate of "+t}),f=n))})},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(34),n(35),n(90),n(36),n(91),n(15),n(14)],e=function(h,s,o,u,e,n,r,a,t,i,c){"use strict";var f=h.freeze({status:"not-in-room"}),l=h.freeze({status:"already-in-room"}),d=h.freeze({status:"in-another-room"});function p(t){this.we=new o.Observable(null),this.be=new o.Observable(null),this.ke=new o.Observable(null),this.Se=null,this.Re=new e(t),this.setPCast(t)}function m(){this.we.setValue(null),this.be.setValue(null),this.ke.setValue(null),this.Se=null,this.H&&this.H.dispose(),this.H=null}function v(t){s.h(t,"event"),s.u(t.roomId,"event.roomId"),s.u(t.eventType,"event.eventType"),s.isArray(t.members,"event.members"),h.forEach(t.members,function(t){s.h(t,"member")});var e=this;switch(t.eventType){case i.events.memberJoined.name:return e.D.debug("[%s] Member joined [%s]",t.roomId,t.members),function(t,e){var n,i=this.be.getValue(),r=this.ke.getValue();i&&i.getRoomId()===t&&(i.Ee(e),i.Ie(e),r.Ee(e),r.Ie(e),n=this,r=!1,(e=h.find(e,function(t){return t.sessionId===n.getSelf().getSessionId()}))&&(r=T.call(n,i),i.Te([e])),this.D.info("[%s] Room has now [%d] members (Self is present in room [%s])",t,i.getObservableMembers().getValue().length,r))}.call(e,t.roomId,t.members);case i.events.memberLeft.name:return e.D.debug("[%s] Member left [%s]",t.roomId,t.members),function(t,e){var n,i,r,s=this.be.getValue(),o=this.ke.getValue();s&&s.getRoomId()===t&&(n=this,i=h.find(e,function(t){return t.sessionId===n.getSelf().getSessionId()}),(r=this.getSelf())&&i&&r.getObservableLastUpdate().setValue(i.lastUpdate),s.Ee(e),o.Ee(e),this.D.info("[%s] Room has now [%d] members",t,s.getObservableMembers().getValue().length))}.call(e,t.roomId,t.members);case i.events.memberUpdated.name:return e.D.debug("[%s] Member updated [%s]",t.roomId,t.members),function(t,e){var n,i=this.be.getValue(),r=this.ke.getValue();i&&i.getRoomId()===t&&(n=function(t){var n=this;return h.map(t,function(t){var e=w(t.sessionId,n.ke),e=S(new a(n,t.state,t.sessionId,t.screenName,t.role,t.streams,t.lastUpdate),e);return e.lastUpdate=t.lastUpdate,e})}.call(this,e),i.Te(n),r.Te(n),this.D.info("[%s] Room has [%d] updated members",t,e.length))}.call(e,t.roomId,t.members);case i.events.roomUpdated.name:return e.D.debug("[%s] Room updated [%s]",t.roomId,t.room),function(t,e){var n=this.be.getValue(),i=this.ke.getValue();n&&n.getRoomId()===t&&(i.Y(e),n.Y(e))}.call(e,t.roomId,t.room);case i.events.roomEnded.name:e.D.info("[%s] Room ended",t.roomId);break;default:e.D.warn("Unsupported room event [%s]",t.eventType)}}function g(t){this.getSelf()&&this.getSelf().getSessionId()===(t||"")?this.D.info("[%s] Skip session ID change since it is the same as in self model",t):function(t){var e=this.we.getValue().toJson();this.D.info("Resetting self after sessionId changed to [%s]",t),this.we.setValue(new a(this,e.state,t||"",e.screenName,e.role,e.streams,e.lastUpdate))}.call(this,t)}function y(t){var n,i=this;t&&t.getSessionId()&&(n=i.be.getValue())&&(i.D.info("[%s] Updating self in room after update",n.getRoomId()),E.call(this,this.getSelf(),function(t,e){"ok"===h.get(e,["status"])?i.D.info("[%s] Updated self in room after update",n.getRoomId()):i.D.info("[%s] Self was not updated in room after update",n.getRoomId())}))}function w(t,e){var e=e.getValue().getObservableMembers().getValue(),n=t;return h.find(e,function(t){return n===t.getSessionId()})}function b(t){this.D.info("PCast status changed from [%s] to [%s]",this.Me,t),"online"===(this.Me=t)&&function(){var t,e,n,i=this,r=i.be.getValue();h.h(r)&&(t=i.we.getValue())&&t.getSessionId()&&(e=r.getRoomId(),n=r.getObservableAlias().getValue(),i.D.info("[%s] Re-entering room [%s]",e,n),i.Se&&(i.D.info("Performing soft reset on room chat service for room [%s]",e),i.Se.stop()),R.call(i,e,n,function(){i.Se&&(i.D.info("[%s] Refreshing room chat service after re-entering room [%s]",e,n),i.Se.start(i.Se.getBatchSize())),i.D.info("[%s] Room [%s] completed reset",e,n)},{reenter:!0}))}.call(this)}function k(){var t=this.Tt.onEvent("chat.RoomEvent",h.bind(v,this)),e=this.we.subscribe(h.bind(y,this)),n=this.Re.getObservableStatus().subscribe(h.bind(b,this)),i=this.Re.getObservableSessionId().subscribe(h.bind(g,this));this.H.add(t),this.H.add(e),this.H.add(n),this.H.add(i)}function S(t,e){var n,i,r=t,s=(s=e)?(n={},i=r.toJson(),s=s.toJson(),s=h.findDifferences(i,s,!0),h.forEach(s,function(t){n[t]=i[t]}),n):r.toJson();return s.sessionId=t.getSessionId(),s.lastUpdate=e?e.getLastUpdate():h.now(),s}function R(n,i,r,t){var t=!0===h.get(t,"reenter"),e=this.be.getValue();if(e){var s=n===e.getRoomId()||i===e.getObservableAlias().getValue();if(s&&!t)return this.D.info("Unable to join room. Already in [%s]/[%s] room.",e.getRoomId(),e.getObservableAlias().getValue()),r(null,h.assign({room:e},s?l:d))}this.Re.assertAuthorized();var e=this.we.getValue(),s=e.getObservableScreenName().getValue(),o=e.getObservableRole().getValue(),e=S.call(this,e,null),u=[],a=h.now(),c=(t&&u.push("reenter"),this.D.info("Enter room [%s]/[%s] with screen name [%s] and role [%s]",n,i,s,o),this);c.Ce?c.D.info("[%s] We are already entering the room [%s], skipping",n,i):(c.Ce=!0,this.Tt.enterRoom(n,i,e,u,a,function(t,e){return c.Ce=!1,t?(c.D.error("Joining of room failed with error [%s]",t),r(t,null)):(t={status:e.status},"ok"!==e.status?(c.D.warn("Joining of room failed with status [%s]",e.status),r(null,t)):(t.room=function(t){var e=this.be.getValue(),n=this.ke.getValue(),i=I.call(this,t),r=I.call(this,t);return T.call(this,i),e&&n?(this.D.debug("[%s] Updating existing room model.",e.getRoomId()),e.Y(t.room),n.Y(t.room),e.getObservableMembers().setValue(i.getObservableMembers().getValue()),n.getObservableMembers().setValue(r.getObservableMembers().getValue()),e):(this.be.setValue(i),this.ke.setValue(r),i)}.call(c,e),"ok"===e.status&&e.self&&c.getSelf().Y(e.self),c.D.info("Successfully entered room [%s]/[%s]",n,i),void r(null,t)))}))}function E(t,n){if(!this.be.getValue())return this.D.warn("Not in a room. Please Enter a room before updating member."),n(null,f);this.Re.assertAuthorized();var e=this.be.getValue().getRoomId(),i=t.getSessionId()===this.getSelf().getSessionId(),r=w(t.getSessionId(),this.ke),s=S.call(this,t,r),o=h.now(),u=i&&s.role===c.roles.audience.name,a=(i&&!r&&(s.lastUpdate=t.getObservableLastUpdate().getValue()),this.D.info("Updating member info [%s] for active room [%s]",s,e),this);this.Tt.updateMember(e,s,o,function(t,e){if(t)return a.D.error("Update of member failed with error [%s]",t),n(t,null);t={status:e.status,lastUpdate:e.lastUpdate};"ok"!==e.status&&a.D.info("Update of member failed with status [%s]",e.status),"ok"===e.status&&u&&h.v(e.lastUpdate)&&a.getSelf().getObservableLastUpdate().setValue(e.lastUpdate),n(null,t)})}function I(t){var e=t.room,t=t.members;return new n(this,e.roomId,e.alias,e.name,e.description,e.type,t,e.bridgeId,e.pin)}function T(t){var e=this.we.getValue(),n=t.getObservableMembers().getValue(),i=h.findIndex(n,function(t){return e.getSessionId()===t.getSessionId()});return i<0?(this.D.debug("Self not in server room model."),!1):(e.Y(n[i].toJson()),n[i]=e,t.getObservableMembers().setValue(n),!0)}return p.prototype.setPCast=function(t){s.h(t,"pcast"),s.g(t.getLogger,"pcast.getLogger"),s.g(t.getProtocol,"pcast.getProtocol"),this.qe&&this.D.info("Resetting pcast instance for room service"),this.qe=t,this.D=t.getLogger(),this.Tt=t.getProtocol(),s.h(this.D,"this._logger"),s.h(this.Tt,"this._protocol"),this.Re.setPCast(t),this.Se&&this.Se.setPCast(t),this.Dt&&(this.H.dispose(),k.call(this))},p.prototype.start=function(t,e){var n,i,r;if(!this.Dt)return s.R(t,"role"),s.R(e,"screenName"),r=c.states.passive.name,n=this.Re.getPCastSessionId(),e=e,i=h.now(),r=new a(this,r,n,e,t,[],i),this.we=new o.Observable(r),this.H=new u.DisposableList,k.call(this),this.Dt=!0,r;this.D.warn("RoomService already started.")},p.prototype.getRoomInfo=function(t,e,n){t?s.R(t,"roomId"):s.R(e,"alias"),s.g(n,"callback"),function(t,e,n){this.Re.assertAuthorized();var i=this;this.Tt.getRoomInfo(t,e,function(t,e){return t?(i.D.error("Request to get room info failed with error [%s]",t),n(t,null)):(t={status:e.status},"ok"!==e.status?(i.D.warn("Request to get room info failed with status [%s]",e.status),n(null,t)):(t.room=h.freeze(function(t){var e=t.room,t=t.members||[];return new r(this,e.roomId,e.alias,e.name,e.description,e.type,t,e.bridgeId,e.pin)}.call(i,e)),void n(null,t)))})}.call(this,t,e,n)},p.prototype.enterRoom=function(t,e,n){t?s.R(t,"roomId"):s.R(e,"alias"),s.g(n,"callback"),R.call(this,t,e,n)},p.prototype.leaveRoom=function(t,e){return function(n,i){var t,r,e=this.be.getValue();if(h.k(i)||(i=!0),!e)return this.D.info("Not currently in a room."),n(null,f);""===this.Re.getPCastSessionId()||null===this.Re.getPCastSessionId()?this.D.warn("Unable to leave room. We are currently not connected. Status [%s]",this.Me):this.xe||(this.Re.assertAuthorized(),e=e.getRoomId(),t=h.now(),this.D.info("Leave room [%s]",e),(r=this).xe=!0,this.be.setValue(null),this.ke.setValue(null),i&&setTimeout(function(){r.xe=!1,n(null,{status:"ok"})}),this.Tt.leaveRoom(e,t,function(t,e){return r.xe=!1,t?(r.D.error("Leaving room failed with error [%s]",t),i?void 0:n(t,null)):("ok"!==e.status&&r.D.warn("Leaving room failed with status [%s]",e.status),i?void 0:n(null,{status:e.status}))}))}.call(this,t,e)},p.prototype.getChatService=function(){return!this.Se&&this.be.getValue()&&(this.Se=new t(this)),this.Se},p.prototype.getSelf=function(){return this.we.getValue()},p.prototype.getObservableActiveRoom=function(){return this.be},p.prototype.updateSelf=function(t){s.g(t,"callback"),E.call(this,this.getSelf(),t)},p.prototype.updateMember=function(t,e){s.g(e,"callback"),s.h(t,"member"),E.call(this,t,e)},p.prototype.updateRoom=function(t){s.g(t,"callback"),function(n){if(!this.be.getValue())return this.D.warn("Not in a room. Please Enter a room before updating member."),n(null,f);this.Re.assertAuthorized();var t=this.be.getValue(),e=h.now(),i=this;this.Tt.updateRoom(t.toJson(),e,function(t,e){if(t)return i.D.error("Update of room failed with error [%s]",t),n(t,null);t={status:e.status};"ok"!==e.status&&i.D.warn("Update of room failed with status [%s]",e.status),n(null,t)})}.call(this,t)},p.prototype.revertRoomChanges=function(){var t=this.be.getValue(),e=this.ke.getValue();if(!t||!e)return this.D.warn("Unable to revert changes to room. Not currently in a room.");t.Y(e.toJson())},p.prototype.revertMemberChanges=function(t){s.h(t,"member");var e=w(t.getSessionId(),this.ke),t=w(t.getSessionId(),this.be);if(!e||!t)return this.D.warn("Unable to revert changes to member. Member is currently not in room.");t.Y(e.toJson())},p.prototype.isInRoom=function(){return!!this.be.getValue()},p.prototype.toString=function(){return"RoomService"},p.prototype.stop=function(t){var e=this.be.getValue(),n=this;if(this.D.info("Stopping room service with reason [%s]",t),e)return this.leaveRoom(function(t,e){t&&n.D.warn("Failure to stop room service. Unable to leave room",t),e&&"ok"!==e.status&&n.D.warn("Failure to stop room service. Unable to leave room. Status: [%s]",e.status),e&&"ok"===e.status&&(m.call(n),n.Dt=!1)});m.call(this),n.Dt=!1},p}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(t,e){"use strict";function n(t){this.setPCast(t)}function i(t){return null!=t&&""!==t}function r(t){return null!=t&&""!==t&&"offline"!==t.toLowerCase()}return n.prototype.setPCast=function(t){e.h(t,"pcast"),e.g(t.getObservableStatus,"pcast.getObservableStatus"),e.g(t.getLogger,"pcast.getLogger"),e.g(t.getProtocol,"pcast.getProtocol"),t!==this.qe&&(this.qe=t,this.D=t.getLogger(),this.Tt=t.getProtocol(),e.h(this.D,"this._logger"),e.h(this.Tt,"this._protocol"),e.g(this.Tt.getObservableSessionId,"this._protocol.getObservableSessionId"),e.g(this.qe.getObservableStatus,"this._pcast.getObservableStatus"),this.Pe=this.Tt.getObservableSessionId(),this.Oe=this.qe.getObservableStatus())},n.prototype.checkAuthorized=function(){return!!r(this.getPCastStatus())&&!!i(this.getPCastSessionId())},n.prototype.assertAuthorized=function(){if(!r(this.getPCastStatus()))throw new Error("Unable to perform action. Status ["+this.getPCastStatus()+"]. Please wait to reconnect.");if(!i(this.getPCastSessionId()))throw new Error("Unable to perform action. Invalid sessionId ["+this.getPCastSessionId()+"] with status ["+this.getPCastStatus()+"]")},n.prototype.getObservableSessionId=function(){return this.Pe},n.prototype.getObservableStatus=function(){return this.Oe},n.prototype.getPCastSessionId=function(){return this.Pe.getValue()},n.prototype.getPCastStatus=function(){return this.Oe.getValue()},n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(36),n(15)],e=function(i,c,h,n,t){"use strict";var e=t.types;function r(t,e,n,i,r,s,o,u,a){this.init(t,e,n,i,r,s,o,u,a)}function f(t,e){return i.map(t,function(t){return new n(e,t.state,t.sessionId,t.screenName,t.role,t.streams,t.lastUpdate)})}function l(t){if(t=i.getEnumName(e,t))return t;throw new Error('"type" must be a valid room type')}return r.prototype.init=function(t,e,n,i,r,s,o,u,a){c.h(t,"roomService"),c.R(i,"name"),c.u(r,"description"),c.isArray(o,"members"),e&&c.R(e,"id"),n&&c.R(n,"alias"),u&&c.R(u,"bridgeId"),a&&c.R(a,"pin"),this.Ae=new h.Observable(e),this.Ue=new h.Observable(n),this.re=new h.Observable(i),this.De=new h.Observable(r),this.K=new h.Observable(s,l),this.Fe=new h.ObservableArray([]).extend({method:"notifyWhenChangesStop",timeout:400}),this.Ne=new h.ObservableArray,this.je=new h.Observable(u),this.Le=new h.Observable(a),this.Be=t,function(t){t=f(t,this.Be);this.Fe.setValue(t)}.call(this,o)},r.prototype.getRoomId=function(){return this.Ae.getValue()},r.prototype.getObservableAlias=function(){return this.Ue},r.prototype.getObservableName=function(){return this.re},r.prototype.getObservableDescription=function(){return this.De},r.prototype.getObservableType=function(){return this.K},r.prototype.getObservableMembers=function(){return this.Fe},r.prototype.getObservableBridgeId=function(){return this.je},r.prototype.getObservablePin=function(){return this.Le},r.prototype.toString=function(){return this.K.getValue()+"["+this.Ae.getValue()+"]"},r.prototype.toJson=function(){return{roomId:this.Ae.getValue(),alias:this.Ue.getValue(),name:this.re.getValue(),description:this.De.getValue(),type:this.K.getValue(),pin:this.Le.getValue(),bridgeId:this.je.getValue()}},r.prototype.commitChanges=function(t){c.h(this.Be,"this._roomService"),this.Be.updateRoom(this,t)},r.prototype.reload=function(){c.h(this.Be,"this._roomService"),this.Be.revertRoomChanges(this)},r.prototype.Y=function(t){i.h(t)&&(t.roomId&&this.Ae.setValue(t.roomId),t.alias&&this.Ue.setValue(t.alias),t.name&&this.re.setValue(t.name),t.description&&this.De.setValue(t.description),t.type&&this.K.setValue(t.type),t.options&&this.Ne.setValue(t.options),t.bridgeId&&this.je.setValue(t.bridgeId),t.pin&&this.Le.setValue(t.pin),t.members)},r.prototype.Ie=function(t){var e=this,t=f(t,this.Be);i.forEach(t,function(t){e.Fe.push(t)})},r.prototype.Ee=function(t){var n=this;i.forEach(t,function(e){n.Fe.remove(function(t){return e.sessionId===t.getSessionId()&&e.lastUpdate>=t.getObservableLastUpdate().getValue()})})},r.prototype.Te=function(n){i.forEach(this.Fe.getValue(),function(e){var t=i.find(n,function(t){return e.getSessionId()===t.sessionId&&t.lastUpdate>e.getObservableLastUpdate().getValue()});t&&e.Y(t)})},r}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(21),n(14)],e=function(u,a,c,s,t){"use strict";var e=t.roles,n=t.states;function i(t,e,n,i,r,s,o){this.init(t,e,n,i,r,s,o)}function o(t){return new s(t.uri,t.type,t.audioState,t.videoState)}function h(t){return a.M(t,e,"memberRole"),u.getEnumName(e,t)}function f(t){return a.M(t,n,"memberState"),u.getEnumName(n,t)}return i.prototype.init=function(t,e,n,i,r,s,o){a.h(t,"roomService"),a.u(n,"sessionId"),a.u(i,"screenName"),a.isArray(s,"streams"),a.v(u.utc(o),"lastUpdate"),this.Pe=new c.Observable(n),this._e=new c.Observable(i),this.We=new c.ObservableArray([]),this.Ve=new c.Observable(e,f).extend({rateLimit:500}),this.ze=new c.Observable(r,h),this.He=new c.Observable(o,u.utc),this.Be=t,this.setStreams(s)},i.prototype.getObservableState=function(){return this.Ve},i.prototype.getSessionId=function(){return this.Pe.getValue()},i.prototype.getObservableScreenName=function(){return this._e},i.prototype.getObservableRole=function(){return this.ze},i.prototype.getObservableStreams=function(){return this.We},i.prototype.getObservableLastUpdate=function(){return this.He},i.prototype.getLastUpdate=function(){return this.He.getValue()},i.prototype.getStreams=function(){return u.map(this.We.getValue(),function(t){return t.toJson()})},i.prototype.getRoomService=function(){return this.Be},i.prototype.commitChanges=function(t){a.h(this.Be,"this._roomService"),this.Be.updateMember(this,t)},i.prototype.reload=function(){a.h(this.Be,"this._roomService"),this.Be.revertMemberChanges(this)},i.prototype.setStreams=function(t){t=u.map(t,o);this.We.setValue(t)},i.prototype.toString=function(){return this.getObservableRole().getValue()+"["+this.getObservableScreenName().getValue()+","+this.getSessionId()+"]"},i.prototype.toJson=function(){var e={sessionId:this.Pe.getValue(),screenName:this._e.getValue(),role:this.ze.getValue(),state:this.Ve.getValue(),streams:[],lastUpdate:this.He.getValue()};return u.forEach(this.We.getValue(),function(t){e.streams.push(t.toJson())}),e},i.prototype.Y=function(t){u.h(t)&&(Object.prototype.hasOwnProperty.call(t,"state")&&this.Ve.setValue(t.state),Object.prototype.hasOwnProperty.call(t,"screenName")&&this._e.setValue(t.screenName),Object.prototype.hasOwnProperty.call(t,"role")&&this.ze.setValue(t.role),Object.prototype.hasOwnProperty.call(t,"lastUpdate")&&this.He.setValue(t.lastUpdate),Object.prototype.hasOwnProperty.call(t,"streams"))&&!function(t){var e=this.We.getValue(),n=[];u.forEach(t,function(i){var r=s.parsePCastStreamIdFromStreamUri(i.uri),t=u.find(e,function(t){var e=t.getUri()===i.uri,n=t.isPCastStream()&&t.getPCastStreamId()===r,e=e||n;return t.getType()===i.type&&e});t?t.Y(i):t=o(i),n.push(t)}),this.We.setValue(n)}.call(this,t.streams)},i}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{states:{trackEnabled:{id:0,name:"TrackEnabled"},trackDisabled:{id:1,name:"TrackDisabled"},trackEnded:{id:2,name:"TrackEnded"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(3),n(99)],e=function(m,s,v,o){"use strict";function t(t,e){s.h(t,"pcast"),e&&s.h(e,"options"),e&&e.screenShare&&s.g(e.screenShare,"options.screenShare"),this.qe=t,this.D=t.getLogger(),this.Ne=e||{},this.Ge=m.get(e,["onScreenShare"])}function g(u,a,c,h,f){var l=this.getVendorSpecificConstraints(u,a||{},c),d=!!l.video,p=this;this.qe.getUserMedia(l,function(t,e,n,i){if("ok"===e)return p.D.info("Acquired user media with constraints [%s]",l),f(null,{userMedia:n,options:{frameRate:d?c:null,resolution:d?m.get(a,["resolution"],null):null,aspectRatio:d?m.get(a,["aspectRatio"],null):null}});p.D.info("Failed to acquire user media with constraints [%s]",l);var r=a,s=c,o=(n=i).constraintName||n.constraint||"";if(i&&("ConstraintNotSatisfiedError"===i.name||"OverconstrainedError"===i.name||"OverconstrainedError"===i.constructor.name||"unavailable"===i.code&&"Edge"===v.browser))switch(o.toLowerCase()){case"width":case"height":if(a&&h.canResolveNextResolution())return p.D.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",o,r.height,r.width),r=h.getNextResolution(a.height,a.aspectRatio),g.call(p,u,r,s,h,f);break;default:if(c)return p.D.warn("Unable to get user media with constraint [%s] and frame rate [%s]. Retrying without frame rate constraint.",o,c),g.call(p,u,r,s=null,h,f);if(a&&h.canResolveNextResolution())return p.D.warn("Unable to get user media with constraint [%s] with height [%s] and width [%s]. Retrying with next closest resolution.",o,r.height,r.width),r=h.getNextResolution(a.height,a.aspectRatio),g.call(p,u,r,s,h,f)}return p.D.error("Unable to get user media with status [%s]",e,i),f(i)},function(t){var e,n,i,r=t;if(p.Ge&&"Chrome"===v.browser){t=t,o=m.get(t,["video","mandatory","chromeMediaSource"]),e=m.get(t,["audio","mandatory","chromeMediaSource"]),n=m.get(t,["video","mandatory","chromeMediaSourceId"]),t=m.get(t,["audio","mandatory","chromeMediaSourceId"]),i={},(o||t)&&(m.set(i,["screen","mediaSource"],o),m.set(i,["screen","mediaSourceId"],n)),(e||t)&&(m.set(i,["screenAudio","mediaSource"],e),m.set(i,["screenAudio","mediaSourceId"],t));var s,o=i;if((r=p.Ge(o)).resolution&&r.aspectRatio)switch(this.Je){case"9x16":case"3x4":s={width:r.resolution,height:h.calculateLongerDimensionByAspectRatio(r.resolution,r.aspectRatio)};break;default:s={width:h.calculateLongerDimensionByAspectRatio(r.resolution,r.aspectRatio),height:r.resolution}}r=function(t,e,n){var t=this.getVendorSpecificConstraints(t,e,n),e=(t.screen&&(t.video=t.screen,delete t.screen),t.screenAudio&&(t.audio=t.screenAudio,delete t.screenAudio),m.get(t,["video","mandatory","mediaSource"])),n=m.get(t,["audio","mandatory","mediaSource"]),i=m.get(t,["video","mandatory","mediaSourceId"]),r=m.get(t,["audio","mandatory","mediaSourceId"]);return(e||i)&&(m.set(t,["video","mandatory","chromeMediaSource"],e),m.set(t,["video","mandatory","chromeMediaSourceId"],i),delete t.video.mandatory.mediaSource,delete t.video.mandatory.mediaSourceId),(n||r)&&(m.set(t,["audio","mandatory","chromeMediaSource"],n),m.set(t,["audio","mandatory","chromeMediaSourceId"],r),delete t.audio.mandatory.mediaSource,delete t.audio.mandatory.mediaSourceId),t}.call(p,o,s,r.frameRate)}return r})}return t.prototype.getUserMedia=function(t,e){s.h(t,"deviceOptions");var n=new o(this.Ne),i=n.getDefaultResolution(),r=n.getDefaultFrameRate();g.call(this,t,i,r,n,e)},t.prototype.getVendorSpecificConstraints=function(t,e,n){var i,r,s,o,u,a,c,h;if(e=e||{},t&&(t.audio||t.video||t.screen||t.screenAudio))return"Firefox"===v.browser&&38<v.browserVersion||"Chrome"===v.browser&&52<v.browserVersion&&!t.screen&&!t.screenAudio||"Safari"===v.browser&&10<v.browserVersion||"Opera"===v.browser&&40<v.browserVersion?(a=e,c=n,s=t.video,i=t.audio,r=t.screen,o=t.screenAudio,u=a.width,a=a.height,h={},s&&(h.video={height:{min:a,ideal:a,max:a},width:{min:u,ideal:u,max:u},frameRate:{ideal:c,max:c}},s.deviceId&&(h.video.deviceId={exact:s.deviceId}),s.facingMode&&(h.video.facingMode=s.facingMode),u||delete h.video.width,a||delete h.video.height,c||delete h.video.frameRate,u||a||c||s.deviceId||s.facingMode||(h.video=!0)),i&&(h.audio={},i.deviceId&&(h.audio.deviceId={exact:i.deviceId}),i.mediaSource&&(h.audio.mediaSource=i.mediaSource),i.mediaSourceId&&(h.audio.mediaSourceId=i.mediaSourceId),i.deviceId||i.mediaSource||i.mediaSourceId||(h.audio=!0)),o&&(h.screenAudio={},o.deviceId&&(h.screenAudio.deviceId={exact:o.deviceId}),o.mediaSource&&(h.screenAudio.mediaSource=o.mediaSource),o.mediaSourceId&&(h.screenAudio.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(h.screenAudio=!0)),r&&(h.screen={height:{min:a,ideal:a,max:a},width:{min:u,ideal:u,max:u},frameRate:{ideal:c,max:c}},u||delete h.screen.width,a||delete h.screen.height,c||delete h.screen.frameRate,r.mediaSource&&(h.screen.mediaSource=r.mediaSource),u||a||c||r.mediaSource||(h.screen=!0)),r&&s&&(h.screen=!0),h):"Edge"===v.browser?(i=e,o=n,u=t.video,a=t.audio,c=t.screen,r=i.width,s=i.height,h={},u&&(h.video={height:{min:s,max:s,exact:s},width:{min:r,max:r,exact:r},frameRate:o},u.deviceId&&(h.video.deviceId=u.deviceId),u.facingMode&&(h.video.facingMode=u.facingMode),r||delete h.video.width,s||delete h.video.height,o||delete h.video.frameRate,r||s||o||u.deviceId||u.facingMode||(h.video=!0)),a&&(h.audio=!0,a.deviceId)&&(h.audio={deviceId:a.deviceId}),c&&(h.screen=!0),h):(i=e,r=n,s=t.video,o=t.audio,u=t.screen,a=t.screenAudio,c=i.width,h=i.height,e={},s&&(e.video={mandatory:{minHeight:h,maxHeight:h,minWidth:c,maxWidth:c,maxFrameRate:r}},s.deviceId&&(e.video.mandatory.sourceId=s.deviceId),s.facingMode&&(e.video.facingMode=s.facingMode),s.mediaSource&&(e.video.mandatory.mediaSource=s.mediaSource),s.mediaSourceId&&(e.video.mandatory.mediaSourceId=s.mediaSourceId),c||(delete e.video.mandatory.minWidth,delete e.video.mandatory.maxWidth),h||(delete e.video.mandatory.minHeight,delete e.video.mandatory.maxHeight),r||delete e.video.mandatory.maxFrameRate,c||h||r||s.deviceId||s.facingMode||s.mediaSource||s.mediaSourceId||(e.video=!0)),o&&(e.audio={mandatory:{}},o.deviceId&&(e.audio.mandatory.sourceId=o.deviceId),o.mediaSource&&(e.audio.mandatory.mediaSource=o.mediaSource),o.mediaSourceId&&(e.audio.mandatory.mediaSourceId=o.mediaSourceId),o.deviceId||o.mediaSource||o.mediaSourceId||(e.audio=!0)),a&&(e.screenAudio={mandatory:{}},a.deviceId&&(e.screenAudio.mandatory.sourceId=a.deviceId),a.mediaSource&&(e.screenAudio.mandatory.mediaSource=a.mediaSource),a.mediaSourceId&&(e.screenAudio.mandatory.mediaSourceId=a.mediaSourceId),a.deviceId||a.mediaSource||a.mediaSourceId||(e.screenAudio=!0)),u&&(e.screen={mandatory:{minHeight:h,maxHeight:h,minWidth:c,maxWidth:c,maxFrameRate:r}},c||(delete e.screen.mandatory.minWidth,delete e.screen.mandatory.maxWidth),h||(delete e.screen.mandatory.minHeight,delete e.screen.mandatory.maxHeight),r||delete e.screen.mandatory.maxFrameRate,u.mediaSource&&(e.screen.mandatory.mediaSource=u.mediaSource),u.mediaSourceId&&(e.screen.mandatory.mediaSourceId=u.mediaSourceId),c||h||r||u.mediaSource||(e.screen=!0)),u&&s&&(e.screen=!0),e);throw new Error("Invalid device options. Must pass in at least one device option.")},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(38),n(23),n(3),n(100)],e=function(d,p,e,r,i,m,l){"use strict";var n=0,a=1e3,s={maxOfflineTime:18e4,maxReconnectFrequency:6e4};function t(t){if(p.h(t,"options"),p.R(t.authToken,"options.authToken"),"adminApiProxyClient"in t)throw new Error('"options.adminApiProxyClient" is no longer supported. Please use "options.authToken" instead.');if(t.onError&&p.g(t.onError,"options.onError"),!d.isNullOrUndefined(t.onlineTimeout)&&(p.v(t.onlineTimeout,"options.onlineTimeout"),t.onlineTimeout<0))throw new Error('"options.onlineTimeout" must be a positive number');t.reconnectOptions&&(p.h(t.reconnectOptions,"options.reconnectOptions"),p.v(t.reconnectOptions.maxOfflineTime,"options.reconnectOptions.maxOfflineTime"),p.v(t.reconnectOptions.maxReconnectFrequency,"options.reconnectOptions.maxReconnectFrequency")),this.Ke=++n,this.Qe=new e.Observable(null).extend({rateLimit:0}),this.Xe=new e.Observable(null).extend({rateLimit:0}),this.xt={},this.Ze=!1,this.$e=0,this.Ye=0,this.Yt=!1,this.rt=t.authToken,this.tn=t.onError,this.Ne=t,this.en=d.v(t.onlineTimeout)?t.onlineTimeout:2e4,this.nn=t.reconnectOptions||s,this.D=null,this.rn={},o.call(this)}function o(){var t,n=this;return this.Qe.getValue()||(t=d.assign({logger:this.D},this.Ne),this.Qe.setValue(new i(t))),this.D||(this.D=this.Qe.getValue().getLogger()),this.sn||(this.sn=this.Qe.getValue().getObservableStatus().subscribe(d.bind(u,this))),this.sessionIdSubscription&&this.sessionIdSubscription.dispose(),this.sessionIdSubscription=this.Qe.getValue().getObservableSessionId().subscribe(d.bind(function(t){this.Xe.setValue(t)},this)),this.Qe.getValue().start(function(t,e){if("critical-network-issue"===e)return u.call(n,e)},d.noop,d.noop)}function u(t){switch(t){case"timeout":case"critical-network-issue":return this.Qe.getValue()&&(this.Qe.getValue().stop("recovery"),this.Qe.setValue(null)),this.Xe.getValue()&&this.Xe.setValue(null),this.sn&&(this.sn.dispose(),this.sn=null),this.$e++,c.call(this);case"reconnect-failed":case"unauthorized":return delete this.rt,h.call(this,new Error(t));case"capacity":case"network-unavailable":return this.$e++,c.call(this);case"online":return this.Ze?this.D.info("[%s] Successfully reconnected (reconnectCount=[%s],reauthCount=[%s])",this,this.$e,this.Ye):this.D.info("[%s] Successfully instantiated",this),this.Ye=0,this.$e=0,void(this.Ze=!0);case"reconnecting":case"reconnected":case"connecting":break;case"offline":return;default:return h.call(this,new Error(t))}}function c(){var t=this,e=Math.min(a*t.$e*t.$e,this.nn.maxReconnectFrequency),n=Math.min(e/1e4,5),e=e+Math.random()*n*1e3;this.D.info("[%s] Waiting for [%s] ms before continuing to attempt to reconnect to PCast",this,e),this.un=setTimeout(function(){if(!t.Qe.getValue()||!t.Qe.getValue().isStarted())return o.call(t)},e)}function h(t){if(!this.tn)throw t;this.tn(t)}function f(t,n,i){new r(t,{aspectRatio:n.aspectRatio,resolution:n.resolution,frameRate:n.frameRate,resolutionSelectionStrategy:n.resolutionSelectionStrategy,onScreenShare:function(t){return(t=n.onScreenShare?n.onScreenShare(t):t).resolution&&p.v(t.resolution,"clientOptions.resolution"),t.frameRate&&p.v(t.frameRate,"screenOptions.frameRate"),t.aspectRatio&&p.R(t.aspectRatio,"screenOptions.aspectRatio"),d.assign({resolution:t.resolution},t)}}).getUserMedia(n.mediaConstraints,function(t,e){if(t)return i(t);n.onResolveMedia&&n.onResolveMedia(e.options),i(null,d.assign({status:"ok"},e))})}function v(t,e,n,i){try{var r=this.parseCapabilitiesFromToken(e.token);e.capabilities=r}catch(t){return i(new Error("Bad `token`",t),{status:"bad-token"})}return function(s,o,u,a,c){var h=this,f=!1,l=null;function e(t,e,n){function i(t){var e=d.assign({token:s,isContinuation:!0},u);h.D.warn("[%s] Retrying publisher after failure with reason [%s]",this,t),h.rn[n.getStreamId()]=!0,"camera-track-failure"===t?(n.stop(t,!1),h.publish(u,c)):(n.stop(t,!0),v.call(h,o,e,a,c))}if("ok"!==e)return h.D.warn("[%s] Failure to publish with status [%s]",this,e),l&&(h.rn[l.getStreamId()]=!0),c(null,{status:e});delete u.authFailure,h.xt[n.getStreamId()]=n,l=n;var e=d.bind(S,h,function(){},i,!0),r=(u.monitor&&(r=d.bind(k,h,u.monitor.callback,i),n.monitor(u.monitor.options||{},r),e=d.bind(S,h,u.monitor.callback,i,!0)),n.setPublisherEndedCallback(e),function(n,i,r){var s=this,o=d.bind(n.stop,n);return n.stop=function(t,e){s.D.info("[%s] [%s] Stopping publisher with reason [%s]",s,n.getStreamId(),t),o(t),i&&(i.src="",i.srcObject=null),r&&n.getStream()&&!e&&(t=n.getStream())&&t.getTracks().forEach(function(t){t.stop()})},n.enableAudio=function(){return y.call(s,n,!0)},n.disableAudio=function(){return y.call(s,n,!1)},n.enableVideo=function(){return w.call(s,n,!0)},n.disableVideo=function(){return w.call(s,n,!1)},n.setPublisherEndedCallback=function(){},n}.call(h,n,u.videoElement,a));u.videoElement&&!f&&(m.attachMediaStream(u.videoElement,o,function(t){t&&h.D.warn("[%s] [%s] Failed to attach publish media stream to video element.",this,n.getStreamId(),t)}),f=!0),c(null,{status:"ok",publisher:r})}u.tags&&p.isArray(u.tags,"options.tags"),u.connectOptions&&p.isArray(u.connectOptions,"options.connectOptions"),h.waitForOnline(function(t){if(t)return c(t);h.Qe.getValue().publish(s,o,e,u.tags,{connectOptions:u.connectOptions})},u.isContinuation)}.call(this,e.token,t,e,n,i)}function g(u,a,c){function e(t,e,n){function i(t){var e=d.assign({isContinuation:!0},a);h.rn[n.getStreamId()]=!0,n.stop(t),h.D.warn("[%s] [%s] Stream failure occurred with reason [%s]. Attempting to recover from failure.",this,a.streamId,t),g.call(h,u,e,c)}var r;if("streaming-not-ready"===e)return h.D.warn("[%s] Failure to subscribe with status [%s]. Try again in a few seconds.",this,e),c(null,{status:e,retry:d.bind(i,h,e)});if("ok"!==e)return h.D.warn("[%s] Failure to subscribe with status [%s]",this,e),f&&(h.rn[f.getStreamId()]=!0),c(null,{status:e});delete a.authFailure,f=n,a.videoElement&&(r=n.createRenderer()).start(a.videoElement);var e=d.noop,e=d.bind(S,h,e,i,!1),s=(a.monitor&&(o=d.bind(k,h,a.monitor.callback,i),n.monitor(a.monitor.options||{},o),e=d.bind(S,h,a.monitor.callback,i,!1)),n.setStreamEndedCallback(e),function(e,n){var i=this,r=d.bind(e.stop,e);return e.stop=function(t){i.D.info("[%s] [%s] Stopping subscriber with reason [%s]",i,e,t),n&&n.stop(t),r(t)},e.enableAudio=function(){return y(e.getStream(),!0)},e.disableAudio=function(){return y(e.getStream(),!1)},e.enableVideo=function(){return w(e.getStream(),!0)},e.disableVideo=function(){return w(e.getStream(),!1)},e.setStreamEndedCallback=function(){},e}.call(h,n,r)),o={status:"ok",mediaStream:s};n.setStreamErrorCallback(function(t,e,n){return"real-time"===e&&"connection-timeout"===n.message?i.call(h,n.message):"shaka"!==e||n.severity===l.errorSeverity.critical.id?"phenix-player"===e&&1===n.severity?(h.D.warn("[%s] [%s] Recoverable error occurred while playing stream with Express API. Attempting to subscribe again.",this,s.getStreamId(),n),e=d.assign({isContinuation:!0},a),h.subscribe(e,c)):(h.D.warn("[%s] [%s] Error occurred while playing stream with Express API. Stopping stream.",this,s.getStreamId(),n),s.stop(),c(n)):void 0}),r&&(o.renderer=r),c(null,o)}var h=this,f=null;h.waitForOnline(function(t){if(t)return c(t);t=d.clone(a.subscriberOptions||{});a.streamId&&(t.originStreamId=a.streamId),h.Qe.getValue().subscribe(u,e,t)},a.isContinuation)}function y(t,e){var n=this.getPCast();if(n){var i=t.getStreamId(),n=n.getRemoteDescriptionSdp(i);if(n){i=t.getStream(),t=n.lastIndexOf("m=audio");if(!(t<0)){var r=n.lastIndexOf("m=video");if(r<t&&(r=n.length),!n.substring(t,r).includes("a=inactive")&&i)return b(i.getAudioTracks(),e),e}}}}function w(t,e){var n=this.getPCast();if(n){var i=t.getStreamId(),n=n.getRemoteDescriptionSdp(i);if(n){i=t.getStream(),t=n.lastIndexOf("m=video");if(!(t<0)){var r=n.lastIndexOf("m=audio");if(r<t&&(r=n.length),!n.substring(t,r).includes("a=inactive")&&i)return b(i.getVideoTracks(),e),e}}}}function b(t,e){p.isArray(t,"tracks"),d.forEach(t,function(t){t.updateState(e)})}function k(t,e,n,i,r){switch(i){case"camera-track-failure":case"client-side-failure":t(null,d.assign({status:i,retry:d.bind(e,null,i)},r))}}function S(t,e,n,i,r,s){var o={status:"stream-ended",reason:r,description:s};if(this.rn[i.getStreamId()])this.D.info("[%s] Ignoring stream end due to recovery in progress [%s]",this,i.getStreamId());else switch(r){case"egress-setup-failed":case"ended":case"censored":var u={status:r,reason:r,description:s};return n?u.publisher=i:u.mediaStream=i,t(null,u);case"custom":return t(null,o);case"egress-failed":case"capacity":return void setTimeout(function(){if(!this.Yt)return e(r)},a);case"failed":case"maintenance":case"overload":return e(r);default:return o.retry=e,t(null,o)}}return t.prototype.toString=function(){return"PCastExpress["+this.Ke+"]"},t.prototype.dispose=function(){this.an&&(this.an.dispose(),this.an=null),this.Qe.getValue()&&(this.Qe.getValue().stop(),this.Qe.setValue(null)),this.Xe.getValue()&&this.Xe.setValue(null),d.v(this.un)&&(clearTimeout(this.un),this.un=null),this.sessionIdSubscription&&this.sessionIdSubscription.dispose(),this.Xe&&this.Xe.dispose&&this.Xe.dispose(),this.$e=0,this.Ye=0,this.Yt=!0,this.D.info("[%s] Disposed PCast Express instance",this)},t.prototype.getPCast=function(){return this.Qe.getValue()},t.prototype.getPCastObservable=function(){return this.Qe},t.prototype.getSessionIdObservable=function(){return this.Xe},t.prototype.getUserMedia=function(e,n){var i=this;if(p.h(e.mediaConstraints,"options.mediaConstraints"),p.g(n,"callback"),e.resolution&&p.v(e.resolution,"options.resolution"),e.frameRate&&p.v(e.frameRate,"options.frameRate"),e.aspectRatio&&p.R(e.aspectRatio,"options.aspectRatio"),e.onResolveMedia&&p.g(e.onResolveMedia,"options.onResolveMedia"),e.onScreenShare&&p.g(e.onScreenShare,"options.onScreenShare"),i.Qe.getValue())return f.call(i,i.Qe.getValue(),e,n);var r=i.Qe.subscribe(function(t){t&&(r.dispose(),f.call(i,t,e,n))})},t.prototype.publish=function(n,i){if(p.h(n,"options"),p.g(i,"callback"),"capabilities"in n)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if(n.connectOptions&&p.isArray(n.connectOptions,"options.connectOptions"),n.mediaConstraints?p.h(n.mediaConstraints,"options.mediaConstraints"):p.h(n.userMediaStream,"options.userMediaStream"),n.videoElement&&p.h(n.videoElement,"options.videoElement"),n.monitor&&(p.h(n.monitor,"options.monitor"),p.g(n.monitor.callback,"options.monitor.callback"),n.monitor.options)&&p.h(n.monitor.options,"options.monitor.options"),"streamToken"in n)throw new Error('"options.streamToken" is no longer supported. Please use "options.token" instead.');if("publishToken"in n)throw new Error('"options.publishToken" is no longer supported. Please use "options.token" instead.');if(!n.token)throw new Error('Cannot publish. Please use "options.token".');if(p.R(n.token,"options.token"),"publish"!==this.Qe.getValue().parseTypeFromToken(n.token))throw new Error('Cannot publish. Please use a token of type "publish".');var r=this;this.waitForOnline(function(t){return t?i(t):n.userMediaStream?v.call(r,n.userMediaStream,n,!1,i):void r.getUserMedia(n,function(t,e){return t?i(t):"ok"!==e.status?i(null,e):void v.call(r,e.userMedia,n,!0,i)})},n.isContinuation)},t.prototype.publishScreen=function(t,e){t=d.assign({mediaConstraints:{screen:!0}},t);return d.set(t,["monitor","options"],d.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},d.get(t,["monitor","options"],{}))),this.publish(t,e)},t.prototype.subscribe=function(e,n){if(p.h(e,"options"),p.g(n,"callback"),p.R(e.streamId,"options.streamId"),"capabilities"in e)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if(e.videoElement&&p.h(e.videoElement,"options.videoElement"),e.monitor&&(p.h(e.monitor,"options.monitor"),p.g(e.monitor.callback,"options.monitor.callback"),e.monitor.options)&&p.h(e.monitor.options,"options.monitor.options"),"streamToken"in e)throw new Error('"options.streamToken" is no longer supported. Please use "options.token" instead.');if("publishToken"in e)throw new Error('"options.publishToken" is no longer supported. Please use "options.token" instead.');if(!e.token)throw new Error('Cannot subscribe. Please use "options.token".');p.R(e.token,"options.token");var t=this.Qe.getValue().parseTypeFromToken(e.token);if("publish"===t||"auth"===t)throw new Error('Cannot subscribe. Please use token without type or with type "stream".');e.subscriberOptions&&p.h(e.subscriberOptions,"options.subscriberOptions");var i=this;this.waitForOnline(function(t){return t?(i.D.error("[%s] Failed to subscribe after error waiting for online status",this,t),n(t)):g.call(i,e.token,e,n)},e.isContinuation)},t.prototype.subscribeToScreen=function(t,e){t=d.assign({},t);return d.set(t,["monitor","options"],d.assign({},{monitorFrameRate:!1,videoBitRateThreshold:100,conditionCountForNotificationThreshold:8},d.get(t,["monitor","options"],{}))),this.subscribe(t,e)},t.prototype.waitForOnline=function(e,t){if(p.g(e,"callback"),this.Qe.getValue()&&"online"===this.Qe.getValue().getStatus())return e();var n=this,i=t?d.get(n.nn,["maxOfflineTime"]):this.en,r=null,s=null,o=setTimeout(function(){n.D.info("[%s] Disposing of online listener after [%s] ms",this,i),r&&r.dispose(),s&&s.dispose(),n.Yt?n.D.info("[%s] Instance was disposed while waiting for online, ignoring callback",this):e(new Error("timeout"))},i),r=(this.D.info("[%s] Waiting for online status before continuing. Timeout set to [%s]",this,i),this.Qe.subscribe(function(t){s&&s.dispose(),t&&(s=t.getObservableStatus().subscribe(function(t){if(n.Yt)n.D.info("[%s] Instance was disposed while waiting for online, canceling waiting and skip triggering callback",this),clearTimeout(o),s.dispose(),r.dispose();else{if("online"===t)return clearTimeout(o),s.dispose(),r.dispose(),e();n.D.info("[%s] Still waiting for online status before continuing. Current status is [%s]",this,t)}},{initial:"notify"}))},{initial:"notify"}))},t.prototype.parseCapabilitiesFromToken=function(t){return this.Qe.getValue().parseCapabilitiesFromToken(t)},t.prototype.parseRoomOrChannelIdFromToken=function(t){return this.Qe.getValue().parseRoomOrChannelIdFromToken(t)},t.prototype.parseRoomOrChannelAliasFromToken=function(t){return this.Qe.getValue().parseRoomOrChannelAliasFromToken(t)},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(39),n(33),n(41),n(21),n(15),n(14),n(22),n(37)],e=function(l,a,t,h,e,d,n,p,u,m,c,f){"use strict";function i(t){if(a.h(t,"options"),t.pcastExpress&&a.h(t.pcastExpress,"options.pcastExpress"),"enableWildcardCapability"in t)throw new Error('"options.enableWildcardCapability" is no longer supported.');this.cn=t.pcastExpress||new e(t),this.hn=!t.pcastExpress,this.fn={},this.ln=[],this.dn={},this.pn=[],this.mn={},this.D=this.cn.getPCast().getLogger(),this.H=new h.DisposableList,this.Yt=!1,this.vn=!1,this.gn=null;var n=this;this.cn.getPCastObservable().subscribe(function(e){e&&(n.D.info("Resetting Room Express after change in pcast."),n.cn.waitForOnline(function(){n.cn.getPCastObservable().getValue()===e&&l.forOwn(n.fn,function(t){t.setPCast(e)})}))})}function v(t){try{return this.cn.parseCapabilitiesFromToken(t)}catch(t){}}function g(e,n){return l.find(this.pn,function(t){t=t.getObservableActiveRoom().getValue();return t&&(t.getRoomId()===e||t.getObservableAlias().getValue()===n)})}function y(o,u,a){var c=this,h=o.role,f=o.screenName||l.uniqueId();!function(e,n,i){var r=this,s=l.uniqueId();this.cn.waitForOnline(function(t){if(t)return i(t);t=g.call(r,e,n);if(t)return r.D.info("Reusing room service for room [%s]/[%s]",e,n),i(null,{status:"ok",roomService:t});r.fn[s]=new d(r.cn.getPCast());t=function(r,t){var s=this,e=r.stop,o=r.leaveRoom;return r.stop=function(){e.apply(r,arguments),delete s.fn[t]},r.leaveRoom=function(n,t){var i=r.getObservableActiveRoom().getValue();o.call(r,function(t,e){return t?(r.stop("leave-room-failure"),n(t)):("ok"!==e.status&&"not-in-room"!==e.status||(s.D.info("Successfully disposed Express Room Service [%s]",i?i.getRoomId():"Uninitialized"),r.stop("leave-room")),n(null,e))},t)},r}.call(r,r.fn[s],s);r.D.info("Creating room service for room [%s]/[%s]",e,n),i(null,{status:"ok",roomService:t})})}.call(c,o.roomId,o.alias,function(t,e){var n,i,r,s;return t?u(t):"ok"!==e.status?u(null,e):(n=e.roomService,t=(i=n.getObservableActiveRoom()).getValue(),r=null,s=function(){var t=i.getValue();t?(c.D.info("Setup member subscription for room [%s]",t.getRoomId()),r=t.getObservableMembers().subscribe(a,{initial:"notify"}),c.H.add(i.subscribe(function(t){r&&(a([]),r.dispose(),r=null),t&&(r=t.getObservableMembers().subscribe(a,{initial:"notify"}))}))):c.D.warn("Unable to setup members subscription. Not in room.")},t||n.start(h,f),o.streams&&0<o.streams.length&&(l.includes(o.streams[0].uri,p.getPCastPrefix())||(o.streams[0].uri=p.getPCastPrefix()+o.streams[0].uri,c.ln.push(o.streams[0].uri)),e=o.role,function(t,e,n,i){var r=n?n.getObservableActiveRoom().getValue():null;if(t&&n&&n.getSelf().setStreams(t),e&&n&&n.getSelf().getObservableRole().setValue(0===t.length?m.roles.audience.name:e),r&&n.getSelf())return S.call(this,n.getSelf(),i)}.call(c,o.streams,e,n,function(t){if(t)return u(t)})),void(t?(u(null,{status:"ok",roomService:n}),a&&s()):n.enterRoom(o.roomId,o.alias,function(t,e){return t?(n.stop("enter-room-failure"),u(t)):"not-found"===e.status?(n.stop("enter-room-failure"),u(null,{status:"room-not-found"})):"ok"!==e.status&&"already-in-room"!==e.status?(n.stop("enter-room-failure"),u(null,e)):(c.pn.push(n),u(null,{status:"ok",roomService:n}),a?s():void 0)})))})}function w(e,t){this.dn[t.getRoomId()]&&e&&(this.dn[t.getRoomId()]=l.filter(this.dn[t.getRoomId()],function(t){return t.getStreamId()!==e.getStreamId()}))}function b(r,t){var e,n=this,i=g.call(this,t.getRoomId(),t.getObservableAlias().getValue()),s=r?[r]:[];return i&&(i=i.getSelf())&&(i=l.map(i.getObservableStreams().getValue(),function(t){return t.toJson()}),t=this.dn[t.getRoomId()]||[],e=l.map(t,function(t){return t.getStreamId()}),i)&&0!==i.length?(r&&(i=l.filter(i,function(t){var e=t.uri===r.uri,n=p.parsePCastStreamIdFromStreamUri(t.uri),n=!!n&&n===p.parsePCastStreamIdFromStreamUri(r.uri),i=r.uri.split("?")[0]===t.uri.split("?")[0],t=t.type===r.type;return!e&&!n&&!i||!t})).push(r),l.filter(i,function(t){return!p.parsePCastStreamIdFromStreamUri(t.uri)||l.includes(e,p.parsePCastStreamIdFromStreamUri(t.uri)||t.uri)||l.includes(n.ln,t.uri.split("?")[0])})):s}function k(t,e,n,i,r,s){var o=g.call(this,i.getRoomId(),i.getObservableAlias().getValue()),n=n?n.getObservableActiveRoom().getValue():null,u=!n&&!o;return this.Yt?this.D.warn("Unable to update self after express room service disposal."):(t&&o&&(this.D.debug("Preparing member streams for update in room [%s].",i.getRoomId()),o.getSelf().setStreams(t)),e&&o&&o.getSelf().getObservableRole().getValue()!==e&&(this.D.debug("Preparing member role for update in room [%s].",i.getRoomId()),o.getSelf().getObservableRole().setValue(e)),n&&o.getSelf()?S.call(this,o.getSelf(),s):void(u&&(this.D.info("Joining room with member [%s].",i.getRoomId()),t=l.assign({role:e,alias:l.get(r,["room","alias"]),roomId:l.get(r,["room","roomId"])},r),y.call(this,t,function(t,e){return t?s(t):"ok"!==e.status&&"already-in-room"!==e.status?s(null,e):void s(t,e)}))))}function S(i,r){var s=0,o=this;try{i.commitChanges(function t(e,n){!e&&n||s++;e=i.getRoomService(),e=e?e.getObservableActiveRoom().getValue():null;return n&&"ok"===n.status||!e&&"not-found"===n.status?(s=0,o.vn=!1,!r||r(null,n)):(n&&"ok"!==n.status&&s++,5<=s?(o.D.warn("Unable to update self after [%s] attempts.",5),l.v(n.lastUpdate)&&(o.D.warn("Updating self last update from [%s] to [%s] to prevent permanent failure state. Our awareness of self does not match up with the server anymore.",i.getObservableLastUpdate().getValue(),n.lastUpdate),i.getObservableLastUpdate().setValue(n.lastUpdate)),o.vn=!1,r(new Error("Unable to update self"))):0<s&&s<5?(o.D.info("Unable to update self after [%s] attempts. Retrying.",s),i.commitChanges(t)):void 0)})}catch(t){r(t)}}function R(t,e,n){return e?t(e):n.retry?n.retry():void t(e,n)}return i.prototype.dispose=function(){this.Yt=!0,function(){l.forOwn(this.dn,function(t){l.forEach(t,function(t){t.stop("dispose")})}),l.forOwn(this.fn,function(t){t.stop("dispose")}),this.dn={},this.ln=[],this.fn={},this.pn=[]}.call(this),this.hn&&this.cn.dispose(),this.H.dispose(),this.D.info("Disposed Room Express Instance")},i.prototype.getPCastExpress=function(){return this.cn},i.prototype.joinRoom=function(t,s,e){if(a.h(t,"options"),a.g(s,"joinRoomCallback"),a.R(t.role,"options.role"),"streamToken"in t)throw new Error('"options.streamToken" is no longer supported. Please use "options.token" instead.');if(!t.token)throw new Error('Cannot join room. Please use "options.token".');if("roomId"in t)throw new Error('"options.roomId" is no longer supported. Please use "options.token" instead.');if("alias"in t)throw new Error('"options.alias" is no longer supported. Please use "options.token" instead.');function n(r){r&&y.call(o,t,function(t,e){var n,i=e;i&&i.roomService&&(n=i.roomService.leaveRoom,i.roomService.leaveRoom=function(t,e){u&&"offline"!==r.getObservableStatus()&&u.dispose(),n(t,e)}),s(t,e)},e)}e&&a.g(e,"membersChangedCallback"),t.screenName&&a.R(t.screenName,"options.screenName"),t.streams&&a.isArray(t.streams,"options.streams"),a.R(t.token,"options.token");var i=this.cn.parseRoomOrChannelIdFromToken(t.token),r=this.cn.parseRoomOrChannelAliasFromToken(t.token),o=(i&&(t.roomId=i,this.D.info("Room ID is set to [%s] from token [%s]",i,t.token)),r&&(t.alias=r,this.D.info("Alias is set to [%s] from token [%s]",r,t.token)),this);if(this.cn.getPCastObservable())return n(this.cn.getPCastObservable());var u=this.cn.getPCastObservable().subscribe(n)},i.prototype.publishToRoom=function(i,r){if(a.h(i,"options"),a.g(r,"callback"),"room"in i)throw new Error('"options.room" is no longer supported.');if("capabilities"in i)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if("tags"in i)throw new Error('"options.tags" is no longer supported. Please use "options.token" instead.');if("streamUri"in i)throw new Error('"options.streamUri" is no longer supported. Please use REST API to publish an URI instead.');if(i.mediaConstraints?a.h(i.mediaConstraints,"options.mediaConstraints"):a.h(i.userMediaStream,"options.userMediaStream"),i.videoElement&&a.h(i.videoElement,"options.videoElement"),i.screenName&&a.R(i.screenName,"options.screenName"),i.streamInfo&&a.h(i.streamInfo,"options.streamInfo"),"streamToken"in i)throw new Error('"options.streamToken" is no longer supported. Please use "options.token" instead.');if(!i.token)throw new Error('Cannot publish. Please use "options.token".');function n(t,n){var e=l.assign({monitor:{callback:l.bind(R,s,r),options:{conditionCountForNotificationThreshold:8}},streamInfo:{}},i);t.getObservableType().getValue()===u.types.channel.name?e.tags=["channelId:"+t.getRoomId(),"channelAlias:"+t.getObservableAlias().getValue()].concat(e.tags||[]):e.tags=["roomId:"+t.getRoomId(),"roomAlias:"+t.getObservableAlias().getValue()].concat(e.tags||[]),function(r,s,n){function t(t,e){if(u&&o&&clearInterval(u),t)return c(t);if("ok"!==e.status)return c(null,e);!function(t,e){this.dn[e.getRoomId()]||(this.dn[e.getRoomId()]=[]),this.dn[e.getRoomId()].push(t)}.call(a,e.publisher,s),w.call(a,o,s),o=e.publisher,a.mn[o.getStreamId()]=new h.DisposableList;var i=l.bind(o.stop,o);o.stop=function(){clearInterval(u),w.call(a,o,s);var t=b.call(a,null,s),e=g.call(a,s.getRoomId()),n=a.mn[o.getStreamId()];n&&(n.dispose(),delete a.mn[o.getStreamId()]),i.apply(o,arguments),e&&k.call(a,t,0===t.length?m.roles.audience.name:r.memberRole,e,s,r,function(t){if(t)return c(t)})},function(r,s,o){var t,u=this,a=r.getStream();a&&(t=a.getTracks(),l.forEach(t,function(i){var e=function(){u.vn=!0;var t=(i.enabled?f.states.trackEnabled:f.states.trackDisabled).name,e=g.call(u,s.getRoomId());if(e&&e.getSelf()){var e=e.getSelf().getObservableStreams().getValue(),e=l.find(e,function(t){return t.getPCastStreamId()===r.getStreamId()}),n=function(e){var t=l.find(this.pn,function(t){t=t.getSelf(),t=t?t.getObservableStreams().getValue():[];return l.find(t,function(t){return e===t})});return t?t.getSelf():null}.call(u,e);if(!e)return u.D.warn("[%s] [%s] Unable to update member state change after track state change [%s]. Member stream no longer exists on member model.",a.id,i.id,i.enabled);u.D.info("[%s] [%s] Track state changed to [%s], updating room member stream state [%s]",a.id,i.id,i.enabled,t),("video"===i.kind?e.getObservableVideoState():e.getObservableAudioState()).setValue(t),n&&S.call(u,n,o)}};i.updateState=function(t){this.enabled=t,function t(){u.gn&&(clearTimeout(u.gn),u.gn=null),u.vn?u.gn=setTimeout(function(){t()}):e()}()}}))}.call(a,o,s,c),function(t,e,n,i){var r,s,o=t.streamType,u=t.streamInfo,a=v.call(this,t.token);return a?(o=o,u=u,a=a,r=(e=e).getStream(),s=r?r.getAudioTracks():null,r=r?r.getVideoTracks():null,s=0<s.length&&s[0].enabled,r=0<r.length&&r[0].enabled,a.includes("audio-only")&&(r=!1),a.includes("video-only")&&(s=!1),e={uri:p.getPCastPrefix()+e.getStreamId(),type:o,audioState:(s?f.states.trackEnabled:f.states.trackDisabled).name,videoState:(r?f.states.trackEnabled:f.states.trackDisabled).name},delete(o=l.assign({},u,{streamToken:void 0,streamTokenForBroadcastStream:void 0,streamTokenForLiveStream:void 0})).streamToken,delete o.streamTokenForBroadcastStream,delete o.streamTokenForLiveStream,0<(s=l.reduce(o,function(t,e,n){return t+(t?"&":"?")+n+"="+e},"")).length&&(e.uri=e.uri+s),r=e,u=a.join(","),o=r.uri.indexOf("?"),s=-1<o?"&":"?",o=r.uri.indexOf("#",-1===o?r.uri.length:o),e=-1===o?r.uri:r.uri.substring(0,o),o=-1===o?"":r.uri.substring(o),r.uri=e+s+"capabilities="+u+o,a=r,e=g.call(this,n.getRoomId(),n.getObservableAlias().getValue()),s=l.assign({},t,{streams:b.call(this,a,n)}),k.call(this,s.streams,s.memberRole,e,n,s,i)):i(new Error("Bad `token`"),{status:"bad-token"})}.call(a,r,e.publisher,s,c)}var o,u,a=this,c=function(t,e){n(t,e&&l.assign({publisher:o},e))};if(l.get(r,["mediaConstraints","screen"],!1))return l.set(r,["streamInfo","isScreen"],!0),this.cn.publishScreen(r,t);this.cn.publish(r,t)}.call(s,e,t,function(t,e){r(t,e&&l.assign({roomService:n.roomService},e))})}i.viewerStreamSelectionStrategy&&a.R(i.viewerStreamSelectionStrategy,"options.viewerStreamSelectionStrategy"),a.M(i.streamType,c.types,"options.streamType"),a.M(i.memberRole,m.roles,"options.memberRole");var s=this,t=this.cn.parseRoomOrChannelIdFromToken(i.token),e=this.cn.parseRoomOrChannelAliasFromToken(i.token),o=(this.D.info("[%s] [%s] RoomId and Alias read from token [%s]",t,e,i.token),g.call(s,t,e));o?n(o.getObservableActiveRoom().getValue(),{roomService:o}):(o=l.assign({},i,{role:m.roles.audience.name,roomId:t,alias:e}),y.call(this,o,function(t,e){return t?r(t):"ok"!==e.status?r(null,e):void n(e.roomService.getObservableActiveRoom().getValue(),e)},function(){return null}))},i.prototype.publishScreenToRoom=function(t,e){t=l.assign({mediaConstraints:{screen:!0}},t);this.publishToRoom(t,e)},i.prototype.subscribeToMemberStream=function(n,t,r){if(a.h(n,"memberStream"),a.h(t,"options"),a.g(r,"callback"),"capabilities"in t)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if(!(e=v.call(this,t.token)))return this.D.warn("Failed to parse the `token` [%s]",t.token),r(new Error("Bad `token`"),{status:"bad-token"});var s=n.getPCastStreamId();if(!s)throw this.D.error("Invalid Member Stream. Unable to parse streamId from uri"),new Error("Invalid Member Stream. Unable to parse streamId from uri");var e=this.cn.getPCast().getSupportedFeatureAndCapabilityFromCapabilities(e);if("ok"!==e.status)return this.D.warn("[%s] Subscribing to member stream failed: [%s].",s,e.status),r(null,{status:e.status});this.D.info("Subscribing to member stream with feature [%s] and token [%s]",e.feature,!!t.token);var e=l.assign({},{streamId:s,token:t.token},t),t=n.getInfo(),t=l.get(t,["isScreen"],!1),o=new h.DisposableList;!function(t,e,i){function n(t,e){var n;return t?i(t):"ok"!==e.status&&"streaming-not-ready"!==e.status?i(null,e):(s++,"streaming-not-ready"===e.status&&s<3?(t=s*s*1e3,r.D.info("Waiting for [%s] ms before retrying after [streaming-not-ready] status.",t),n=setTimeout(e.retry,t),void r.H.add(new h.Disposable(function(){clearTimeout(n)}))):"streaming-not-ready"===e.status&&3<=s?i(null,{status:e.status}):(t=l.assign({},e,{status:"ok"}),1<s?(t.reason="stream-failure-recovered",i(null,t)):void i(null,t)))}var r=this,s=0;return e?r.cn.subscribeToScreen(t,n):r.cn.subscribe(t,n)}.call(this,e,t,function(t,i){if(o.dispose(),i&&"ok"===i.status&&i.mediaStream&&i.mediaStream.getStream()&&(o.add(n.getObservableAudioState().subscribe(function(t){var e=i.mediaStream.getMonitor(),n=i.mediaStream.getStream().getAudioTracks();e&&1===n.length&&e.setMonitorTrackState(n[0],t===f.states.trackEnabled.name)},{initial:"notify"})),o.add(n.getObservableVideoState().subscribe(function(t){var e=i.mediaStream.getMonitor(),n=i.mediaStream.getStream().getVideoTracks();e&&1===n.length&&e.setMonitorTrackState(n[0],t===f.states.trackEnabled.name)},{initial:"notify"}))),t&&6===parseInt(t.category))return r(t,{status:"device-insecure"});var e=l.assign({originStreamId:s},i);r(t,e)})},i}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(s,i){"use strict";var o="most-recent";function t(t,e,n){t&&i.R(t,"selectionStrategy"),i.h(e,"logger"),this.yn=t||o,this.D=e,this.wn=s.get(n,["failureCountForBanningAMember"],100),this.bn=s.get(n,["banMemberOnCapacityFailureCount"],5),this.reset()}function u(t){return t?t.getSessionId()+t.getObservableScreenName().getValue():""}function a(t){return h(t.getObservableScreenName().getValue())}function c(t){return f(t.getObservableScreenName().getValue())}function h(t){return/primary/i.test(t)}function f(t){return/alternate/i.test(t)}return t.prototype.getNext=function(t){this.D.info("Select member from [%s]",t);var e=function(t){var n,i,e,r=this;switch(this.yn){case o:return e=s.reduce(t,function(t,e){var n=u(e);return s.get(r.kn,[n],!1)||t.push(e),t},[]),s.reduce(e,function(t,e){return t&&t.getLastUpdate()>e.getLastUpdate()?t:e});case"high-availability":return this.Sn&&s.includes(t,this.Sn)?this.Sn:(n=void 0,i=Number.MAX_VALUE,s.forEach(t,function(t){var e=u(t);s.get(r.kn,[e],!1)||((e=s.get(r.Rn,[t],0))<i?(i=e,n=t):e===i&&(n?a(t)?a(n)||(n=t):!c(t)||a(n)||c(n)||(n=t):n=t))}),n);default:throw new Error("Invalid Selection Strategy")}}.call(this,t);return e?this.D.info("Selecting new member [%s]/[%s]",e.getSessionId(),e.getObservableScreenName().getValue()):this.D.info("Unable to select new member from [%s]",t),this.Sn=e},t.prototype.getStrategy=function(){return this.yn},t.prototype.markFailed=function(t){if(this.Sn){var e=u(this.Sn);if(s.get(t,["failedDueToCapacity"],!1)){t=s.get(this.En,[e],0);if(s.set(this.En,[e],++t),t>=this.bn)return this.D.info("Disabling member [%s] that has exceeded threshold due to [%s] capacity failures",e,t),this.markDead()}t=s.get(this.Rn,[e],0);if(this.D.info("Failure count for member [%s] is now [%s]",e,++t),s.set(this.Rn,[e],t),t>=this.wn)return this.D.info("Disabling member [%s] that has exceeded threshold due to [%s] failures",e,t),this.markDead();this.Sn=null}else this.D.warn("Marking failed member but there was no recent selected member")},t.prototype.markDead=function(){var t;this.Sn?(t=u(this.Sn),this.D.info("Member [%s] is now permanently removed",t),s.set(this.kn,[t],!0),this.Sn=null):this.D.warn("Marking dead member but there was no recent selected member")},t.prototype.getNumberOfMembersWithFailures=function(){return s.keys(this.Rn).length},t.prototype.reset=function(){this.Sn=null,this.Rn={},this.En={},this.kn={}},t.prototype.dispose=function(){this.reset()},t.getSimilarMembers=function(e,n,t){var t=s.filter(t,function(t){return t.getObservableScreenName().getValue()!==e&&(!n||t.getSessionId()!==n)}),i=s.filter(t,a),r=s.filter(t,c);return h(e)?i||r||t:f(e)?r||i||t:t||i||r},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(t,e){"use strict";function n(t){e.h(t,"room"),this.In=t}return n.prototype.getChannelId=function(){return this.In.getRoomId.apply(this.In,arguments)},n.prototype.getObservableAlias=function(){return this.In.getObservableAlias.apply(this.In,arguments)},n.prototype.getObservableName=function(){return this.In.getObservableName.apply(this.In,arguments)},n.prototype.getObservableDescription=function(){return this.In.getObservableDescription.apply(this.In,arguments)},n.prototype.getObservableType=function(){return this.In.getObservableType.apply(this.In,arguments)},n.prototype.getObservableMembers=function(){return this.In.getObservableMembers.apply(this.In,arguments)},n.prototype.getObservableBridgeId=function(){return this.In.getObservableBridgeId.apply(this.In,arguments)},n.prototype.getObservablePin=function(){return this.In.getObservablePin.apply(this.In,arguments)},n.prototype.toString=function(){return this.In.toString.apply(this.In,arguments)},n.prototype.toJson=function(){return{channelId:this.In.getRoomId(),alias:this.In.getObservableAlias().getValue(),name:this.In.getObservableName().getValue(),description:this.In.getObservableDescription().getValue(),type:this.In.getObservableType().getValue(),pin:this.In.getObservablePin().getValue(),bridgeId:this.In.getObservableBridgeId().getValue()}},n.prototype.commitChanges=function(){return this.In.commitChanges.apply(this.In,arguments)},n.prototype.reload=function(){return this.In.reload.apply(this.In,arguments)},n.prototype.Y=function(){return this.In.Y.apply(this.In,arguments)},n.prototype.Ie=function(){return this.In.Ie.apply(this.In,arguments)},n.prototype.Ee=function(){return this.In.Ee.apply(this.In,arguments)},n.prototype.Te=function(){return this.In.Te.apply(this.In,arguments)},n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(9),n(23),n(3),n(33),n(93),n(97),n(38),n(39),n(40),n(101)],e=function(t,e,n,i,r,s,o,u,a,c){"use strict";return{express:{PCastExpress:u,RoomExpress:a,ChannelExpress:c},lowLevel:{PCast:n.global.PhenixPCast=e,RoomService:i},media:{AudioSpeakerDetector:r,UserMediaResolver:o},utils:{BandwidthMonitor:s,logging:t,rtc:n},AudioSpeakerDetector:r,BandwidthMonitor:s,logging:t,PCast:e,RoomService:i,RTC:n,UserMediaResolver:o}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(7),n(16)],e=function(u,e,t,a){"use strict";var c=t.__phenixPageLoadTime||t.__pageLoadTime||u.now(),n="2023-11-28T17:29:11Z",i="2023.0.12";function r(){this.Tn=[],this.Mn=null,this.Pe=null,this.Cn="production",this.qn=n}function s(t){(this.Pe=t)?this.info("Session started on websdk version [%s] ([%s]), user agent [%s]",n,i,navigator.userAgent):this.info("Websdk version [%s] ([%s]), user agent [%s]",n,i,navigator.userAgent)}function o(e,n){var i=(u.now()-c)/1e3,r=function(t){switch(t){case a.level.TRACE:return"Trace";case a.level.DEBUG:return"Debug";case a.level.INFO:return"Info";case a.level.WARN:return"Warn";case a.level.ERROR:return"Error";case a.level.FATAL:return"Fatal";default:throw new Error("Unsupported Logging Level "+t)}}(n.level),s=n.name||"websdk",o=this;u.forEach(this.Tn,function(t){try{t.log(i,r,s,h(Array.prototype.slice.call(e)),o.Pe,o.Mn,o.Cn,o.qn,n)}catch(t){}})}r.prototype.trace=function(){return o.call(this,arguments,{level:a.level.TRACE})},r.prototype.debug=function(){return o.call(this,arguments,{level:a.level.DEBUG})},r.prototype.info=function(){return o.call(this,arguments,{level:a.level.INFO})},r.prototype.warn=function(){return o.call(this,arguments,{level:a.level.WARN})},r.prototype.error=function(){return o.call(this,arguments,{level:a.level.ERROR})},r.prototype.fatal=function(){return o.call(this,arguments,{level:a.level.FATAL})},r.prototype.addAppender=function(t){e.h(t,"appender"),e.g(t.log,"appender.log"),this.Tn.push(t)},r.prototype.getAppenders=function(){return this.Tn},r.prototype.getUserId=function(){return this.Mn},r.prototype.setUserId=function(t){this.Mn=t},r.prototype.getEnvironment=function(){return this.Cn},r.prototype.setEnvironment=function(t){this.Cn=t},r.prototype.getApplicationVersion=function(){return this.qn},r.prototype.setApplicationVersion=function(t){this.qn=t},r.prototype.getObservableSessionId=function(){return this.nt},r.prototype.setObservableSessionId=function(t){this.nt=t,this.Bt&&this.Bt.dispose(),t&&(e.h(t,"observableSessionId"),this.Bt=this.nt.subscribe(u.bind(s,this),{initial:"notify"}))};var h=function(t){var e,n;if(0!==t.length)return e=[],n=[],u.forEach(t,function(t){e.push(u.toString(t)),t instanceof Error&&n.push(t.stack)}),f(e.concat(n))},f=function(t){for(var e=t[0],n=0;e.indexOf&&1<t.length&&0<=n;)if(0<(n=e.indexOf("%",n)))switch(e.substring(n+1,n+2)){case"%":e=e.substring(0,n)+e.substring(n+1),n++;break;case"s":case"d":t[0]=e=e.substring(0,n)+t[1]+e.substring(n+2),t.splice(1,1);break;default:return t}return t};return r}.apply(e,n);void 0!==e&&(t.exports=e)},function(n,i,t){!function(t){var e=function(){"use strict";return function(){return"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}}}.apply(i,[]);void 0!==e&&(n.exports=e)}.call(this,t(46))},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){n=[n(0),n(1),n(16)],e=function(t,e,c){"use strict";function n(){this.xn=c.level.TRACE}n.prototype.setThreshold=function(t){e.v(t,"level"),this.xn=t},n.prototype.getThreshold=function(){return this.xn},n.prototype.log=function(t,e,n,i,r,s,o,u,a){a.level<this.xn||(i[0]=t+" ["+n+"] "+e+" "+i[0],(a.level>c.level.INFO?f:h)(i))};var h=function(t){console.log.apply(console,t)},f=function(t){console.error.apply(console,t)};return n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(24)],e=function(r,n,i){"use strict";function t(t,e){n.isArray(t=null==t?[]:t,"valuesToSet"),this.observableArray=new i(t,e)}return t.prototype.getValue=function(){return this.observableArray.getValue()},t.prototype.setValue=function(t){return void 0!==(t=null==t?[]:t)&&n.isArray(t,"values"),this.observableArray.setValue(t)},t.prototype.subscribe=function(t,e){return this.observableArray.subscribe(t,e)},t.prototype.push=function(t){var e=this.observableArray.getValue();e.push(t),this.observableArray.setValue(e)},t.prototype.pop=function(){var t=this.observableArray.getValue(),e=t.pop();return this.observableArray.setValue(t),e},t.prototype.remove=function(e){function t(t){return r.g(e)?e(t):t===e}var n=this.observableArray.getValue(),i=r.filter(n,t);return 0<i.length&&this.observableArray.setValue(r.remove(n,t)),i},t.prototype.removeAll=function(){var t=this.observableArray.getValue();return this.observableArray.setValue([]),t},t.prototype.extend=function(t){return this.observableArray.extend(t),this},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(n,e){"use strict";function t(t){e.h(t,"observable"),this.Pn=t,this.On=null,this.An=!1}return t.prototype.start=function(t,e){this.An=!0,this.On=this.Pn.subscribe(n.noop,{listenForChanges:{callback:t,timeout:e||500}})},t.prototype.stop=function(){this.An=!1,this.On&&this.On.dispose(),this.On=null},t.prototype.isEnabled=function(){return this.An},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(12),n(51)],e=function(t,e,n,i){function r(){this.Un={}}return r.prototype.getAppender=function(t){var e=n.getEnvironmentFromUrl(t||""),t=n.getTelemetryServerUri(t);return this.Un[e]||(this.Un[e]=function(t){var e=new i(t);return t||e.setEnabled(!1),e}.call(this,t)),this.Un[e]},new r}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(9),n(18),n(3),n(28)],e=function(c,h,e,n,i,r){function t(t){h.u(t,"uri"),this.Dn="object"==typeof location?location.hostname:i.browser+"-"+i.browserVersion+"-unknown",this.xn=e.level.TRACE,this.An=!0,this.Fn=(i.browser||"Browser")+"/"+(i.browserVersion||"?"),this.Nn=0,this.jn=new n.BatchHttpProto(t+"/logs",[r],"telemetry.StoreLogRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this.jn.on("capacity",c.bind(s,this))}function s(t){this.jn.addRecordToBeginning({level:"Warn",timestamp:c.isoString(),category:"websdk/telemetryLogger",message:"Deleted "+t+" records",source:this.Fn,fullQualifiedName:this.Dn,sessionId:this.Ln,userId:this.Bn,environment:this._n,version:this.Wn,runtime:this.Nn})}return t.prototype.setThreshold=function(t){h.v(t,"level"),this.xn=t},t.prototype.getThreshold=function(){return this.xn},t.prototype.isEnabled=function(){return this.An},t.prototype.setEnabled=function(t){h.k(t,"enabled"),this.An=t},t.prototype.log=function(t,e,n,i,r,s,o,u,a){a.level<this.xn||!this.An||(h.isArray(i,"messages"),this.Nn=t,this.Ln=r,this.Bn=s,this.Wn=u,this._n=o,function(t,e,n){this.jn.addRecord({level:t,timestamp:c.isoString(),category:e,message:n.join(" "),source:this.Fn,fullQualifiedName:this.Dn,sessionId:this.Ln,userId:this.Bn,environment:this._n,version:this.Wn,runtime:this.Nn})}.call(this,e,n,i))},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(53),n(26)],e=function(r,s,o,u,a){"use strict";function t(t,e,n,i){s.R(t,"uri"),s.h(e,"logger"),s.isArray(n,"protocols"),this.J=t,this.D=e,this.D.info("Connecting to [%s]",t),this.te=new u(this.J,this.D),this.Vn=new a(this.D,r.bind(m,this),r.bind(p,this),n,i),this.zt=new o.NamedEvents,this.te.onconnected=r.bind(h,this),this.te.onreconnecting=r.bind(c,this),this.te.onreconnected=r.bind(f,this),this.te.ondisconnected=r.bind(l,this),this.te.onerror=r.bind(d,this),this.zn=!1}function e(t,e){this.zt.fire(t,e,this)}function c(t){e.call(this,"reconnecting")}function h(t){e.call(this,"connected")}function f(t){e.call(this,"reconnected")}function l(t){e.call(this,"disconnected",[t.code,t.reason]),this.zn&&(this.zt.dispose(),this.Vn.dispose())}function d(t){e.call(this,"error",[t.data])}function p(t){this.te.onmessage=t}function m(t){this.te&&this.te.send(t)}return t.prototype.onEvent=function(t,e){return this.zt.listen(t,e),this.Vn.onEvent(t,e)},t.prototype.onRequest=function(t,e){return this.Vn.onRequest(t,e)},t.prototype.sendRequest=function(t,e,n,i){return this.Vn.sendRequest(t,e,n,i)},t.prototype.sendResponse=function(t,e,n,i){return this.Vn.sendResponse(t,e,n,i)},t.prototype.disconnect=function(){return this.zn=!0,this.te.disconnect()},t.prototype.disposeOfPendingRequests=function(){return this.D.info("Disposing of pending MQ WebSocket requests"),this.Vn.disposeOfRequests()},t.prototype.getApiVersion=function(){return this.Vn.getApiVersion()},t.prototype.toString=function(){return"MQWebSocket["+this.te.toString()+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(54)],e=function(t){"use strict";return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(25)],e=function(s,o,u){"use strict";var a={byebye:{code:1e3,reason:"byebye",desc:"Client closed"},backoffLimitReached:{code:4e3,reason:"backoff-limit-reached",desc:"Reached the limit in terms of the number of reconnects"},networkDisconnect:{code:4001,reason:"network-disconnect",desc:"Network connection monitor determined loss to internet connectivity"},reconnecting:{code:4002,reason:"reconnecting",desc:"Closing WebSocket in order to attempt to establish another connection"}},c={code:1,state:"OPEN",desc:"The connection is open and ready to communicate"},e={code:3,state:"CLOSED",desc:"The connection is closed or could not be opened"};function t(t,e,n,i){o.R(t,"uri"),o.h(e,"logger"),s.isNullOrUndefined(n)?n=4:o.v(n,"maxReconnectAttempts"),this.J=t,this.D=e,this.Hn=n,this.Gn=i||1e3,this.Jn=!1,this.Et=!1,this.Kn=[],this.Qn="connecting",this.D.info("Connecting WebSocket to [%s]",t),this.te=h.call(this,d,f);var r=this;this.Xn=null,this.Zn=u.listenForNetworkChange(function(t){if(t)return s.v(r.Xn)&&(clearTimeout(r.Xn),r.Xn=null),function(){var t=this;setTimeout(function(){return t.Et?t.D.info("Unable to go back online after network reconnect. Client has stopped WebSocket."):t.te.readyState!==c.code?(t.D.info("Network Reconnected. Attempting to reconnect WebSocket."),t.reconnect()):t.$n?(t.D.info("Network Reconnected with WebSocket status of [%s].",c.state),d.call(t)):("online"===t.Qn&&"reconnected"===this.Qn||p.call(t),void t.D.info("Network Reconnected."))},1e3)}.call(r);s.v(r.Xn)||(l.call(r),r.Xn=setTimeout(function(){return function(){this.D.warn("Network not reconnected after [%s]. Going Offline and disconnecting WebSocket connection.",15e3),this.$n=!0,m.call(this,a.networkDisconnect)}.call(r)},15e3))},0)}function i(t){return this.te.readyState===e.code?f.call(this,t):this.te.close(t.code,t.reason)}function h(t,e){var n=new WebSocket(this.J);return n.onopen=s.bind(t,this),n.onclose=s.bind(e,this),n.onmessage=s.bind(g,this),n.onerror=s.bind(v,this),n}function r(t){this.te.readyState!==c.code&&this.reconnect(t+1)}function f(t){switch(t.code){case a.reconnecting.code:return;case a.byebye.code:case a.backoffLimitReached.code:case a.networkDisconnect.code:return m.call(this,t);default:return this.Jn?void 0:(l.call(this,t),this.D.info("Attempting to re-establish socket connection after disconnect event with code [%s] and reason [%s]",t.code,t.reason),this.reconnect())}}function l(t){this.D.info("WebSocket is reconnecting"),this.Qn="reconnecting",this.onreconnecting&&this.onreconnecting(t)}function d(t){this.D.info("WebSocket Connected"),function(){var t=this.Kn.length;if(0!==t)for(this.D.info("Sending [%s] queued messages",t);0<t;){t--;var e=this.Kn.shift();this.send(e)}}.call(this),this.Qn="connected",this.onconnected&&this.onconnected(t)}function p(t){this.D.info("Successfully reconnected to WebSocket"),this.Qn="reconnected",this.onreconnected&&this.onreconnected(t)}function m(t){this.D.info("WebSocket Disconnected [%s]: [%s]",t.code,t.reason),this.Qn="disconnected",this.ondisconnected&&this.ondisconnected(t)}function v(t){this.D.error("An error occurred on the WebSocket connection [%s]",t.data||t),this.onerror&&this.onerror(t)}function g(t){this.D.debug(">> [%s]",t.data),this.onmessage&&this.onmessage(t)}return t.prototype.onmessage=null,t.prototype.onconnected=null,t.prototype.onreconnecting=null,t.prototype.onreconnected=null,t.prototype.ondisconnected=null,t.prototype.onerror=null,t.prototype.send=function(t){return u.isOnline(),this.te.send(t)},t.prototype.reconnect=function(t){this.te.onclose=null,this.te.onerror=null,this.Jn=!0;var e,n=this;if(s.v(t)||(t=1),this.Et)return this.D.info("Client has stopped WebSocket after [%s] reconnect attempts",t-1);if(t>this.Hn)return this.D.warn("Unable to reconnect WebSocket after [%s] attempts",this.Hn),i.call(this,a.backoffLimitReached);i.call(this,a.reconnecting);try{this.te=h.call(n,function(){return e&&clearTimeout(e),n.Jn=!1,n.te.onclose=s.bind(f,n),p.call(n)},function(){t+1>n.Hn&&(e&&clearTimeout(e),r.call(n,t))})}catch(t){this.D.warn("Unable to create WebSocket connection [%s]",t)}e=function(t){var e=this;return setTimeout(function(){r.call(e,t)},t*t*this.Gn)}.call(this,t)},t.prototype.disconnect=function(){return this.Zn.dispose(),this.Et=!0,s.v(this.Xn)&&(clearTimeout(this.Xn),this.Xn=null),this.te.close(a.byebye.code,a.byebye.reason)},t.prototype.toString=function(){return"ReconnectedWebSocket["+this.J+","+this.te.readyState+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(7),n(5),n(4),n(2)],e=function(r,e,n,i,s){"use strict";function t(){var t="undefined"==typeof navigator||navigator.onLine;this.Yn=new i.Observable(t).extend({timeout:0}),this.zt=new n.NamedEvents,r.addEventListener(e,"online",r.bind(this.zt.fire,this.zt,"online",[])),r.addEventListener(e,"offline",r.bind(this.zt.fire,this.zt,"offline",[])),r.addEventListener(e,"unload",r.bind(this.zt.dispose,this.zt)),this.zt.listen("online",r.bind(this.Yn.setValue,this.Yn,!0)),this.zt.listen("offline",r.bind(this.Yn.setValue,this.Yn,!1))}function o(t,e){var n=this;if(this.Yn.setValue(!1),!r.v(e))return t(!1);n.offlineTimeout=setTimeout(function(){t&&!n.Yn.getValue()&&t(!1)},e)}function u(t){this.Yn.setValue(!0),t&&t(!0)}return t.prototype.listenForNetworkChange=function(t,e){var n=new s.DisposableList,i=r.bind(u,this,t),t=r.bind(o,this,t,e);return n.add(this.zt.listen("online",i)),n.add(this.zt.listen("offline",t)),n},t.prototype.isOnline=function(){return this.Yn.getValue()},new t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){"use strict";t.exports=r;var i=n(57);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=4294967296,o=1/s;function u(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function a(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function c(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;t<=r;r--)n.buf[r+i]=n.buf[r]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function k(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=7&i,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=k(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=w(this.buf,this.pos)+w(this.buf,this.pos+4)*s;return this.pos+=8,t},readSFixed64:function(){var t=w(this.buf,this.pos)+k(this.buf,this.pos+4)*s;return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n=e[this.pos++],i=127&n;if(n<128)return i;if(i|=(127&(n=e[this.pos++]))<<7,n<128)return i;if(i|=(127&(n=e[this.pos++]))<<14,n<128)return i;if(i|=(127&(n=e[this.pos++]))<<21,n<128)return i;var n=i|=(15&e[this.pos])<<28,e=t,i=this.buf,t=i[this.pos++],r=(112&t)>>4;if(t<128)return a(n,r,e);if(r|=(127&(t=i[this.pos++]))<<3,t<128)return a(n,r,e);if(r|=(127&(t=i[this.pos++]))<<10,t<128)return a(n,r,e);if(r|=(127&(t=i[this.pos++]))<<17,t<128)return a(n,r,e);if(r|=(127&(t=i[this.pos++]))<<24,t<128)return a(n,r,e);if(r|=(1&(t=i[this.pos++]))<<31,t<128)return a(n,r,e);throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){for(var i,r,s,o="",u=e;u<n;){var a=t[u],c=null,h=239<a?4:223<a?3:191<a?2:1;if(n<u+h)break;1===h?a<128&&(c=a):2===h?128==(192&(i=t[u+1]))&&(c=(31&a)<<6|63&i)<=127&&(c=null):3===h?(i=t[u+1],r=t[u+2],128==(192&i)&&128==(192&r)&&((c=(15&a)<<12|(63&i)<<6|63&r)<=2047||55296<=c&&c<=57343)&&(c=null)):4===h&&(i=t[u+1],r=t[u+2],s=t[u+3],128==(192&i))&&128==(192&r)&&128==(192&s)&&((c=(15&a)<<18|(63&i)<<12|(63&r)<<6|63&s)<=65535||1114112<=c)&&(c=null),null===c?(c=65533,h=1):65535<c&&(c-=65536,o+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),o+=String.fromCharCode(c),u+=h}return o}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=u(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){t&=7;if(t===r.Varint)for(;127<this.buf[this.pos++];);else if(t===r.Bytes)this.pos=this.readVarint()+this.pos;else if(t===r.Fixed32)this.pos+=4;else{if(t!==r.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e,n=this.length||16;n<this.pos+t;)n*=2;n!==this.length&&((e=new Uint8Array(n)).set(this.buf),this.buf=e,this.length=n)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeVarint:function(t){if(268435455<(t=+t||0)||t<0){if(0<=t?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:i=i+1|(n=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");this.realloc(10);var e=this,e=(e.buf[e.pos++]=127&n|128,n>>>=7,e.buf[e.pos++]=127&n|128,n>>>=7,e.buf[e.pos++]=127&n|128,n>>>=7,e.buf[e.pos++]=127&n|128,e.buf[e.pos]=127&(n>>>=7),i),n=this,i=(7&e)<<4;n.buf[n.pos++]|=i|((e>>>=3)?128:0),e&&(n.buf[n.pos++]=127&e|((e>>>=7)?128:0),e)&&(n.buf[n.pos++]=127&e|((e>>>=7)?128:0),e)&&(n.buf[n.pos++]=127&e|((e>>>=7)?128:0),e)&&(n.buf[n.pos++]=127&e|((e>>>=7)?128:0),e)&&(n.buf[n.pos++]=127&e)}else this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127)||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127)||(this.buf[this.pos++]=t>>>7&127)},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos,t=(this.pos=function(t,e,n){for(var i,r,s=0;s<e.length;s++){if(55295<(i=e.charCodeAt(s))&&i<57344){if(!r){56319<i||s+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos),this.pos-e);128<=t&&c(e,t,this),this.pos=e-1,this.writeVarint(t),this.pos+=t},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos,t=(t(e,this),this.pos-n);128<=t&&c(n,t,this),this.pos=n-1,this.writeVarint(t),this.pos+=t},writeMessage:function(t,e,n){this.writeTag(t,r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){this.writeMessage(t,f,e)},writePackedBoolean:function(t,e){this.writeMessage(t,p,e)},writePackedFloat:function(t,e){this.writeMessage(t,l,e)},writePackedDouble:function(t,e){this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,v,e)},writePackedFixed64:function(t,e){this.writeMessage(t,g,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,y,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e){e.read=function(t,e,n,i,r){var s,o,u=8*r-i-1,a=(1<<u)-1,c=a>>1,h=-7,f=n?r-1:0,l=n?-1:1,r=t[e+f];for(f+=l,s=r&(1<<-h)-1,r>>=-h,h+=u;0<h;s=256*s+t[e+f],f+=l,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;0<h;o=256*o+t[e+f],f+=l,h-=8);if(0===s)s=1-c;else{if(s===a)return o?NaN:1/0*(r?-1:1);o+=Math.pow(2,i),s-=c}return(r?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,u,a=8*s-r-1,c=(1<<a)-1,h=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,l=i?0:s-1,d=i?1:-1,s=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(i=Math.pow(2,-o))<1&&(o--,i*=2),2<=(e+=1<=o+h?f/i:f*Math.pow(2,1-h))*i&&(o++,i/=2),c<=o+h?(u=0,o=c):1<=o+h?(u=(e*i-1)*Math.pow(2,r),o+=h):(u=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));8<=r;t[n+l]=255&u,l+=d,u/=256,r-=8);for(o=o<<r|u,a+=r;0<a;t[n+l]=255&o,l+=d,o/=256,a-=8);t[n+l-d]|=128*s}},function(t,e,n){n=[n(0)],e=function(h){"use strict";function t(t){this.ti=t,this.ei={},this.ni={},s.call(this,this.ti,this.ei),i.call(this,this.ti,this.ei)}function o(r,s,t,e){var o=this,n=(n=r.messages[s],h.reduce(n.fields,function(t,e){return t[e.name]=h.clone(e.defaultValue),t},{}));return t.readFields(function(t,e,n){var i;r.messages[s].fieldIds[t]&&("repeated"===(i=r.messages[s].fields[t]).rule?e[i.name].push(u.call(o,r.messages[s],s,t,n)):e[i.name]=u.call(o,r.messages[s],s,t,n))},n,e)}function f(e,n,i,r){var s=this,t=e.messages[n];h.forEach(h.keys(t.fields),function(t){return l.call(s,e,n,parseInt(t),i,r)})}function l(n,i,r,s,o,t){var u=this,e=n.messages[i].fields[r],a=s[e.name];if(h.isUndefined(t)||(a=a[t]),e.defaultValue!==a&&!h.isUndefined(a)){if(h.isArray(a)){if("repeated"!==e.rule)throw new Error("Invalid type. Array is not valid with rule ["+e.rule+"]");return h.forEach(a,function(t,e){l.call(u,n,i,r,s,o,e)})}if(h.h(e.schema)&&h.h(a))return o.writeMessage(r,h.bind(f,this,e.schema.parent,e.type),a);var c=h.isUndefined(a)?e.defaultValue:a;if(h.h(e.schema)&&!e.schema.fields)return t=h.v(a)?a:h.get(e.schema,[c,"id"]),o.writeVarintField(r,t);switch(e.type){case"string":return o.writeStringField(r,c);case"float":return o.writeFloatField(r,c);case"double":return o.writeDoubleField(r,c);case"bool":return o.writeBooleanField(r,c);case"enum":case"uint32":case"uint64":case"int32":case"int64":return o.writeVarintField(r,c);case"sint32":case"sint64":return o.writeSVarintField(r,c);case"fixed32":return o.writeFixed32Field(r,c);case"fixed64":return o.writeFixed64Field(r,c);case"sfixed32":return o.writeSFixed32Field(r,c);case"sfixed64":return o.writeSFixed64Field(r,c);case"bytes":return o.writeBytesField(r,c);default:throw new Error("Unexpected type: "+e.type)}}}function s(t,e){0<h.get(t,["messages","length"],0)&&!function(t,i){var r=this;i.messages=h.reduce(t,function(t,e){var n;if(!i[e.name])return n=h.reduce(e.fields,function(t,e){return t[e.id]=!0,t},{}),t[e.name]={parent:i,type:e.name,fieldIds:n},s.call(r,e,t[e.name]),t},{})}.call(this,t.messages,e),0<h.get(t,["enums","length"],0)&&function(t,e){e.enums=h.reduce(t,function(t,e){return t[e.name]=h.reduce(e.values,function(t,e){return t[e.name]=e,t},{}),t},{})}.call(this,t.enums,e)}function i(t,e){var n=this;h.forEach(t.messages,function(t){e.messages[t.name].fields=h.reduce(t.fields,h.bind(r,this,e.messages[t.name]),{}),t.messages&&i.call(n,t,e.messages[t.name])})}function r(t,e,n){return e[n.id]={rule:n.rule,type:n.type,name:n.name,schema:function t(e,n){return h.get(n,["messages",e])?n.messages[e]:h.get(n,["enums",e])?n.enums[e]:n.parent?t(e,n.parent):e}.call(this,n.type,t),defaultValue:(t=n.rule,n.type,n=h.get(n,["options","default"]),"repeated"===t?[]:h.isUndefined(n)?null:n)},e}function u(t,e,n,i){var r="int32"===e||"int64"===e?"true":"",s=t.fields[n];if(h.h(s.schema)){if(s.schema.fields)return o.call(this,s.schema.parent,s.type,i,i.readVarint()+i.pos);e=i.readVarint(r),n=h.getEnumName(s.schema,e);if(h.isNullOrUndefined(n))throw new Error("Unsupported enum id ["+e+"] for field ["+s.name+"] on message ["+t.type+"]");return n}switch(s.type){case"string":return i.readString(r);case"float":return i.readFloat(r);case"double":return i.readDouble(r);case"bool":return i.readBoolean(r);case"enum":return i.readVarint(r);case"uint32":case"uint64":case"int32":case"int64":return i.readVarint(r);case"sint32":case"sint64":return i.readSVarint(r);case"fixed32":return i.readFixed32(r);case"fixed64":return i.readFixed64(r);case"sfixed32":return i.readSFixed32(r);case"sfixed64":return i.readSFixed64(r);case"bytes":return i.readBytes(r);default:throw new Error("Unexpected type: "+s.type)}}return t.prototype.read=function(t,e,n){if(this.ei.messages[t])return o.call(this,this.ei,t,e,n);throw new Error("Unsupported proto type ["+t+"]")},t.prototype.write=function(t,e,n){if(this.ei.messages[t])return f.call(this,this.ei,t,e,n);throw new Error("Unsupported proto type ["+t+"]")},t.prototype.getDefaults=function(){},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{package:"mq",messages:[{name:"Message",fields:[{rule:"optional",type:"MessageType",name:"messageType",id:7,options:{default:"Request"}},{rule:"optional",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"requestId",id:2},{rule:"required",type:"string",name:"type",id:3},{rule:"optional",type:"string",name:"encoding",id:4},{rule:"required",type:"bytes",name:"payload",id:5},{rule:"repeated",type:"double",name:"wallTime",id:6}],enums:[{name:"MessageType",values:[{name:"Request",id:0},{name:"Response",id:1},{name:"Event",id:2}]}]},{name:"Error",fields:[{rule:"required",type:"string",name:"reason",id:1}]},{name:"PingPong",fields:[{rule:"required",type:"uint64",name:"originTimestamp",id:1},{rule:"optional",type:"uint64",name:"count",id:2}]}]}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(7),n(61)],e=function(r,s,o,u){"use strict";function a(){this.ii=[],this.ri=""}return a.prototype.push=function(){1024<this.ii.length+arguments.length&&(this.ri+=String.fromCharCode.apply(String,this.ii),this.ii.length=0),Array.prototype.push.apply(this.ii,arguments)},a.prototype.build=function(){return this.ri+String.fromCharCode.apply(String,this.ii)},{toString:function(t){var e=0,n=t.length,i=new a;return u.encode(function(){return e<n?t[e++]:null},r.bind(i.push,i)),i.build()},toByteArray:function(t){s.u(t,"data");var e,n,i=[];return u.decode((e=t,n=0,function(){return n<e.length?e.charCodeAt(n++):null}),function(t){i.push(t)}),new o.Uint8Array(i)}}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){t.exports=n(62)},function(t,e,n){for(var i={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],o=[],s=0,u=r.length;s<u;++s)o[r[s]]=s;i.encode=function(t,e){for(var n,i;null!==(n=t());)e(r[n>>2&63]),i=(3&n)<<4,null!==(n=t())?(e(r[63&((i|=n>>4&15)|n>>4&15)]),i=(15&n)<<2,null!==(n=t())?(e(r[63&(i|n>>6&3)]),e(r[63&n])):(e(r[63&i]),e(61))):(e(r[63&i]),e(61),e(61))},i.decode=function(t,e){var n,i,r;function s(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(i=o[n])&&s(n),null!==(n=t())&&(void 0===(r=o[n])&&s(n),e(i<<2>>>0|(48&r)>>4),null!==(n=t()))){if(void 0===(i=o[n])){if(61===n)break;s(n)}if(e((15&r)<<4>>>0|(60&i)>>2),null!==(n=t())){if(void 0===(r=o[n])){if(61===n)break;s(n)}e((3&i)<<6>>>0|r)}}},i.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t.exports?t.exports=i:void 0!==(n=function(){return i}.call(e,n,e,t))&&(t.exports=n)},function(t,e,n){n=[n(0),n(1),n(64),n(27),n(67)],e=function(s,o,u,a,i){"use strict";function c(t,e,n){return i.toString(t.encode(e,n))}function h(t,e,n){return t.decode(e+"Response",i.toByteArray(n))}return function(t,e,n,i,r){o.R(t,"uri"),o.isArray(e,"protocols"),o.R(n,"type"),o.h(i,"options");i=s.assign({},i||{},{contentType:"application/protobuf"}),e=new a(e,r);return new u(t,i,s.bind(c,this,e,n),s.bind(h,this,e,n))}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(65)],e=function(t){"use strict";return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(7),n(25),n(8),n(4),n(2)],e=function(s,o,u,a,c,r,h,f){var n=0,l={capacity:"capacity",error:"error",response:"response"},d=null;function t(t,e,n,i){o.R(t,"uri"),o.h(e=e||{},"options"),e.requestType&&o.R(e.requestType,"options.requestType"),e.maxAttempts&&o.v(e.maxAttempts,"options.maxAttempts"),e.maxBufferedRecords&&o.v(e.maxBufferedRecords,"options.maxBufferedRecords"),e.maxBatchSize&&o.v(e.maxBatchSize,"options.maxBatchSize"),e.contentType&&o.R(e.contentType,"options.maxBatchSize"),n&&o.g(n,"serializeRequest"),i&&o.g(i,"deserializeResponse"),this.si="__phenixBatchHttpMessages|"+t,this.oi=e.requestType||"POST",this.ui=e.requestTimeout||3e4,this.ai=e.maxAttempts||5,this.ci=e.maxBufferedRecords||1e3,this.hi=e.maxBatchSize||100,this.fi=e.contentType||"application/json",this.li=n,this.di=i,this.J=t,this.pi=v.call(this)||[],this.An=!0,this.zt=new u.NamedEvents,this.mi=new h.Observable(!0),this.H=new f.DisposableList,this.vi=!1,this.gi=!1,this.yi=null===d?d=w.call(this):d,this.H.add(this.mi.subscribe(s.bind(p,this))),this.H.add(function(){var t=this;return c.listenForNetworkChange(function(){m.call(t,t.vi)})}.call(this)),this.H.add(this.zt),y.call(this,[]),p.call(this);var r=this;s.addEventListener(a,"beforeunload",function(){g.call(r,r.pi),r.gi=!0,r.pi=[]})}function e(){var t;this.pi.length>this.ci&&(t=this.pi.length-this.ci/2,this.pi=this.pi.slice(t),this.zt.fireAsync(l.capacity,[null,{numberOfDeletedRecords:t}]))}function p(){if(this.mi.getValue()&&0!==this.pi.length){m.call(this,!0);var t={records:s.take(this.pi,this.hi)},e=(this.pi=this.pi.slice(this.hi),this);try{!function(t,e,n){var i=this,e=this.li?this.li(s.assign({},e)):e;if("POST"!==this.oi)throw new Error("Invalid request type");return r.postWithRetry(t,e,{timeout:this.ui,contentType:this.fi,retryOptions:{maxAttempts:this.ai,additionalRetryErrorCodes:[0]}},function(t,e){if(t)return"timeout"!==t.message||function(){return this.pi.length>=this.ci}.call(i)?(m.call(i,!1),i.zt.fire(l.error,[t])):n();m.call(i,!1);t=i.di?i.di(e.data):e.data;return i.zt.fire(l.response,[t])})}.call(this,this.J,t,function(){setTimeout(function(){e.pi=e.pi.concat(t.records),m.call(e,!1)},n)})}catch(t){setTimeout(function(){return m.call(e,!1),e.zt.fire(l.error,[t])},n)}}}function m(t){this.vi=t,this.mi.setValue(!t&&c.isOnline())}t.prototype.on=function(t,e){return o.R(t,"eventName"),o.g(e,"callback"),this.zt.listen(t,e)},t.prototype.addRecord=function(t){this.gi?g.call(this,[t]):(this.pi.push(t),p.call(this),e.call(this))},t.prototype.addRecordToBeginning=function(t){this.pi.unshift(t),p.call(this),e.call(this)},t.prototype.dispose=function(){this.pi=[],this.H.dispose()};var v=function(){if(this.yi)try{var t=a.localStorage.getItem(this.si);if(t)return JSON.parse(t)}catch(t){console.log("Failed to read local storage ["+t.message+"]")}return[]},g=function(t){this.yi&&t&&0!==t.length&&(t=v.call(this).concat(t),y.call(this,t))},y=function(t){if(this.yi&&t)try{var e=JSON.stringify(t);a.localStorage.setItem(this.si,e)}catch(t){console.log("Failed to store data in local storage ["+t.message+"]")}},w=function(){try{var t,e;return a.localStorage?(t="__is_local_storage_supported__",a.localStorage.setItem(t,t),e=a.localStorage.getItem(t),a.localStorage.removeItem(t),e!==t&&console.log("Local storage is passively blocked"),e===t):(console.log("Local storage not available"),!1)}catch(t){return console.log("Local storage is blocked"),!1}};return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2)],e=function(l,r,d){"use strict";var p={id:4e3,name:"Aborted by Client"};function t(){}function s(t,e,n,i,r){u(i=i||{});t=c(t,a(i.queryParameters||{},e)),e=l.bind(v,this,l.now(),r);if(!t)return r(h());i.responseType&&(t.responseType=i.responseType),f(t,i),t.addEventListener("readystatechange",l.bind(m,this,t,i,e)),t.timeout=i.timeout||15e3,t.send(n)}function o(t,e,n,i,r){t=l.bind(t,this,e,n,i),n={startTime:l.now(),isDisposed:!1};return g.call(this,e,i,t,n,r)}function u(t){r.h(t,"settings"),t.queryParameters&&r.h(t.queryParameters,"settings.queryParameters"),t.mimeType&&r.S(t.mimeType,"settings.mimeType"),t.accept&&r.S(t.accept,"settings.accept"),t.contentType&&r.S(t.contentType,"settings.contentType"),t.responseType&&r.S(t.responseType,"settings.responseType"),l.isNullOrUndefined(t.timeout)||r.v(t.timeout,"settings.timeout")}function a(t,e){var n=e.lastIndexOf("#"),i=e.indexOf("?"),t=l.reduce(t,function(t,e,n){return(t+=t?"&":"")+n.toString()+"="+e.toString()},""),r=-1===n?"":e.substring(n+1),i=-1===i?"":e.substring(i+1,r?n:e.length),n=t+(i?"&"+i:"");return e=e.replace("?"+i,"").replace("#"+r,""),n&&(e+="?"+n),r&&(e+="#"+r),e}function c(t,e){var n=new XMLHttpRequest;if("withCredentials"in n)n.open(t,e,!0);else{if("undefined"==typeof XDomainRequest)return;(n=new XDomainRequest).open(t,e)}return n}function h(){var t=new Error("unsupported");return t.code="unsupported",t}function f(n,t){var e=t.contentType||"application/json",i=t.accept||e,e=l.assign({},{"Content-Type":e,Accept:i},l.get(t,["headers"],{}));l.forOwn(e,function(t,e){n.setRequestHeader(e,t)})}function m(t,e,n){var i;4===t.readyState&&(200===t.status?(i=t.getAllResponseHeaders(),i=l.reduce(i.trim().split(/[\r\n]+/),function(t,e){var e=e.split(": "),n=e.shift(),e=e.join(": ");return n&&(t[n]=e),t},{}),n(null,{data:t.response||t.responseText,headers:i,rawXhr:t})):(i=new Error(0===t.status?"timeout":"Status=["+t.status+"]"),e=l.get(e,["retryOptions","additionalRetryErrorCodes"],[]),l.forEach(e,function(t){r.v(t,"additionalRetryErrorCode")}),i.code=t.status,(500<=t.status&&t.status<600||l.includes(e,t.status))&&(i.retryable=!0),n(i)))}function v(t,e,n,i){i&&l.set(i,["stats","successResponseTime"],l.now()-t),e(n,i)}function g(n,i,r,s,o,u){function t(t,e){return s.isDisposed?o(y(p)):t&&t.retryable&&u<f?g.call(a,n,i,r,s,o,u+1):function(t,e,n,i,r){r&&(l.set(r,["stats","totalResponseTimeForAllAttempts"],l.now()-t),l.set(r,["stats","attempts"],e)),n(i,r)}.call(a,s.startTime,u,o,t,e)}u=u||1;var a=this,e=l.get(i,["delay"],null),c=l.get(i,["retryOptions","delay"],1500),h=l.get(i,["retryOptions","backoff"],2),f=l.get(i,["retryOptions","maxAttempts"],1),c=1<u?c*Math.pow(u,h):e,h=new d.Disposable(function(){l.v(s.mostRecentTimeout)&&clearTimeout(s.mostRecentTimeout),s.isDisposed=!0});return!l.v(e)&&1===u||l.get(i,["retryOptions","sync"],!1)?r.call(a,t):function(t,e,n,i,r,s){var o=this;i.mostRecentTimeout=setTimeout(function(){if(i.isDisposed)return s(y(p));n.call(o,s)},r)}.call(a,n,i,r,s,c,t),h}function y(t){var e=new Error(t.name);return e.code=t.id,e}return t.prototype.get=function(t,e,n){u(e=e||{});var t=c("GET",a(e.queryParameters||{},t)),i=l.bind(v,this,l.now(),n);if(!t)return n(h());e.mimeType&&t.overrideMimeType(e.mimeType),e.responseType&&(t.responseType=e.responseType),f(t,e),t.addEventListener("readystatechange",l.bind(m,this,t,e,i)),t.timeout=e.timeout||5e3,t.send()},t.prototype.post=function(t,e,n,i){return s.call(this,"POST",t,e,n,i)},t.prototype.put=function(t,e,n,i){return s.call(this,"PUT",t,e,n,i)},t.prototype.delete=function(t,e,n,i){return s.call(this,"DELETE",t,e,n,i)},t.prototype.getWithRetry=function(t,e,n){var i=l.bind(this.get,this,t,e),r={startTime:l.now(),isDisposed:!1};return g.call(this,t,e,i,r,n)},t.prototype.postWithRetry=function(t,e,n,i){return o.call(this,this.post,t,e,n,i)},t.prototype.putWithRetry=function(t,e,n,i){return o.call(this,this.put,t,e,n,i)},t.prototype.deleteWithRetry=function(t,e,n,i){return o.call(this,this.delete,t,e,n,i)},new t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(1),n(7)],e=function(r,s){"use strict";return{toString:function(t){var e=0,n=t.length,i=[],r=[];if(e===n)return"";for(;e<n;)i.push(t[e++]),1024<=i.length&&(r.push(String.fromCharCode.apply(String,i)),i=[]);return r.join("")+String.fromCharCode.apply(String,i)},toByteArray:function(t){r.u(t,"data");for(var e,n=0,i=new s.Uint8Array(t.length);n<t.length;){if(255<(e=t.charCodeAt(n)))throw RangeError("illegal char code: "+e);i[n++]=e}return i}}}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(2),n(69),n(10)],e=function(s,h,o,t){"use strict";function a(){console.error.apply(console,arguments)}var u=window,c=function(){console.log.apply(console,arguments)};function e(t,e,n){function i(t){r.wi=!0,r.bi=!0===t,t?l.call(r):a("Failed to create Phenix video element"),r.ki&&r.ki(r.bi)}var r=this;this.Si=t,this.Ri=e,this.Ne=n||{},this.A={},this.H=new h.DisposableList,this.Ei=null;try{this.Ii=function(){this.Ei=new o(this.Si,this.Ri,this.Ne);var t=this;return this.H.add(new h.Disposable(function(){t.Ei.destroy()})),this.Ei.getElement()}.call(this),this.Ii.className=this.Si.className,this.Ii.height=this.Si.height,this.Ii.width=this.Si.width,this.Ti=this.Si.style.cssText,this.Si.style.cssText="visibility:hidden !important;width:0px !important;height:0px !important;margin:0px !important;padding:0px !important;border-style:none !important;border-width:0px !important;max-width:0px !important;max-height:0px !important;outline:none !important",this.H.add(new h.Disposable(function(){r.Si.style.cssText=r.Ti})),this.Ii.onunload=function(){r.wi=!1},function(){var t,e,i=this;s.get(u,["MutationObserver"])?((t=new MutationObserver(function(t){t.forEach(function(t){if("childList"===t.type)for(var e=0;e<t.addedNodes.length;e++){var n=t.addedNodes[e];t.target!==i.Ii&&(n===i.Si?(t.target.replaceChild(i.Ii,i.Si),l.call(i)):function(t){for(var e=i.Si.parentNode;null!==e;){if(e===t)return 1;e=e.parentNode}}(t.target)&&(i.Si.parentNode&&i.Si.parentNode.replaceChild(i.Ii,i.Si),l.call(i)))}})})).observe(document.body,{childList:!0,attributes:!1,characterData:!1,subtree:!0}),i.H.add(new h.Disposable(function(){t.disconnect()}))):(c("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details."),i.addEventListener("DOMNodeInserted",e=function(){i.Si.parentNode&&i.Si.parentNode.replaceChild(i.Ii,i.Si)},!1),i.H.add(new h.Disposable(function(){i.removeEventListener("DOMNodeInserted",e,!1)})))}.call(this),document.body&&document.body.contains||c("document.body.contains is not supported"),document.body&&document.body.contains&&document.body.contains(this.Si)&&(this.Si.parentNode.replaceChild(this.Ii,this.Si),this.Ei&&(this.Ii=this.Ei.finishInitializationInDom()),this.H.add(new h.Disposable(function(){r.Ii.parentNode&&r.Ii.parentNode.replaceChild(r.Si,r.Ii)}))),(new p).waitForReady(this.Ii,i)}catch(t){a("Error while loading Phenix RTC"+t),i(!1)}}function n(n){var i=this;i.Ii.phenixSetEventListener(n,function(){var t=i.A[n];if(t)for(var e=0;e<t.length;e++)t[e].apply(i,arguments)})}function f(t,e){var n;document.createEvent?(n=document.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=document.createEventObject()).eventType=e,n.eventName=e,setTimeout(function(){document.createEvent?t.dispatchEvent(n):t.fireEvent("on"+n.eventType,n)})}function l(){for(var t=Object.keys(this.A),e=0;e<t.length;e++)n.call(this,t[e]);this.hookUpEvents(),function(){var t,e,n=this,i=["style"];s.get(u,["MutationObserver"])?((t=new MutationObserver(function(t){t.forEach(function(t){"attributes"===t.type&&t.target===n.Si&&-1===i.indexOf(t.attributeName)&&(n.Ii[t.attributeName]=n.Si[t.attributeName])})})).observe(n.Si,{attributes:!0}),n.H.add(new h.Disposable(function(){t.disconnect()}))):(c("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details."),e=function(t){n.Ii[t.target.tagName]=n.Si[t.target.tagName]},n.Si.addEventListener?(n.Si.addEventListener("DOMAttrModified",e,!1),n.H.add(new h.Disposable(function(){n.Si.removeEventListener("DOMAttrModified",e,!1)}))):(n.Si.attachEvent("onpropertychange",e),n.H.add(new h.Disposable(function(){n.Si.detachEvent("DOMAttrModified",e)}))))}.call(this),this.Ii.id=this.Si.id,this.Ii.style.cssText=this.Ti,this.Ii.className=this.Si.className,this.Ii.innerHtml=this.Si.innerHtml,this.Ii.width=this.Si.width,this.Ii.height=this.Si.height,this.Ii.autoplay=this.Si.autoplay,this.Ii.muted=this.Si.muted,this.Ii.defaultMuted=this.Si.defaultMuted,this.Ii.volume=this.Si.volume}e.prototype.hookUpEvents=function(){function t(){f(a,"error")}function e(){a.muted=u.Ii.muted,f(a,"mute")}function n(){a.muted=u.Ii.muted,f(a,"unmute")}function i(){a.ended=u.Ii.ended,f(a,"ended")}function r(){a.width=u.Ii.width,a.height=u.Ii.height,f(a,"loadedmetadata")}function s(){a.width=u.Ii.width,a.height=u.Ii.height,f(a,"loadeddata")}function o(){a.width=u.Ii.width,a.height=u.Ii.height,f(a,"resize")}var u=this,a=this.Si,c=(this.addEventListener("error",t),this.addEventListener("mute",e),this.addEventListener("unmute",n),this.addEventListener("ended",i),this.addEventListener("loadedmetadata",r),this.addEventListener("loadeddata",s),this.addEventListener("resize",o),new h.Disposable(function(){u.removeEventListener("error",t),u.removeEventListener("mute",e),u.removeEventListener("unmute",n),u.removeEventListener("ended",i),u.removeEventListener("loadedmetadata",r),u.removeEventListener("loadeddata",s),u.removeEventListener("resize",o)}));return this.H.add(c),c},e.prototype.onReady=function(t){var e=this;this.wi?setTimeout(function(){t(e.bi)},1):this.ki=t},e.prototype.getElement=function(){return this.Ii},e.prototype.addEventListener=function(t,e,n){!function(t,e){return this.Ei.addEventListener(t,e)}.call(this,t,e,n)},e.prototype.removeEventListener=function(t,e,n){!function(t,e){return this.Ei.removeEventListener(t,e)}.call(this,t,e,n)},e.prototype.destroy=function(){this.H.dispose()};var d=new t(navigator.userAgent).detect();function p(t){this.Mi=t||15e3}return p.prototype.waitForReadyWithTimeout=function(e,n,i){function r(t){s||(s=!0,n(t))}var s=!1,o=1,u=o;Object.prototype.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,"onload")||"IE"!==d.browser&&a("No means of detecting when <object> is loaded"),e.onload=function(){r(!0)},function t(){if(4===e.readyState)return r(!0);o=Math.min(o+1e3,2*o),i<(u+=o)?(a("Timed out while waiting for <object> to load"),r(!1)):setTimeout(t,o)}()},p.prototype.waitForReady=function(t,e){this.waitForReadyWithTimeout(t,e,this.Mi)},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(10),n(2),n(5)],e=function(u,t,r,s){"use strict";var a=window,o=function(){console.log.apply(console,arguments)},e={width:480,height:360,videoWidth:480,videoHeight:360,muted:!1,volume:1,currentTime:0,duration:1/0,readyState:0,ended:!1,buffered:null,autoplay:!0},i=300,c=new t(navigator.userAgent).detect(),h="IE"===c.browser&&/(trident|microsoft)/i.test(u.get(a.navigator,["appName"],"")),f="Edge"===c.browser&&u.get(a.navigator,"msLaunchUri")&&!u.get(a.document,"documentMode");function n(t,e,n){this.H=new r.DisposableList,this.A=new s.NamedEvents,this.Ci="video"===t.tagName,this.qi=n.swfSrc,this.xi=t.id||n.streamId,this.Pi=t.clientWidth,this.Oi=t.clientHeight,this.Si=t,this.Ai=null,this.Ui=[],this.Di=["uid="+this.xi,"autoplay="+(!!u.isUndefined(t.autoplay)||t.autoplay),"muted="+(!u.isUndefined(t.muted)&&t.muted),"allowScriptAccess=always","preload=true","src="+JSON.stringify(e)];var i=this;this.H.add(new r.Disposable(function(){v.call(i,"fire_stop")}));try{this.Ai=(h||f?function(){return document.createElement("div")}:function(){var t=document.createElement("embed");return t.setAttribute("id","__"+this.xi),t.setAttribute("name","__"+this.xi),t.setAttribute("play","true"),t.setAttribute("loop","false"),t.setAttribute("quality","high"),t.setAttribute("bgcolor","#000000"),t.setAttribute("wmode","transparent"),t.setAttribute("allowScriptAccess","always"),t.setAttribute("allowFullScreen","true"),t.setAttribute("type","application/x-shockwave-flash"),t.setAttribute("pluginspage","//www.macromedia.com/go/getflashplayer"),t.setAttribute("src",this.qi),t.setAttribute("flashvars",this.Di.join("&")),this.Ci&&(t.setAttribute("width",this.Pi.toString()),t.setAttribute("height",this.Oi.toString())),t}).call(this),p.call(this)}catch(t){!function(){console.error.apply(console,arguments)}("Error while loading Flash Player"+t)}}function l(e,n){return u.findIndex(this.Ui,function(t){return t.name===e&&t.listener===n})}function d(t,e){var n=document.createElement("param");return n.setAttribute("name",t),n.setAttribute("value",e),n}function p(){u.assign(this.Ai,e,{id:this.xi,width:this.Pi,height:this.Oi,videoWidth:this.Pi,videoHeight:this.Oi}),function(){function t(){v.call(o,"set_size",o.Fi?screen.width:o.Ai.clientWidth,o.Fi?screen.height:o.Ai.clientHeight)}var o=this,e=(a["__event__"+this.xi]=function(t,e){n=t,i=o.Ai,r=n.match(/([a-z]+\.([a-z]+))/i),i={target:i},null!==r&&(n=r[1],i.namespace=r[2]);var n,i,r,s="IE"===c.browser&&8<c.version?((r=a.document.createEvent("CustomEvent")).initCustomEvent(n,!1,!1,i),r):a.CustomEvent?new a.CustomEvent(n,{detail:i}):i;if(e)try{s.data=JSON.parse(e),s.details.data=s.data}catch(t){s.message=e}switch(t){case"ended":break;case"error":o.Ai.error=s.data,o.Ai.dispatchEvent&&o.Ai.dispatchEvent(new Error(e));break;case"loadeddata":case"loadedmetadata":case"loadstart":o.Ai.dispatchEvent&&o.Ai.dispatchEvent(s);break;case"pause":o.Ai.paused=!0;break;case"play":case"playing":o.Ai.paused=!1;break;case"progress":case"seeked":case"seeking":case"stalled":case"suspend":o.Ai.dispatchEvent&&o.Ai.dispatchEvent(s);break;case"timeupdate":o.Ai.currentTime=function(t){return(this.Ai["get_"+t]||u.noop).call(this.Ai)}.call(o,"currentTime"),o.Ai.dispatchEvent&&o.Ai.dispatchEvent(s)}o.A.fireAsync(t,[s])},this.Ai.requestFullscreen||this.Ai.mozRequestFullScreen||this.Ai.webkitRequestFullScreen||this.Ai.msRequestFullscreen);this.H.add(new r.Disposable(function(){delete a["__event__"+o.xi]})),this.Ai.play=function(){v.call(o,"fire_play")},this.Ai.load=function(){v.call(o,"fire_load")},this.Ai.seek=function(){v.call(o,"fire_seek")},this.Ai.pause=function(){v.call(o,"fire_pause")},this.Ai.requestFullscreen=function(){var t;o.Fi=!0,function(){var t=this;function e(){document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement||(document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("fullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("keydown",n),t.Fi=!1,t.Ai.style.position=t.Ni,t.Ai.style.height=t.ji,t.Ai.style.width=t.Li)}function n(t){t=t||a.event;("key"in t?"Escape"===t.key||"Esc"===t.key:27===t.keyCode)&&e()}document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("MSFullscreenChange",e,!1),document.addEventListener("keydown",n,!1)}.call(o),o.ji=o.Ai.style.height,o.Li=o.Ai.style.width,o.Ni=o.Ai.style.position,o.Ai.style.position="absolute",o.Ai.style.height="100%",o.Ai.style.width="100%",void 0!==a.ActiveXObject&&null!==(t=new a("WScript.Shell"))&&t.SendKeys("{F11}"),e.call(o.Ai)},u.addEventListener(a,"resize",t),this.H.add(new r.Disposable(function(){u.removeEventListener(a,"resize",t)}))}.call(this),function(){var t,e,n=this,i=["currentTime","paused","error","src"];u.get(a,["MutationObserver"])?((t=new MutationObserver(function(t){t.forEach(function(t){"attributes"!==t.type||t.target!==n.Ai||u.includes(i,t.attributeName)||m.call(n,t.attributeName,n.Ai[t.attributeName])})})).observe(n.Ai,{attributes:!0}),n.H.add(new r.Disposable(function(){t.disconnect()}))):(o("Falling back to use of DOM event listeners. This results in degraded performance for further DOM modifications and does not work for IE prior to version 9. See https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events for details."),e=function(t){u.includes(i,t.target.tagName)||m.call(n,t.target.tagName,n.Ai[t.target.tagName])},n.Ai.addEventListener?(n.Ai.addEventListener("DOMAttrModified",e,!1),n.H.add(new r.Disposable(function(){n.Ai.removeEventListener("DOMAttrModified",e,!1)}))):(n.Ai.attachEvent("onpropertychange",e),n.H.add(new r.Disposable(function(){n.Ai.detachEvent("DOMAttrModified",e)}))))}.call(this),function(){var t=function(){var n=this,i=n.Si.muted,r=n.Ai.muted;return function(){var t=n.Ai.muted,e=n.Ai.muted;t===i&&e===r||((e=t!==i?r=i=t:e)!==r&&(r=i=t),n.Ai.muted=e,n.Si.muted=e,m.call(n,"muted",e))}}.call(this),e=function(){var n=this,i=n.Si.volume,r=n.Ai.volume;return function(){var t=n.Ai.volume,e=n.Ai.volume;t===i&&e===r||((e=t!==i?r=i=t:e)!==r&&(r=i=t),n.Ai.volume=e,n.Si.volume=e,m.call(n,"volume",e))}}.call(this),n=setInterval(function(){t(),e()},i);this.H.add(new r.Disposable(function(){clearInterval(n)}))}.call(this)}function m(t,e){return(this.Ai["set_"+t]||u.noop).call(this.Ai,e)}function v(t){t=this.Ai[t];if([].shift.apply(arguments),t)return t.apply(this.Ai,arguments)}return n.prototype.finishInitializationInDom=function(){return function(){var t,n,e,i;return(h||f)&&(t=(f?"__"+this.xi:this.xi)+u.uniqueId(),n=document.createElement("object"),e=document.createElement("div"),i=[d("movie",this.qi+"?x="+u.now()),d("flashvars",this.Di.join("&")),d("quality",2),d("bgcolor","#000000"),d("wmode","transparent"),d("allowScriptAccess","always"),d("allowFullScreen","true"),e],e.innerHTML="You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https://get.adobe.com/flashplayer/",f?(n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("data",this.qi),n.setAttribute("id",t),n.setAttribute("width","__"+this.Pi.toString()),n.setAttribute("height","__"+this.Oi.toString())):(n.setAttribute("classid","clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"),n.setAttribute("codebase","//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"),n.setAttribute("id",t),n.setAttribute("width",this.Pi.toString()),n.setAttribute("height",this.Oi.toString())),n.object?(u.forEach(i,function(t){u.isNullOrUndefined(u.get(n.object,[t.name]))||(n.object[t.name]=t.value)}),n.appendChild(e)):u.forEach(i,function(e){var t=u.find(n.children,function(t){return t.name===e.name});return t?n.replaceChild(e,t):n.appendChild(e)}),this.Ai.outerHTML=n.outerHTML,a.document.getElementById)&&(this.Ai=a.document.getElementById(t),p.call(this)),this.Ai}.call(this)},n.prototype.getElement=function(){return this.Ai},n.prototype.addEventListener=function(t,e){var n;-1<l.call(this,t,e)||(n=this.A.listen(t,e),this.H.add(n),this.Ui.push({name:t,listener:e,disposable:n}))},n.prototype.removeEventListener=function(t,e){t=l.call(this,t,e);-1<t&&this.Ui.splice(t,1)[0].disposable.dispose()},n.prototype.destroy=function(){this.H.dispose()},n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(2)],e=function(r,e,t,s){"use strict";function n(){this.zt=new t.NamedEvents,this.Bi=r.now(),this.H=new s.DisposableList,this._i=!0,this.H.add(this.zt),function(){if(o())return function(){var i;o()&&(i=this,chrome.extension.onRequest.addListener(function(t,e,n){"is_selected"===t&&chrome.tabs.getSelected(null,function(t){t=t.id===e.tab.id;u.call(i,t),n(t)})}))}.call(this);!function(){var e,t,n=this;function i(){var t=!document[e];u.call(n,t)}"object"==typeof document&&(void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden?(e="webkitHidden",t="webkitvisibilitychange"):void 0!==document.hidden&&(e="hidden",t="visibilitychange"),void 0!==document.addEventListener&&void 0!==document[e]?(r.addEventListener(document,t,i,!1),n.H.add(new s.Disposable(function(){r.removeEventListener(document,t,i,!1)}))):function(){var e=this;e.Wi=setInterval(function(){var t=document.hasFocus();u.call(e,t)},3e3),e.H.add(new s.Disposable(function(){r.v(e.Wi)&&clearInterval(e.Wi),e.Wi=null}))}.call(n))}.call(this)}.call(this)}function o(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.onRequest}function u(t){if(e.k(t,"isForeground"),this._i!==t)return t?(this._i=!0,i.call(this,"foreground")):(this._i=!1,i.call(this,"background"))}function i(t){var e=r.now(),n=e-this.Bi;this.Bi=e,this.zt.fire(t,[n])}return n.prototype.isForeground=function(){return this._i},n.prototype.getTimeSinceLastChange=function(){return r.now()-this.Bi},n.prototype.onForeground=function(t){return e.g(t,"callback"),this.zt.listen("foreground",t)},n.prototype.onBackground=function(t){return e.g(t,"callback"),this.zt.listen("background",t)},n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(18),n(3),n(72),n(73)],e=function(u,a,r,s,c,o,h){"use strict";function t(t,e,n,i){a.R(t,"uri"),a.u(e,"deviceId"),a.R(n,"version"),a.h(i,"logger"),this.it=e,this.W=n,this.D=i,this.Vi=new s.MQWebSocket(t,this.D,[o,h],5),this.nt=new r.Observable(null).extend({rateLimit:0})}return t.prototype.onEvent=function(t,e){return this.Vi.onEvent(t,e)},t.prototype.disconnect=function(){return this.nt.setValue(null),this.Vi.disconnect()},t.prototype.authenticate=function(t,i){a.R(t,"authToken"),a.g(i,"callback");var t={apiVersion:this.Vi.getApiVersion(),clientVersion:this.W,deviceId:this.it,platform:c.browser,platformVersion:c.browserVersion.toString(),authenticationToken:t},r=(this.getSessionId()&&(t.sessionId=this.getSessionId()),this);return this.Vi.sendRequest("pcast.Authenticate",t,function(t,e){var n;return e&&((n=r.nt.getValue())&&n!==e.sessionId&&r.Vi.disposeOfPendingRequests(),r.nt.setValue(e.sessionId)),i(t,e)})},t.prototype.getSessionId=function(){return this.nt.getValue()},t.prototype.getObservableSessionId=function(){return this.nt},t.prototype.bye=function(t,e){a.R(t,"reason"),a.g(e,"callback");t={sessionId:this.getSessionId(),reason:t};return this.Vi.sendRequest("pcast.Bye",t,e)},t.prototype.setupStream=function(t,e,n,i,r){a.R(t,"streamType"),a.R(e,"streamToken"),a.h(n,"options"),a.g(r,"callback");var s=c.browser||"UnknownBrowser",o=s+"-"+(c.browserVersion||0),i="rtt[http]="+i,e={streamToken:e,createStream:{sessionId:this.getSessionId(),options:["data-quality-notifications",i],connectUri:n.connectUri,connectOptions:n.connectOptions||[],tags:n.tags||[],userAgent:u.get(c,["global","navigator","userAgent"],o)}};return n.originStreamId&&(e.createStream.originStreamId=n.originStreamId),n.negotiate&&(e.createStream.createOfferDescription={streamId:"",options:[t,s,o],apiVersion:this.Vi.getApiVersion()},"undefined"!=typeof screen)&&e.createStream.createOfferDescription.options.push("screen="+screen.width+"x"+screen.height),!1===n.receiveAudio&&e.createStream.options.push("no-audio"),!1===n.receiveVideo&&e.createStream.options.push("no-video"),this.Vi.sendRequest("pcast.SetupStream",e,r)},t.prototype.setAnswerDescription=function(t,e,n){a.R(t,"streamId"),a.R(e,"sdp"),a.g(n,"callback");t={streamId:t,sessionDescription:{type:"Answer",sdp:e},apiVersion:this.Vi.getApiVersion()};return this.Vi.sendRequest("pcast.SetRemoteDescription",t,n)},t.prototype.addIceCandidates=function(t,e,n,i){a.R(t,"streamId"),a.isArray(e,"candidates"),a.h(n,"options"),a.g(i,"callback");t={streamId:t,candidates:u.map(e,function(t,e){return a.R(t.candidate,"candidate["+e+"].candidate"),a.v(t.sdpMLineIndex,"candidate["+e+"].sdpMLineIndex"),a.R(t.sdpMid,"candidate["+e+"].sdpMid"),{candidate:t.candidate,sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid}}),options:n,apiVersion:this.Vi.getApiVersion()};return this.Vi.sendRequest("pcast.AddIceCandidates",t,i)},t.prototype.updateStreamState=function(t,e,n,i,r){a.R(t,"streamId"),a.R(e,"signalingState"),a.R(n,"iceGatheringState"),a.R(i,"iceConnectionState"),a.g(r,"callback");t={streamId:t,signalingState:e,iceGatheringState:n,iceConnectionState:i,apiVersion:this.Vi.getApiVersion()};return this.Vi.sendRequest("pcast.UpdateStreamState",t,r)},t.prototype.destroyStream=function(t,e,n){return a.R(t,"streamId"),a.u(e,"reason"),a.g(n,"callback"),this.Vi.sendRequest("pcast.DestroyStream",{streamId:t,reason:e},n)},t.prototype.getRoomInfo=function(t,e,n){t?a.u(t,"roomId"):a.u(e,"alias"),a.g(n,"callback");t={roomId:t,alias:e,sessionId:this.getSessionId()};return this.Vi.sendRequest("chat.GetRoomInfo",t,n)},t.prototype.enterRoom=function(t,e,n,i,r,s){t?a.u(t,"roomId"):a.u(e,"alias"),a.h(n,"member"),a.v(r,"timestamp"),a.isArray(i,"options"),a.g(s,"callback");t={roomId:t,alias:e,sessionId:this.getSessionId(),member:n,options:i,timestamp:r};return this.Vi.sendRequest("chat.JoinRoom",t,s)},t.prototype.leaveRoom=function(t,e,n){a.u(t,"roomId"),a.v(e,"timestamp"),a.g(n,"callback");t={roomId:t,sessionId:this.getSessionId(),timestamp:e};return this.Vi.sendRequest("chat.LeaveRoom",t,n)},t.prototype.updateMember=function(t,e,n,i){a.R(t,"roomId"),a.h(e,"member"),a.v(n,"timestamp"),a.g(i,"callback"),e.updateStreams=Object.prototype.hasOwnProperty.call(e,"streams");t={sessionId:this.getSessionId(),roomId:t,member:e,timestamp:n};return this.Vi.sendRequest("chat.UpdateMember",t,i)},t.prototype.updateRoom=function(t,e,n){a.h(t,"room"),a.v(e,"timestamp"),a.g(n,"callback");t={sessionId:this.getSessionId(),room:t,timestamp:e};return this.Vi.sendRequest("chat.UpdateRoom",t,n)},t.prototype.sendMessageToRoom=function(t,e,n){return a.R(t,"roomId"),a.h(e,"chatMessage"),this.Vi.sendRequest("chat.SendMessageToRoom",{roomId:t,chatMessage:e},n)},t.prototype.subscribeToRoomConversation=function(t,e,n,i){return a.R(t,"sessionId"),a.R(e,"roomId"),a.v(n,"batchSize"),this.Vi.sendRequest("chat.FetchRoomConversation",{sessionId:t,roomId:e,limit:n,options:["Subscribe"]},i)},t.prototype.getMessages=function(t,e,n,i,r,s){a.R(t,"sessionId"),a.R(e,"roomId"),r&&i||a.v(n,"batchSize");t={sessionId:t,roomId:e,limit:n||0,options:[]};return r&&(a.R(r,"beforeMessageId"),t.beforeMessageId=r),i&&(a.R(i,"afterMessageId"),t.afterMessageId=i),this.Vi.sendRequest("chat.FetchRoomConversation",t,s)},t.prototype.toString=function(){return"PCastProtocol["+this.Vi.toString()+"]"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{package:"pcast",options:{optimize_for:"LITE_RUNTIME"},messages:[{name:"Authenticate",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:9,options:{default:0}},{rule:"required",type:"string",name:"clientVersion",id:1},{rule:"optional",type:"string",name:"device",id:12},{rule:"required",type:"string",name:"deviceId",id:2},{rule:"optional",type:"string",name:"manufacturer",id:13},{rule:"required",type:"string",name:"platform",id:3},{rule:"required",type:"string",name:"platformVersion",id:4},{rule:"required",type:"string",name:"authenticationToken",id:5},{rule:"optional",type:"string",name:"connectionId",id:6},{rule:"optional",type:"string",name:"connectionRouteKey",id:10},{rule:"optional",type:"string",name:"remoteAddress",id:11},{rule:"optional",type:"string",name:"sessionId",id:7},{rule:"optional",type:"string",name:"applicationId",id:8}]},{name:"AuthenticateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"sessionId",id:2},{rule:"optional",type:"string",name:"redirect",id:3},{rule:"repeated",type:"string",name:"roles",id:4}]},{name:"Bye",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2}]},{name:"ByeResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SessionDescription",fields:[{rule:"required",type:"Type",name:"type",id:1,options:{default:"Offer"}},{rule:"required",type:"string",name:"sdp",id:2}],enums:[{name:"Type",values:[{name:"Offer",id:0},{name:"Answer",id:1}]}]},{name:"CreateStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"originStreamId",id:2},{rule:"repeated",type:"string",name:"originStreamIds",id:10},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"string",name:"connectUri",id:8},{rule:"repeated",type:"string",name:"connectOptions",id:9},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"userAgent",id:11},{rule:"optional",type:"SetRemoteDescription",name:"setRemoteDescription",id:5},{rule:"optional",type:"CreateOfferDescription",name:"createOfferDescription",id:6},{rule:"optional",type:"CreateAnswerDescription",name:"createAnswerDescription",id:7}]},{name:"IceServer",fields:[{rule:"repeated",type:"string",name:"urls",id:1},{rule:"optional",type:"string",name:"username",id:2},{rule:"optional",type:"string",name:"credential",id:3}]},{name:"RtcConfiguration",fields:[{rule:"optional",type:"BundlePolicy",name:"bundlePolicy",id:1},{rule:"optional",type:"uint32",name:"iceCandidatePoolSize",id:3},{rule:"repeated",type:"IceServer",name:"iceServers",id:4},{rule:"optional",type:"IceTransportPolicy",name:"iceTransportPolicy",id:5},{rule:"optional",type:"string",name:"peerIdentity",id:6},{rule:"optional",type:"RtcpMuxPolicy",name:"rtcpMuxPolicy",id:7}],enums:[{name:"BundlePolicy",values:[{name:"BundlePolicyBalanced",id:1},{name:"BundlePolicyMaxCompat",id:2},{name:"BundlePolicyMaxBundle",id:3}]},{name:"IceTransportPolicy",values:[{name:"IceTransportPolicyAll",id:1},{name:"IceTransportPolicyPublic",id:2},{name:"IceTransportPolicyRelay",id:3}]},{name:"RtcpMuxPolicy",values:[{name:"RtcpMuxPolicyNegotiate",id:1},{name:"RtcpMuxPolicyRequire",id:2}]}]},{name:"CreateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamId",id:2},{rule:"optional",type:"string",name:"instanceRouteKey",id:5},{rule:"repeated",type:"string",name:"streamUris",id:8},{rule:"optional",type:"RtcConfiguration",name:"rtcConfiguration",id:9},{rule:"optional",type:"SetRemoteDescriptionResponse",name:"setRemoteDescriptionResponse",id:3},{rule:"optional",type:"CreateOfferDescriptionResponse",name:"createOfferDescriptionResponse",id:4},{rule:"optional",type:"CreateAnswerDescriptionResponse",name:"createAnswerDescriptionResponse",id:6},{rule:"repeated",type:"string",name:"options",id:7},{rule:"optional",type:"uint64",name:"offset",id:10,options:{default:0}}]},{name:"SetLocalDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetLocalDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"SetRemoteDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"SetRemoteDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateOfferDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateOfferDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"CreateAnswerDescription",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"string",name:"options",id:2},{rule:"optional",type:"uint32",name:"apiVersion",id:3,options:{default:0}}]},{name:"CreateAnswerDescriptionResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"SessionDescription",name:"sessionDescription",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"IceCandidate",fields:[{rule:"required",type:"string",name:"candidate",id:1},{rule:"required",type:"uint32",name:"sdpMLineIndex",id:2},{rule:"required",type:"string",name:"sdpMid",id:3}]},{name:"AddIceCandidates",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"repeated",type:"IceCandidate",name:"candidates",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"optional",type:"uint32",name:"apiVersion",id:4,options:{default:0}}]},{name:"AddIceCandidatesResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"UpdateStreamState",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"signalingState",id:2},{rule:"required",type:"string",name:"iceGatheringState",id:3},{rule:"required",type:"string",name:"iceConnectionState",id:4},{rule:"optional",type:"uint32",name:"apiVersion",id:5,options:{default:0}}]},{name:"UpdateStreamStateResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"string",name:"options",id:2}]},{name:"DestroyStream",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"repeated",type:"string",name:"options",id:3}]},{name:"DestroyStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"ConnectionDisconnected",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"uint32",name:"reasonCode",id:2},{rule:"optional",type:"string",name:"description",id:3}]},{name:"ConnectionDisconnectedResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"tags",id:3}]},{name:"SourceStreamStarted",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"tags",id:4},{rule:"optional",type:"string",name:"continuationId",id:5},{rule:"optional",type:"string",name:"routeKey",id:6}]},{name:"SourceStreamEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"string",name:"reason",id:3},{rule:"repeated",type:"string",name:"capabilities",id:4},{rule:"repeated",type:"string",name:"tags",id:5}]},{name:"StreamEndedResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"continuationId",id:2},{rule:"optional",type:"string",name:"routeKey",id:3}]},{name:"StreamIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"StreamArchived",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"startTime",id:4},{rule:"required",type:"string",name:"uri",id:3}]},{name:"SessionEnded",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"required",type:"float",name:"duration",id:3}]},{name:"ResourceIdle",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"routeKey",id:2}]},{name:"ResourceIdleResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"StreamPlaylist",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"PlaylistType",name:"playlistType",id:3},{rule:"required",type:"string",name:"uri",id:4},{rule:"required",type:"bool",name:"isVariant",id:5,options:{default:!0}}],enums:[{name:"PlaylistType",values:[{name:"Live",id:0},{name:"OnDemand",id:1}]}]},{name:"StreamRtmp",fields:[{rule:"required",type:"string",name:"streamId",id:1},{rule:"required",type:"string",name:"uri",id:2},{rule:"required",type:"uint32",name:"height",id:3},{rule:"required",type:"uint32",name:"bitrate",id:4}]},{name:"SendEventToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendEventToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"SendRequestToClient",fields:[{rule:"required",type:"string",name:"connectionId",id:1},{rule:"required",type:"string",name:"type",id:2},{rule:"required",type:"bytes",name:"payload",id:3}]},{name:"SendRequestToClientResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"bytes",name:"payload",id:3}]},{name:"SetupStream",fields:[{rule:"required",type:"string",name:"streamToken",id:1},{rule:"required",type:"CreateStream",name:"createStream",id:2}]},{name:"SetupStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"CreateStreamResponse",name:"createStreamResponse",id:2}]},{name:"SetupPlaylistStream",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamToken",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"repeated",type:"string",name:"tags",id:4}]},{name:"PlaylistStreamManifest",fields:[{rule:"required",type:"string",name:"manifest",id:1},{rule:"required",type:"bool",name:"isProtectedContent",id:2},{rule:"optional",type:"string",name:"drmToken",id:3}]},{name:"SetupPlaylistStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"PlaylistStreamManifest",name:"manifests",id:2},{rule:"optional",type:"uint64",name:"offset",id:3,options:{default:0}}]},{name:"StreamDataQuality",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"streamId",id:2},{rule:"required",type:"uint64",name:"timestamp",id:3},{rule:"required",type:"DataQualityStatus",name:"status",id:4},{rule:"required",type:"DataQualityReason",name:"reason",id:5}],enums:[{name:"DataQualityStatus",values:[{name:"NoData",id:0},{name:"AudioOnly",id:1},{name:"All",id:2}]},{name:"DataQualityReason",values:[{name:"None",id:0},{name:"UploadLimited",id:1},{name:"DownloadLimited",id:2},{name:"PublisherLimited",id:3},{name:"NetworkLimited",id:4}]}]},{name:"StreamDataQualityResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"CallbackEvent",fields:[{rule:"optional",type:"uint32",name:"apiVersion",id:1,options:{default:0}},{rule:"required",type:"string",name:"entity",id:2},{rule:"required",type:"string",name:"what",id:3},{rule:"required",type:"string",name:"data",id:4},{rule:"optional",type:"string",name:"sessionId",id:5}]},{name:"Uri",fields:[{rule:"optional",type:"string",name:"protocol",id:1,options:{default:"http"}},{rule:"required",type:"string",name:"host",id:2},{rule:"optional",type:"uint32",name:"port",id:3,options:{default:80}},{rule:"optional",type:"string",name:"method",id:4,options:{default:"POST"}},{rule:"optional",type:"string",name:"path",id:5,options:{default:"/"}}]},{name:"SetApplicationCallback",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"Uri",name:"callback",id:3}]},{name:"SetApplicationCallbackResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"endpoint",id:2}]},{name:"IssueAuthenticationToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"repeated",type:"string",name:"capabilities",id:3}]},{name:"IssueAuthenticationTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"authenticationToken",id:2}]},{name:"IssueStreamToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"sessionId",id:3},{rule:"optional",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"alternateOriginStreamIds",id:6},{rule:"repeated",type:"string",name:"capabilities",id:5},{rule:"optional",type:"bool",name:"permissive",id:7,options:{default:!1}}]},{name:"IssueStreamTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"streamToken",id:2}]},{name:"IssueDrmToken",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"sessionId",id:3},{rule:"required",type:"string",name:"originStreamId",id:4},{rule:"repeated",type:"string",name:"capabilities",id:5}]},{name:"IssueDrmTokenResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"drmToken",id:2}]},{name:"TerminateStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"TerminateStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"DeleteStream",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"streamId",id:3,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"streamToken",id:5,oneof:"streamOrToken"},{rule:"optional",type:"string",name:"reason",id:4}],oneofs:{streamOrToken:[3,5]}},{name:"DeleteStreamResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"Stream",fields:[{rule:"required",type:"string",name:"streamId",id:1}]},{name:"ListStreams",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"optional",type:"string",name:"start",id:3},{rule:"required",type:"uint32",name:"length",id:4},{rule:"repeated",type:"string",name:"options",id:5}]},{name:"ListStreamsResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"string",name:"start",id:2},{rule:"optional",type:"uint32",name:"length",id:3},{rule:"repeated",type:"Stream",name:"streams",id:4}]},{name:"GetPlaylistUris",fields:[{rule:"required",type:"string",name:"applicationId",id:1},{rule:"required",type:"string",name:"secret",id:2},{rule:"required",type:"string",name:"streamId",id:3},{rule:"repeated",type:"string",name:"options",id:4}]},{name:"GetPlaylistUrisResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"Playlist",name:"playlists",id:2},{rule:"optional",type:"StreamMetadata",name:"streamInfo",id:3}],messages:[{name:"PlaylistMetadata",fields:[{rule:"optional",type:"uint32",name:"bitrate",id:1},{rule:"optional",type:"uint32",name:"height",id:2},{rule:"optional",type:"float",name:"framesPerSecond",id:3}]},{name:"StreamMetadata",fields:[{rule:"required",type:"string",name:"startTime",id:1},{rule:"optional",type:"string",name:"endTime",id:2}]},{name:"Playlist",fields:[{rule:"required",type:"string",name:"name",id:1},{rule:"required",type:"PlaylistType",name:"type",id:2},{rule:"required",type:"string",name:"uri",id:3},{rule:"required",type:"bool",name:"isVariant",id:4},{rule:"required",type:"bool",name:"isProtected",id:5},{rule:"required",type:"PlaylistMetadata",name:"info",id:6}]}],enums:[{name:"PlaylistType",values:[{name:"Hls",id:0},{name:"Dash",id:1}]}]}]}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{package:"chat",options:{optimize_for:"LITE_RUNTIME"},messages:[{name:"Room",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"alias",id:2},{rule:"required",type:"string",name:"name",id:3},{rule:"required",type:"string",name:"description",id:4},{rule:"required",type:"RoomType",name:"type",id:5},{rule:"repeated",type:"string",name:"options",id:6},{rule:"optional",type:"string",name:"bridgeId",id:7},{rule:"optional",type:"string",name:"pin",id:8}]},{name:"Stream",fields:[{rule:"required",type:"StreamType",name:"type",id:1},{rule:"required",type:"string",name:"uri",id:2},{rule:"required",type:"TrackState",name:"audioState",id:3},{rule:"required",type:"TrackState",name:"videoState",id:4}]},{name:"Member",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"screenName",id:2},{rule:"required",type:"MemberRole",name:"role",id:3},{rule:"repeated",type:"Stream",name:"streams",id:4},{rule:"required",type:"MemberState",name:"state",id:5},{rule:"required",type:"uint64",name:"lastUpdate",id:6}]},{name:"MemberUpdate",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"screenName",id:2},{rule:"optional",type:"MemberRole",name:"role",id:3},{rule:"required",type:"bool",name:"updateStreams",id:7,options:{default:!1}},{rule:"repeated",type:"Stream",name:"streams",id:4},{rule:"optional",type:"MemberState",name:"state",id:5},{rule:"required",type:"uint64",name:"lastUpdate",id:6}]},{name:"ChatUser",fields:[{rule:"optional",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"screenName",id:2},{rule:"required",type:"MemberRole",name:"role",id:3},{rule:"required",type:"uint64",name:"lastUpdate",id:4}]},{name:"ChatMessage",fields:[{rule:"required",type:"string",name:"messageId",id:1},{rule:"required",type:"uint64",name:"timestamp",id:2},{rule:"required",type:"ChatUser",name:"from",id:3},{rule:"required",type:"string",name:"message",id:4}]},{name:"JoinRoom",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"alias",id:2},{rule:"required",type:"string",name:"sessionId",id:3},{rule:"required",type:"Member",name:"member",id:4},{rule:"repeated",type:"string",name:"options",id:5},{rule:"required",type:"uint64",name:"timestamp",id:6}]},{name:"JoinRoomResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"Room",name:"room",id:2},{rule:"repeated",type:"Member",name:"members",id:3},{rule:"optional",type:"Member",name:"self",id:5},{rule:"repeated",type:"string",name:"options",id:4}]},{name:"UpdateRoom",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"Room",name:"room",id:2},{rule:"required",type:"uint64",name:"timestamp",id:3}]},{name:"UpdateRoomResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"UpdateMember",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"optional",type:"string",name:"roomId",id:5},{rule:"required",type:"MemberUpdate",name:"member",id:2},{rule:"repeated",type:"string",name:"options",id:3},{rule:"required",type:"uint64",name:"timestamp",id:4}]},{name:"UpdateMemberResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"uint64",name:"lastUpdate",id:2}]},{name:"LeaveRoom",fields:[{rule:"required",type:"string",name:"roomId",id:1},{rule:"required",type:"string",name:"sessionId",id:2},{rule:"required",type:"uint64",name:"timestamp",id:3}]},{name:"LeaveRoomResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"DestroyRoom",fields:[{rule:"required",type:"string",name:"roomId",id:1}]},{name:"DestroyRoomResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"GetRoomInfo",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"alias",id:2},{rule:"optional",type:"string",name:"sessionId",id:3},{rule:"optional",type:"string",name:"applicationId",id:4},{rule:"optional",type:"string",name:"secret",id:5},{rule:"repeated",type:"string",name:"options",id:6}]},{name:"GetRoomInfoResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"optional",type:"Room",name:"room",id:2},{rule:"repeated",type:"Member",name:"members",id:3},{rule:"repeated",type:"string",name:"options",id:4}]},{name:"RoomEvent",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"roomId",id:2},{rule:"required",type:"RoomEventType",name:"eventType",id:3},{rule:"repeated",type:"Member",name:"members",id:4},{rule:"optional",type:"Room",name:"room",id:5},{rule:"repeated",type:"string",name:"options",id:6},{rule:"required",type:"uint64",name:"timestamp",id:7}]},{name:"SendMessageToRoom",fields:[{rule:"required",type:"string",name:"roomId",id:1},{rule:"required",type:"ChatMessage",name:"chatMessage",id:2}]},{name:"SendMessageToRoomResponse",fields:[{rule:"required",type:"string",name:"status",id:1}]},{name:"FetchRoomConversation",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"roomId",id:2},{rule:"optional",type:"string",name:"afterMessageId",id:3},{rule:"optional",type:"string",name:"beforeMessageId",id:4},{rule:"required",type:"uint32",name:"limit",id:5},{rule:"repeated",type:"RoomConversationOption",name:"options",id:6}]},{name:"FetchRoomConversationResponse",fields:[{rule:"required",type:"string",name:"status",id:1},{rule:"repeated",type:"ChatMessage",name:"chatMessages",id:2}]},{name:"RoomConversationEvent",fields:[{rule:"required",type:"string",name:"sessionId",id:1},{rule:"required",type:"string",name:"roomId",id:2},{rule:"required",type:"RoomConversationEventType",name:"eventType",id:3},{rule:"repeated",type:"ChatMessage",name:"chatMessages",id:4}]},{name:"RoomBridgeIdle",fields:[{rule:"required",type:"string",name:"roomId",id:1},{rule:"required",type:"string",name:"bridgeId",id:2}]}],enums:[{name:"RoomType",values:[{name:"DirectChat",id:0},{name:"MultiPartyChat",id:1},{name:"ModeratedChat",id:2},{name:"TownHall",id:3},{name:"Channel",id:4}]},{name:"MemberRole",values:[{name:"Participant",id:0},{name:"Moderator",id:1},{name:"Presenter",id:2},{name:"Audience",id:3}]},{name:"MemberState",values:[{name:"Active",id:0},{name:"Passive",id:1},{name:"HandRaised",id:2},{name:"Inactive",id:3},{name:"Offline",id:4}]},{name:"RoomEventType",values:[{name:"MemberJoined",id:0},{name:"MemberLeft",id:1},{name:"MemberUpdated",id:2},{name:"RoomUpdated",id:3},{name:"RoomEnded",id:4}]},{name:"TrackState",values:[{name:"TrackEnabled",id:0},{name:"TrackDisabled",id:1},{name:"TrackEnded",id:2}]},{name:"StreamType",values:[{name:"User",id:0},{name:"Presentation",id:1},{name:"Audio",id:2}]},{name:"RoomConversationOption",values:[{name:"Subscribe",id:0}]},{name:"RoomConversationEventType",values:[{name:"Message",id:0}]}]}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(75)],e=function(t){return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2)],e=function(s,i,r){"use strict";function t(t,e,n){i.h(t,"options"),i.h(t.logger,"options.logger"),i.R(t.version,"options.version"),i.g(e,"onClosestEndpointFound"),n&&i.g(n,"onAnEndpointResolved"),this.D=t.logger,this.W=t.version,this.zi=e,this.Hi=n,this.H=new r.DisposableList,this.Gi=!1}function e(t,e){var n;4===t.readyState&&(200===t.status?(n=t.getAllResponseHeaders(),n=s.reduce(n.trim().split(/[\r\n]+/),function(t,e){var e=e.split(": "),n=e.shift(),e=e.join(": ");return n&&(t[n]=e),t},{}),e(null,{data:t.response||t.responseText,headers:n,rawXhr:t})):((n=new Error(0===t.status?"timeout":"Status=["+t.status+"]")).code=t.status,e(n)))}return t.prototype.isResolved=function(){return this.Gi},t.prototype.dispose=function(){this.H.dispose()},t.prototype.completeCallback=function(t,e,n){if(!this.isResolved())return this.Gi=!0,this.zi(null,{uri:n,roundTripTime:e,endPoint:t})},t.prototype.resolveAll=function(t){for(var e=0;e<t.length;e++)this.resolve(t[e])},t.prototype.resolve=function(i){var r=this,t=(r.D.info("Checking end point [%s]",i),r.W),t=function(t){var e=new XMLHttpRequest;if("withCredentials"in e)e.open("GET",t,!0);else{if("undefined"==typeof XDomainRequest)return;(e=new XDomainRequest).open("GET",t)}return e}(i+"?version="+t+"&_="+s.now());t.addEventListener("readystatechange",s.bind(e,this,t,function(t,e){var n=s.get(e,["stats","successResponseTime"],0);if(r.Hi&&(t?r.Hi(t,{endPoint:i}):r.Hi(null,{time:n,endPoint:i})),t)503===t.code?r.D.info("End point [%s] is temporarily unavailable",i):r.D.warn("Unable to resolve end point [%s] with [%s]",i,t);else if(!r.isResolved())return r.completeCallback(i,n,e.data)})),t.timeout=15e3,t.send(null)},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(3)],e=function(o,n,i,u){"use strict";var t=52;function e(t,e){n.h(t=t||{},"options"),n.h(e,"logger"),this.D=e,this.Ji=t.screenSharingExtensionId||("Chrome"!==u.browser?"":"icngjadgidcmifnehjcielbmiapkhjpn"),this.Ki=t.eagerlyCheckScreenSharingCapabilities||!1,this.Qi=!1,this.Xi=new i.Observable(!1),this.Ki?c.call(this,o.bind(a,this)):a.call(this,!1)}function a(t){this.Xi.setValue(!0),this.Qi=t}function c(e){var n=this;if("Chrome"===u.browser&&n.Ji){var i=h.call(this);if(!i)return e(!1);try{i.sendMessage(n.Ji,{type:"version"},function(t){i.lastError||!t||"ok"!==t.status?(n.D.info("Screen sharing NOT available"),e(!1)):(n.D.info("Screen sharing enabled using version [%s]",t.version),e(!0))})}catch(t){t.message&&n.D.warn(t.message,t),e(!1)}}else"Firefox"===u.browser&&u.browserVersion>=t||"Firefox"===u.browser&&o.h(u.global.PCastScreenSharing)?e(!0):e(!1)}function r(t){if(this.Xi.getValue())return t();var e=this.Xi.subscribe(function(){return e.dispose(),t()})}function s(r,s){switch(u.browser){case"Chrome":return function(e){var n=this,i=h.call(this);if(!i)return e(new Error("not-available"));try{i.sendMessage(n.Ji,{type:"get-desktop-media",sources:["screen","window","tab","audio"]},function(t){if(i.lastError||!t)return c.call(n,function(t){return a.call(n,t),e(new Error("extension-failure"))});"ok"!==t.status?e(new Error(t.status),t):e(null,t)})}catch(t){t.message&&n.D.warn(t.message),e(t,{status:"failed"})}}.call(this,function(t,e){if(t||e&&"ok"!==e.status)return s(t,e);var n,i;e.data||e.options||(e.options={canRequestAudioTrack:!0}),s(null,{status:"ok",constraints:(t=r,n=e.streamId,e=e.options,i={},o.h(t)&&o.h(t.screen)&&(i.video=t.screen),o.h(t)&&o.h(t.screenAudio)&&e.canRequestAudioTrack&&(i.audio=t.screenAudio),t.screen&&o.set(i,["video","mandatory"],{chromeMediaSource:"desktop",chromeMediaSourceId:n}),t.screenAudio&&e.canRequestAudioTrack&&o.set(i,["audio","mandatory"],{chromeMediaSource:"system",chromeMediaSourceId:n}),i)})});case"Firefox":s(null,{status:"ok",constraints:(t=r,e={video:{}},o.h(t)&&o.h(t.screen)&&(e.video=t.screen),e.video.mediaSource=e.video.mediaSource||"window",e)});break;default:s(new Error("not-supported"),{status:"not-supported"})}var t,e}function h(){return"Chrome"!==u.browser?null:"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime:(this.D.info("Screen sharing NOT available. Runtime not supported"),null)}return e.prototype.checkForScreenSharingCapability=function(e){return c.call(this,function(t){a.call(this,t),e(t)})},e.prototype.isScreenSharingEnabled=function(e){var n=this;return r.call(this,function(){if(n.Ki||n.Qi)return e(n.Qi);c.call(n,function(t){n.Qi=t,e(t)})})},e.prototype.getScreenSharingConstraints=function(t,e){return r.call(this,o.bind(s,this,t,e))},e.prototype.toString=function(){return"ScreenShareExtensionManager["+u.browser+"]"},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(3)],e=function(c,u,a){"use strict";function t(t,e,n){u.h(t,"logger"),u.h(e,"screenShareExtensionManager"),n&&u.g(n,"onScreenShare"),this.D=t,this.st=e,this.Ge=n}function n(n,e,i){function r(t){i(h(t),void 0,t)}function s(t){!function(n){var i={},r={},s=this;setTimeout(function t(){c.reduce(n.getTracks(),function(t,e){return t&&(u.T(t=e,"track"),"ended"===t.readyState)},!0)||(c.forEach(n.getTracks(),function(t){var e;a.global.Event&&c.hasIndexOrKey(i,t.id)&&i[t.id]!==t.enabled&&(((e=new a.global.Event("trackenabledchange")).data=t).dispatchEvent(e),s.D.info("[%s] Detected track [%s] enabled change to [%s]",n.id,t.id,t.enabled)),a.global.Event&&c.hasIndexOrKey(r,t.id)&&r[t.id]!==t.readyState&&(((e=new a.global.Event("readystatechange")).data=t).dispatchEvent(e),s.D.info("[%s] Detected track [%s] Ready State change to [%s]",n.id,t.id,t.readyState)),i[t.id]=t.enabled,r[t.id]=t.readyState}),setTimeout(t,2e3))},2e3)}.call(o,t),e("ok",t)}var o=this;return function(e,n){var i=this;if(e.screen)return i.st.isScreenSharingEnabled(function(t){return t?i.st.getScreenSharingConstraints(e,n):n(new Error("screen-sharing-not-available"))});var t={audio:e.audio||!1,video:e.video||!1};n(null,{status:"ok",constraints:t})}.call(this,n,function(t,e){if("ok"!==c.get(e,["status"]))return r(t);if("cancelled"===e.status)i("cancelled",null);else{t=e.constraints;if(o.Ge&&(n.screen||n.screenAudio)&&"Chrome"===a.browser&&!(t=o.Ge(t)))throw new Error("onScreenShare must return an object of user media constraints");try{a.getUserMedia(t,s,r)}catch(t){r(t)}}})}t.prototype.getUserMedia=function(t,e){u.h(t,"options"),u.g(e,"callback"),function(i,r){function s(t,e){a.Nt&&a.Nt.push(e),r(a,t,e)}function u(t,e,n){i.screenAudio&&a.D.warn("Screen capture with audio is only supported on Windows or Chrome OS."),r(a,t,e,n)}var a=this,t=i.screen||i.screenAudio,e=i.video||i.audio;return t&&e?n.call(a,{screen:i.screen},function(t,o){return n.call(a,{audio:i.audio,video:i.video},function(t,e){var n=e,i=o.getTracks();n&&c.g(n.addTrack)&&c.forEach(i,function(t){n.addTrack(t)}),s(t,e)},function(t,e,n){var i=o;if(i&&c.g(i.stop)&&i.stop(),i&&c.g(i.getTracks))for(var r=i.getTracks(),s=0;s<r.length;s++)r[s].stop();u(t,e,n)})},u):n.call(a,i,s,u)}.call(this,t,e)};var h=function(t){return"unavailable"===t.code?"conflict":"permission-denied"===t.message||"PermissionDeniedError"===t.name?"permission-denied":"InternalError"===t.name&&"Starting video failed"===t.message||"SourceUnavailableError"===t.name?"conflict":"SecurityError"===t.name&&"The operation is insecure."===t.message?"permission-denied":"failed"};return t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(12),n(79)],e=function(t,e,n,i){function r(){this.Zi={}}return r.prototype.createMetricsTransmitter=function(t){var e=n.getEnvironmentFromUrl(t||""),t=n.getTelemetryServerUri(t);return this.Zi[e]||(this.Zi[e]=function(t,e){e=new i(t,e);return t||e.setEnabled(!1),e}.call(this,t,e)),this.Zi[e]},new r}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(18),n(3),n(28)],e=function(o,u,n,i,r){function t(t,e){u.u(t,"uri"),this.Dn="object"==typeof location?location.hostname:i.browser+"-"+i.browserVersion+"-unknown",this.An=!0,this.Fn=(i.browser||"Browser")+"/"+(i.browserVersion||"?"),this.jn=new n.BatchHttpProto(t+"/metrics",[r],"telemetry.SubmitMetricRecords",{maxAttempts:3,maxBufferedRecords:1e3,maxBatchSize:512}),this._n=e,this.jn.on("capacity",o.bind(s,this))}function s(t){this.jn.addRecordToBeginning({metric:"MetricDropped",value:{uint64:t},timestamp:o.isoString(),sessionId:this.Ln,streamId:this.$i,source:this.Fn,fullQualifiedName:this.Dn,environment:this._n,version:this.Wn,runtime:this.Nn})}return t.prototype.isEnabled=function(){return this.An},t.prototype.setEnabled=function(t){u.k(t,"enabled"),this.An=t},t.prototype.submitMetric=function(t,e,n,i,r,s){this.An&&(u.R(t,"metric"),u.h(s,"value"),this.Nn=e,this.Ln=n,this.$i=i,this.Wn=r,function(t,e){e=o.assign({},e,{metric:t,timestamp:o.isoString(),sessionId:this.Ln,streamId:this.$i,source:this.Fn,fullQualifiedName:this.Dn,environment:this._n,version:this.Wn,runtime:this.Nn});this.jn.addRecord(e)}.call(this,t,s))},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2),n(3)],e=function(u,r,a,c){"use strict";var t=c.global.__phenixPageLoadTime||c.global.__pageLoadTime||u.now();function e(t,e,n){r.R(t,"sessionId"),this.W="2023-11-28T17:29:11Z",this.Pe=t,this.Yi={},this.D=e,this.Rt=n,this.tr=u.now(),this.H=new a.DisposableList,this.er=[],this.nr=[],this.ir=[],this.rr=null,h.call(this,"Stream initializing")}function h(){var t=Array.prototype.slice.call(arguments);if(0===t.length)throw new Error("Invalid logging arguments.");var e="[%s] [StreamTelemetry] [%s] "+t[0],t=t.slice(1),e=[e,this.$,u.now()-this.tr].concat(t);this.D.debug.apply(this.D,e)}function s(){return(u.now()-t)/1e3}function o(t,e){r.R(t.metric,"record.metric");var n=u.assign({},this.Yi,t);this.Rt.submitMetric(t.metric,e,this.Pe,this.$,this.W,n)}return e.prototype.setProperty=function(t,e){r.R(t,"name"),r.R(e,"value"),this.Yi[t]=e},e.prototype.recordMetric=function(t,e,n,i){r.R(t,"metric");t=u.assign({},{metric:t,elapsed:this.elapsed(),value:e,previousValue:n},i||{});o.call(this,t,s())},e.prototype.setStreamId=function(t){if(r.R(t,"streamId"),this.$)throw new Error("Stream ID can only be set once.");this.$=t;t=u.now();o.call(this,{metric:"Initialized",elapsed:this.elapsed()-t+this.tr},s()-(t-this.tr)/1e3)},e.prototype.setStartOffset=function(t){if(r.v(t,"startOffset"),this.sr)throw new Error("Start offset can only be set once.");this.sr=t,this.recordMetric("Offset",{uint64:t})},e.prototype.getStartOffset=function(){return this.sr},e.prototype.elapsed=function(){return u.now()-this.tr},e.prototype.stop=function(){this.H.dispose(),this.recordMetric("Stopped"),h.call(this,"Stream stopped")},e.prototype.recordTimeToFirstFrame=function(t){function e(){n.rr||(n.rr=u.now()-i,n.recordMetric("TimeToFirstFrame",{uint64:n.rr}),h.call(n,"First frame [%s]",n.rr),r.dispose())}var n=this,i=u.now(),r=(u.addEventListener(t,"loadeddata",e),u.addEventListener(t,"loadedmetadata",e),new a.Disposable(function(){u.removeEventListener(t,"loadeddata",e),u.removeEventListener(t,"loadedmetadata",e)}));return this.H.add(r),r},e.prototype.recordVideoResolutionChanges=function(t,e){var n=this,i={width:e.videoWidth,height:e.videoHeight};if(u.find(this.er,function(t){return t===e}))return new a.Disposable(u.noop);this.er.push(e);t=t.addVideoDisplayDimensionsChangedCallback(function(t,e){i.width===e.width&&i.height===e.height||(n.recordMetric("ResolutionChanged",{string:e.width+"x"+e.height},{string:i.width+"x"+i.height}),i={width:e.width,height:e.height},h.call(n,"Resolution changed: width [%s] height [%s]",e.width,e.height))});return this.H.add(t),t},e.prototype.recordRebuffering=function(i){var r,s,o=this;if(u.find(this.nr,function(t){return t===i}))return new a.Disposable(u.noop);function t(){r||(o.recordMetric("Stalled"),r=u.now(),h.call(o,"[buffering] Stream has stalled"))}function e(t){var e=i.buffered.length,n=!("playing"===t.type||0<e)||("progress"===t.type||"timeupdate"===t.type)&&i.buffered.end(e-1)===s;!r||!e&&"Edge"!==c.browser||n||("progress"===t.type&&(s=i.buffered.end(e-1)),n=u.now()-r,o.recordMetric("Buffering",{uint64:n}),h.call(o,"[buffering] Stream has recovered from stall after [%s] milliseconds",n),r=null)}this.nr.push(i),u.addEventListener(i,"stalled",t),u.addEventListener(i,"pause",t),u.addEventListener(i,"suspend",t),u.addEventListener(i,"play",e),u.addEventListener(i,"playing",e),u.addEventListener(i,"progress",e),u.addEventListener(i,"timeupdate",e);var n=new a.Disposable(function(){u.removeEventListener(i,"stalled",t),u.removeEventListener(i,"pause",t),u.removeEventListener(i,"suspend",t),u.removeEventListener(i,"play",e),u.removeEventListener(i,"playing",e),u.removeEventListener(i,"progress",e),u.removeEventListener(i,"timeupdate",e)});return this.H.add(n),n},e.prototype.recordVideoPlayingAndPausing=function(e){var t=this;if(u.find(this.ir,function(t){return t===e}))return new a.Disposable(u.noop);function n(){e.paused?t.recordMetric("Playing",{boolean:!1}):t.recordMetric("Playing",{boolean:!0})}this.ir.push(e),u.addEventListener(e,"pause",n),u.addEventListener(e,"playing",n);var i=new a.Disposable(function(){u.removeEventListener(e,"pause",n),u.removeEventListener(e,"playing",n)});return this.H.add(i),i},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(2),n(13),n(3),n(82)],e=function(r,s,n,i,o,u){"use strict";var t=o.global.__phenixPageLoadTime||o.global.__pageLoadTime||r.now();function e(t,e){this.W="2023-11-28T17:29:11Z",this.Pe=null,this.Yi={resource:"session",kind:"event"},this.D=t,this.Rt=e,this.ur=new u(this.D),this.tr=r.now(),this.H=new n.DisposableList,this.pi=[],this.H.add(i.onBackground(r.bind(a,this,!1))),this.H.add(i.onForeground(r.bind(a,this,!0))),this.ur.isSupported()&&(this.H.add(this.ur.onNetworkChange(r.bind(l,this))),this.H.add(this.ur),c.call(this),f.call(this),h.call(this))}function a(t,e){this.recordMetric(t?"ApplicationForeground":"ApplicationBackground",{uint64:e}),d.call(this,"Application has gone into the [%s] after [%s] ms",t?"foreground":"background",e)}function c(){var t=this.ur.getEffectiveType();this.recordMetric("NetworkType",{string:t},null,{resource:o.browser}),d.call(this,"[%s] has started with Network effective type of [%s]",this.Pe?"Session":"Application",t)}function h(t,e){var t=t||this.ur.getRoundTripTime(),n=e||-1;if(this.recordMetric("RoundTripTime",{uint32:t},{uint32:n},{resource:o.browser}),r.isNullOrUndefined(e))return d.call(this,"Network RTT [%s]",t);d.call(this,"Network RTT changed to [%s] from [%s]",t,n)}function f(t,e){var t=t||this.ur.getDownlinkThroughputCapacity(),n=e||-1;if(this.recordMetric("DownlinkThroughputCapacity",{float:t},{float:n},{resource:o.browser}),r.isNullOrUndefined(e))return d.call(this,"Network downlink throughput capacity [%s]",t);d.call(this,"Network downlink throughput capacity changed to [%s] from [%s]",t,n)}function l(t,e){e.downlinkThroughputCapacity!==t.downlinkThroughputCapacity&&f.call(this,t.downlinkThroughputCapacity,e.downlinkThroughputCapacity),e.rtt!==t.rtt&&h.call(this,t.rtt,e.rtt),e.effectiveType!==t.effectiveType&&function(t,e){t=t||this.ur.getEffectiveType();this.recordMetric("NetworkType",{string:t},{string:e},{resource:o.browser}),d.call(this,"Network effective type has changed to [%s] from [%s]",t,e||"New")}.call(this,t.effectiveType,e.effectiveType)}function d(){var t=Array.prototype.slice.call(arguments);if(0===t.length)throw new Error("Invalid logging arguments.");var e="[%s] [SessionTelemetry] [%s] "+t[0],t=t.slice(1),e=[e,this.Pe,r.now()-this.tr].concat(t);this.D.info.apply(this.D,e)}function p(){return(r.now()-t)/1e3}function m(t,e){if(s.R(t.metric,"record.metric"),!this.Pe)return this.pi.push({record:t,since:e});var n=r.assign({},this.Yi,t);this.Rt.submitMetric(t.metric,e,this.Pe,null,this.W,n)}return e.prototype.setSessionId=function(t){!t&&this.Pe&&m.call(this,{metric:"Stopped",elapsed:this.elapsed()},p()),(this.Pe=t)&&(m.call(this,{metric:"Initialized",elapsed:this.elapsed()},p()),function(){if(this.Pe)for(var t=this.pi.length;0<t;){var e=this.pi.splice(t-1,1);1===e.length&&m.call(this,e[0].record,e[0].since),t--}}.call(this),function(){var t=i.isForeground(),e=i.getTimeSinceLastChange();this.recordMetric(t?"ApplicationForeground":"ApplicationBackground",{uint64:e}),d.call(this,"Session has started in the [%s] after [%s] ms",t?"foreground":"background",e)}.call(this),this.ur.isSupported())&&(c.call(this),f.call(this),h.call(this))},e.prototype.setProperty=function(t,e){s.R(t,"name"),s.R(e,"value"),this.Yi[t]=e},e.prototype.recordMetric=function(t,e,n,i){s.R(t,"metric");t=r.assign({},{metric:t,elapsed:this.elapsed(),value:e,previousValue:n},i||{});m.call(this,t,p())},e.prototype.elapsed=function(){return r.now()-this.tr},e.prototype.dispose=function(){this.H.dispose(),this.recordMetric("Stopped"),d.call(this,"Session telemetry stopped")},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(2),n(3)],e=function(t,e,n,i,r){function s(t){if(e.h(t,"logger"),this.D=t,this.zt=new n.NamedEvents,this.H=new i.DisposableList,this.H.add(this.zt),!this.isSupported())return this.D.info("Network monitor is not supported.");this.ar=o.call(this),function(){var t=this;navigator.connection.addEventListener("change",function(){t.zt.fireAsync("NetworkChange",[o.call(t),t.ar]),t.ar=o.call(t)})}.call(this)}function o(){return{downlinkThroughputCapacity:this.getDownlinkThroughputCapacity(),effectiveType:this.getEffectiveType(),rtt:this.getRoundTripTime()}}return s.prototype.isSupported=function(){return r.global.navigator&&r.global.navigator.connection},s.prototype.getDownlinkThroughputCapacity=function(){return this.isSupported()?r.global.navigator.connection.downlink||r.global.navigator.connection.downlinkMax:-1},s.prototype.getEffectiveType=function(){return this.isSupported()?r.global.navigator.connection.effectiveType||r.global.navigator.connection.type:"Unknown"},s.prototype.getRoundTripTime=function(){return this.isSupported()?r.global.navigator.connection.rtt||r.global.navigator.connection.type:-1},s.prototype.onNetworkChange=function(t){if(this.isSupported())return e.g(t,"callback"),this.zt.listen("NetworkChange",t)},s.prototype.dispose=function(){this.H.dispose()},s}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(6)],e=function(r,s,o){"use strict";function u(t,e,n){s.R(t,"type"),s.h(e,"stream"),s.h(n,"logger"),this.K=t,this.Ri=e,this.D=n,this.cr=null;var i=this;this.Ri.on(o.streamEvents.playerEnded.name,function(t){if(i.D.info("[%s] [%s] player ended.",i.Ri.getStreamId(),i.K),i.hr=!0,i.cr)return i.cr();i.streamEndedCallback(u.getStreamEndedStatus(t),t)})}return u.prototype.toString=function(){return"Stream["+(this.Ri?this.Ri.getStreamId():"")+"]"},u.prototype.on=function(t,e){return this.Ri.on(t,e)},u.prototype.streamErrorCallback=function(t,e){r.g(this.Ri.streamErrorCallback)?(this.D.debug("[%s] [%s] stream error event [%s]",this.Ri.getStreamId(),this.K,e),this.Ri.streamErrorCallback(this.Ri,t,e)):this.D.error("[%s] [%s] stream error event [%s]",this.Ri.getStreamId(),this.K,e)},u.prototype.streamEndedCallback=function(t,e,n){var i=this.Ri.getRenderer();this.lr||(n&&!this.cr&&this.Ri.isActive()&&i&&!this.hr?(this.cr=r.bind(this.streamEndedCallback,this,t,e),this.D.info("[%s] [%s] stream ended. Waiting for end of player.",this.Ri.getStreamId(),this.K)):(this.lr=!0,r.g(this.Ri.streamEndedCallback)&&this.Ri.streamEndedCallback(this.Ri,t,e),this.Ri.stop(e)),i&&i.stop(e,n))},u.prototype.dataQualityChangedCallback=function(t,e){var n=this.Ri.getRenderer();n&&r.g(n.dataQualityChangedCallback)&&n.dataQualityChangedCallback(n,t,e)},u.prototype.getPhenixMediaStream=function(){return this.Ri},u.getStreamEndedStatus=function(t){switch(t){case"":case"none":case"ended":return"ended";case"server-error":case"session-error":case"not-ready":case"error":case"died":return"failed";case"censored":return"censored";case"maintenance":return"maintenance";case"capacity":return"capacity";case"app-background":return"app-background";case"egress-failed":return"egress-failed";case"egress-setup-failed":return"egress-setup-failed";case"overload":return"overload";default:return"custom"}},u}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(3),n(85),n(86),n(87),n(6)],e=function(i,n,a,r,t,s,o,u){"use strict";function e(t,e,n,i,r,s,o,u){this.K=t,this.$=e,this.J=n,this.dr=i,this.Ne=r,this.pr=s,this.mr=o,this.D=u,this.vr=[],this.gr=null,this.zt=new a.NamedEvents}return e.prototype.on=function(t,e){this.zt.listen(t,e)},e.prototype.createRenderer=function(){var e=null;switch(this.K){case u.types.dash.name:if(this.mr)e=new s(this.$,this.J,this.dr,this.Ne,this.mr,this.D);else if(this.pr){if(!this.pr.Player.isBrowserSupported())throw this.D.warn("[%s] Shaka does not support this browser",this.$),new Error("Shaka does not support this browser");e=new t(this.$,this.J,this.dr,this.Ne,this.pr,this.D)}break;case u.types.hls.name:e=new s(this.$,this.J,this.dr,this.Ne,this.mr,this.D);break;case u.types.rtmp.name:e=new o(this.$,this.J,this.dr,this.Ne,this.D);break;default:throw new Error("Unsupported Live stream Type "+this.K)}var n=this;return e.on(u.rendererEvents.error.name,function(t,e){n.zt.fire(u.streamEvents.playerError.name,[t,e])}),e.on(u.rendererEvents.ended.name,function(t){n.vr=i.filter(n.vr,function(t){return t!==e}),0===n.vr.length&&(n.dr.stop(),n.zt.fire(u.streamEvents.playerEnded.name,[t]))}),this.vr.push(e),e},e.prototype.select=function(t){return this.D.warn("[%s] selection of tracks not supported for [%s] live streams",this.$,this.K),this},e.prototype.setStreamEndedCallback=function(t){n.g(t,"callback"),this.streamEndedCallback=t},e.prototype.setStreamErrorCallback=function(t){n.g(t,"callback"),this.streamErrorCallback=t},e.prototype.stop=function(t){this.isActive()&&(this.D.info("[%s] stop [live] media stream with reason [%s]",this.$,t),this.zt.fire(u.streamEvents.stopped.name,[t]),this.yr=!0)},e.prototype.monitor=function(t,e){n.h(t,"options"),n.g(e,"callback")},e.prototype.getMonitor=function(){return null},e.prototype.addBitRateThreshold=function(t,e){n.g(e,"callback")},e.prototype.getStream=function(){return this.D.debug("[%s] [%s] This type of stream has no internal stream object",this.$,this.K),null},e.prototype.isActive=function(){return!this.yr},e.prototype.getStreamId=function(){return this.$},e.prototype.getStats=function(){return this.D.debug("[%s] [%s] This type of stream has no stats",this.$,this.K),null},e.prototype.getRenderer=function(){return i.get(this.vr,[0],null)},e.canPlaybackType=function(t){var e=!!r.global.MediaSource,n=e||"object"==typeof document&&"maybe"===document.createElement("video").canPlayType("application/vnd.apple.mpegURL");switch(t){case u.types.dash.name:return e;case u.types.hls.name:return n;case u.types.rtmp.name:return o.isSupported();default:return!1}},e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(8),n(2),n(11),n(3),n(6)],e=function(o,e,u,r,a,c,h,s){"use strict";var f=null;function t(t,e,n,i,r,s){this.D=s,this.$=t,this.wr=encodeURI(e).replace(/[#]/g,"%23"),this.dr=n,this.Ne=i,this._=null,this.Ai=null,this.gr=new c(s),this.br={time:0,buffered:null,averageLength:0,count:0},this.zt=new u.NamedEvents,this.H=new a.DisposableList,this.pr=r,this.kr=o.bind(d,this),this.Sr=o.bind(l,this),this.Rr=o.bind(p,this)}function l(){if(this.br.time=o.now(),0===this.Ai.buffered.length)return this.D.debug("[%s] Shaka live stream player progress event fired without any buffered content",this.$);var t,e=this.Ai.buffered.end(this.Ai.buffered.length-1);this.br.buffered!==e&&(null!==this.br.buffered&&(t=this.br.averageLength*this.br.count+(e-this.br.buffered),this.br.count+=1,this.br.averageLength=t/this.br.count),this.br.buffered=e)}function d(){var t=this;t.D.info("[%s] Loading Shaka live stream player stream stalled.",t.$),0!==t.br.time&&setTimeout(function(){o.now()-t.br.time>n.call(t)&&t.Er&&t.stop("ended")},n.call(t))}function n(){return 1.5*this.br.averageLength<2e3?2e3:1.5*this.br.averageLength}function p(){this.D.info("[%s] Shaka live stream player ended.",this.$)}return t.prototype.on=function(t,e){return this.zt.listen(t,e)},t.prototype.start=function(e){var n=this,t=(n.Ir=new this.pr.Player(e),this.H.add(this.dr.recordTimeToFirstFrame(e)),this.H.add(this.dr.recordRebuffering(e)),this.H.add(this.dr.recordVideoResolutionChanges(this,e)),{abr:{defaultBandwidthEstimate:2e6},manifest:{retryParameters:{timeout:1e4}},streaming:{rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,retryParameters:{timeout:1e4,maxAttempts:10,backoffFactor:1.1}}});function i(t){n.Ir.configure(t),!1===n.Ne.receiveAudio&&(e.muted=!0),o.addEventListener(n.Ir,"error",function(t){n.zt.fire(s.rendererEvents.error.name,["player",t])}),o.addEventListener(e,"stalled",n.kr,!1),o.addEventListener(e,"pause",n.kr,!1),o.addEventListener(e,"suspend",n.kr,!1),o.addEventListener(e,"progress",n.Sr,!1),o.addEventListener(e,"ended",n.Rr,!1),n.Ir.load(n.wr).then(function(){n.D.info("[%s] DASH live stream has been loaded",n.$),o.g(e.play)&&e.play()}).catch(function(t){n.D.error("[%s] Error while loading DASH live stream [%s]",n.$,t.code,t),n.zt.fire(s.rendererEvents.error.name,["shaka",t])}),n.Ne.capabilities.includes("audio-only")||n.gr.start(this,e),n.Ai=e}return this.Ne.isDrmProtectedContent?(function(){var t;if(!o.g(Uint8Array))throw this.D.error(t="Uint8Array support required for DRM"),new Error(t);if(!o.g(h.global.atob))throw this.D.error(t="rtc.global.atob support required for DRM"),new Error(t)}.call(n),function(s){var o=this;s.getNetworkingEngine().registerResponseFilter(function(t,e){if(t.toString()===o.pr.net.NetworkingEngine.RequestType.LICENSE.toString()){var t=new Uint8Array(e.data),t=String.fromCharCode.apply(null,t),t=JSON.parse(t),n=t.license,i=h.global.atob(n);e.data=new Uint8Array(i.length);for(var r=0;r<i.length;++r)e.data[r]=i.charCodeAt(r);t.trackRestrictions&&s.configure({restrictions:t.trackRestrictions})}})}.call(n,n.Ir),function(t,e,n){t.drm||(t.drm={}),t.drm.advanced||(t.drm.advanced={}),t.manifest||(t.manifest={}),t.manifest.dash||(t.manifest.dash={}),function(n,t,i){function e(t,e){t?i(t):(f=e.data,n.drm.advanced["com.widevine.alpha"]={serverCertificate:function(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}(e.data),persistentStateRequired:!0,distinctiveIdentifierRequired:!1},i(null,n))}n.manifest.dash.customScheme=function(t){if("com.phenixrts.widevine"===t.getAttribute("schemeIdUri")||"com.phenixp2p.widevine"===t.getAttribute("schemeIdUri"))return[{keySystem:"com.widevine.alpha",licenseServerUri:decodeURIComponent(t.getAttribute("widevineLicenseServerUrl"))}]},f?e(null,f):r.get(t.widevineServiceCertificateUrl,{mimeType:"text/plain; charset=x-user-defined"},e)}.call(this,t,e,n)}.call(n,t,n.Ne,function(t,e){if(t)throw n.D.error("Failed to add DRM configuration to shaka player",t),t;i(e)})):i(t),e},t.prototype.stop=function(t,e){var n,i=this;if(!i.Tr){if(e)return i.Er=!0;this.gr.stop(),this.H.dispose(),this.Ir&&(n=function(){i.Ai&&(o.removeEventListener(i.Ai,"stalled",i.kr,!1),o.removeEventListener(i.Ai,"pause",i.kr,!1),o.removeEventListener(i.Ai,"suspend",i.kr,!1),o.removeEventListener(i.Ai,"progress",i.Sr,!1),o.removeEventListener(i.Ai,"ended",i.Rr,!1),"Edge"===h.browser)&&(i.Ai.src=""),i.zt.fire(s.rendererEvents.ended.name,[""]),i.Ir=null,i.Ai=null},i.Ir.destroy().then(function(){i.D.info("[%s] Shaka live stream player has been destroyed",i.$)}).then(function(){n()}).catch(function(t){i.D.error("[%s] Error while destroying shaka live stream player [%s]",i.$,t.code,t),n(),i.zt.fire(s.rendererEvents.error.name,["shaka",t])}),i.Tr=!0)}},t.prototype.getStats=function(){var t,e,n;return this.Ir?(t=o.assign(this.Ir.getStats(),{currentTime:0,lag:0}),e=o.get(this.Ai,["currentTime"],0),n=(o.now()-this.Ne.originStartTime)/1e3,n=Math.max(0,n-e),this.Ai&&(t.currentTime=e,t.lag=n),0<t.estimatedBandwidth?t.networkState=s.networkStates.networkLoading.id:0<t.playTime?t.networkState=s.networkStates.networkIdle.id:t.video?t.networkState=s.networkStates.networkEmpty.id:t.networkState=s.networkStates.networkNoSource.id,t):{width:0,height:0,currentTime:0,lag:0,networkState:s.networkStates.networkNoSource.id}},t.prototype.setDataQualityChangedCallback=function(t){e.g(t,"callback"),this.dataQualityChangedCallback=t},t.prototype.getPlayer=function(){return this.Ir},t.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.gr.addVideoDisplayDimensionsChangedCallback(t,e)},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(9),n(5),n(8),n(2),n(11),n(3),n(6)],e=function(o,e,r,u,t,a,c,i,s){"use strict";var h=6e3,n=15e3;function f(t,e,n,i,r,s){this.D=s,this.$=t,this.wr=encodeURI(e).replace(/[#]/g,"%23"),this.dr=n,this.Ne=i,this.mr=r,this._=null,this.Ai=null,this.gr=new c(s),this.br={time:0,buffered:null,averageLength:0,count:0,lastCurrentTime:0,lastCurrentTimeOccurenceTimestamp:0},this.zt=new u.NamedEvents,this.H=new a.DisposableList,this.kr=o.bind(v,this),this.Sr=o.bind(m,this),this.Rr=o.bind(y,this)}function l(t){if(p.call(this)&&t&&(3===t.code||t.severity===this.mr.errors.severity.RECOVERABLE))return this.D.warn("Reloading unhealthy stream after error event [%s]",t),d.call(this);this.zt.fire(s.rendererEvents.error.name,["phenix-player",t])}function d(){p.call(this)&&(this.D.warn("Reloading unhealthy stream that was active for at least [%s] seconds",n/1e3),this.Mr=o.now(),function(){this.Ir.dispose(),this.Ir=null,this.start(this.Ai)}.call(this))}function p(){var t=!this.Mr||o.now()-this.Mr>n;return this.Ai&&!this.Er&&this.Ir&&0!==this.Ai.buffered.length&&t}function m(){if(this.br.time=o.now(),0===this.Ai.buffered.length)return this.D.debug("[%s] Phenix stream player progress event fired without any buffered content",this.$);var t,e,n=this.Ai.buffered.end(this.Ai.buffered.length-1);this.br.buffered!==n&&(null!==this.br.buffered&&(e=this.br.averageLength*this.br.count+(n-this.br.buffered),t=this.br.lastCurrentTime===this.Ai.currentTime,this.br.count+=1,this.br.averageLength=e/this.br.count,t||(this.br.lastCurrentTimeOccurenceTimestamp=o.now()),e=this.br.lastCurrentTimeOccurenceTimestamp&&o.now()-this.br.lastCurrentTimeOccurenceTimestamp>h,t)&&e&&this.Ai&&!this.Ai.paused&&p.call(this)&&(this.D.warn("Reloading stream after current time has not changed for [%s] seconds due to unregistered stall.",h/1e3),d.call(this)),this.br.buffered=n,this.br.lastCurrentTime=this.Ai.currentTime)}function v(t){var e,n=this;n.D.info("[%s] Loading Phenix Live stream player stalled caused by [%s] event.",n.$,t.type),0===n.br.time||n.Ai.paused||(e=n.Ai.currentTime,setTimeout(function(){o.now()-n.br.time>g.call(n)&&n.Er&&n.stop("ended")},g.call(n)),setTimeout(function(){n.Ai&&n.Ai.currentTime===e&&!n.Ai.paused&&p.call(n)&&(n.D.warn("Reloading stream after being stalled for [%s] seconds",h/1e3),d.call(n))},h))}function g(){return 1.5*this.br.averageLength<2e3?2e3:1.5*this.br.averageLength}function y(){this.D.info("[%s] Phenix stream player ended.",this.$)}return f.isSupported=function(){return this.mr&&this.mr.isSupported},f.prototype.on=function(t,e){return this.zt.listen(t,e)},f.prototype.start=function(t){i=(e=this.D).getAppenders(),n=new r.Logger,o.forEach(i,function(t){t instanceof r.ConsoleAppender&&(t=new r.ConsoleAppender).setThreshold(r.level.INFO),n.addAppender(t)}),n.setUserId(e.getUserId()),n.setEnvironment(e.getEnvironment()),n.setApplicationVersion(e.getApplicationVersion()),n.setObservableSessionId(e.getObservableSessionId());var e,n,i=n;return this.Cr=i,this.Ai=t,this.H.add(this.dr.recordTimeToFirstFrame(t)),this.H.add(this.dr.recordRebuffering(t)),this.H.add(this.dr.recordVideoResolutionChanges(this,t)),this.H.add(this.dr.recordVideoPlayingAndPausing(t)),function(){var t=o.assign({bandwidthToStartAt:3e6},this.Ne),t=(o.includes(this.wr,".mpd")&&this.Ne.isDrmProtectedContent&&(t.drm={"com.widevine.alpha":{serverCertificateUrl:this.Ne.widevineServiceCertificateUrl,mediaKeySystemConfiguration:{persistentState:"required"}},"com.microsoft.playready":{licenseServerUrl:this.Ne.playreadyLicenseUrl}}),new this.mr.WebPlayer(this.Cr,this.Ai,t));o.now()-this.Ne.originStartTime<6e3&&this.Ne.isDrmProtectedContent&&o.includes(this.wr,".m3u8")?setTimeout(o.bind(t.start,t,this.wr),6e3):t.start(this.wr),this.Ir=t,o.addEventListener(this.Ir,"error",o.bind(l,this))}.call(this),!1===this.Ne.receiveAudio&&(t.muted=!0),o.addEventListener(t,"stalled",this.kr,!1),o.addEventListener(t,"pause",this.kr,!1),o.addEventListener(t,"suspend",this.kr,!1),o.addEventListener(t,"progress",this.Sr,!1),o.addEventListener(t,"ended",this.Rr,!1),this.Ne.capabilities.includes("audio-only")||this.gr.start(this,t),t},f.prototype.stop=function(t,e){var n=this;if(!n.Tr){if(e)return n.Er=!0;if(this.gr.stop(),this.H.dispose(),this.Ir){e=function(){n.Ai&&(o.removeEventListener(n.Ai,"stalled",n.kr,!1),o.removeEventListener(n.Ai,"pause",n.kr,!1),o.removeEventListener(n.Ai,"suspend",n.kr,!1),o.removeEventListener(n.Ai,"progress",n.Sr,!1),o.removeEventListener(n.Ai,"ended",n.Rr,!1),"Edge"===i.browser)&&(n.Ai.src=""),n.zt.fire(s.rendererEvents.ended.name,[""]),n.Ir=null,n.Ai=null};n.Tr=!0;try{n.Ir.dispose(),n.D.info("[%s] Phenix stream has been destroyed",n.$),e()}catch(t){n.D.error("[%s] Error while destroying Phenix stream player [%s]",n.$,t.code,t),e(),n.zt.fire(s.rendererEvents.error.name,["phenix-player",t])}}}},f.prototype.getStats=function(){var t,e,n;return this.Ir?(e=(t=this.Ir.getStats()).currentTime||this.Ai.currentTime,n=(o.now()-this.Ne.originStartTime)/1e3,t.isNative&&"Hls"===t.deliveryType&&(t.currentTime=n-t.lag),t.isNative||(t.lag=Math.max(0,n-e)),0<t.estimatedBandwidth?t.networkState=s.networkStates.networkLoading.id:0<t.playTime?t.networkState=s.networkStates.networkIdle.id:t.video?t.networkState=s.networkStates.networkEmpty.id:t.networkState=s.networkStates.networkNoSource.id,t):{width:0,height:0,currentTime:0,lag:0,networkState:s.networkStates.networkNoSource.id}},f.prototype.setDataQualityChangedCallback=function(t){e.g(t,"callback"),this.dataQualityChangedCallback=t},f.prototype.getPlayer=function(){return this.Ir},f.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.gr.addVideoDisplayDimensionsChangedCallback(t,e)},f}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(9),n(5),n(8),n(2),n(11),n(3),n(6)],e=function(c,o,t,u,e,a,h,f,i){"use strict";var r=6e3,s=15e3,n="rtmp-flash-renderer-2019.2.18.swf",l={local:"https://local.phenixrts.com/public/rtmp/"+n,staging:"https://stg.phenixrts.com/public/rtmp/"+n,production:"https://phenixrts.com/public/rtmp/"+n};function d(t,e,n,i,r){o.h(i,"options"),i.env&&o.R(i.env,"options.env");var s=l[i.env||"production"];this.D=r,this.$=t,this.qr=c.map(e,function(t){return t.uri=encodeURI(t.uri).replace(/[#]/g,"%23"),t}),this.dr=n,this.Ne=i,this._=null,this.Pr=null,this.Or=null,this.zt=new u.NamedEvents,this.gr=new h(r),this.H=new a.DisposableList,this.kr=c.bind(v,this),this.Rr=c.bind(g,this),this.tn=c.bind(p,this),this.qi=i.swfSrc||s}function p(t){this.zt.fire(i.rendererEvents.error.name,["flash-player",t])}function m(){var t=!this.Mr||c.now()-this.Mr>s;return this.Or&&!this.Er&&this.Ir&&0!==this.Or.buffered.length&&t}function v(t){var e=this,n=(e.D.info("[%s] Loading flash player stalled caused by [%s] event.",e.$,t.type),e.Or.currentTime);setTimeout(function(){e.Or&&e.Or.currentTime===n&&!e.Or.paused&&m.call(e)&&(e.D.warn("Reloading stream after being stalled for [%s] seconds",r/1e3),function(){m.call(this)&&(this.D.warn("Reloading unhealthy stream that was active for at least [%s] seconds",s/1e3),this.Mr=c.now(),function(){this.Pr.destroy(),this.start(this.Ar)}.call(this))}.call(e))},r)}function g(){this.D.info("[%s] Flash player ended.",this.$)}d.isSupported=function(){var t=[10,0,0],e="Shockwave Flash",n=[0,0,0];if(!c.k(y)){if(c.get(f.global.navigator,["plugins",e])){var i=f.global.navigator.plugins[e].description;if(i&&c.get(f.global.navigator,["mimeTypes","application/x-shockwave-flash","enabledPlugin"],!1))for(var r=0,s=(n=i.replace(e,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".")).length;r<s;r++)n[r]=parseInt(n[r].match(/\d+/),10)}else if(f.global.ActiveXObject)try{var o,u,a=new f.global.ActiveXObject("ShockwaveFlash.ShockwaveFlash");a&&(o=a.GetVariable("$version")||"",u=c.get(o.split(" "),[1],n).split(","),n=[parseInt(u[0],10),parseInt(u[1],10),parseInt(u[2],10)])}catch(t){console.error(t)}y=n[0]>t[0]||n[0]===t[0]&&0<n[1]||n[0]===t[0]&&0===n[1]&&0<=n[2]}return y},d.prototype.on=function(t,e){return this.zt.listen(t,e)},d.prototype.start=function(t){var e={streamId:this.$,swfSrc:this.qi};return this.Ar=t,this.Pr=new f.PhenixFlashVideo(t,this.qr,e),this.Pr.hookUpEvents(),this.Or=this.Pr.getElement(),this.H.add(this.dr.recordTimeToFirstFrame(this.Ar)),this.H.add(this.dr.recordRebuffering(this.Ar)),this.H.add(this.dr.recordVideoResolutionChanges(this,this.Ar)),this.H.add(this.dr.recordVideoPlayingAndPausing(this.Ar)),this.Or&&this.Or.play(),c.addEventListener(this.Ar,"stalled",this.kr,!1),c.addEventListener(this.Ar,"pause",this.kr,!1),c.addEventListener(this.Ar,"suspend",this.kr,!1),c.addEventListener(this.Ar,"ended",this.Rr,!1),c.addEventListener(this.Ar,"error",this.tn,!1),t},d.prototype.stop=function(t){var e=this;if(this.H.dispose(),this.Pr){var n=function(){e.Or&&(c.removeEventListener(e.Ar,"stalled",e.kr,!1),c.removeEventListener(e.Ar,"pause",e.kr,!1),c.removeEventListener(e.Ar,"suspend",e.kr,!1),c.removeEventListener(e.Ar,"ended",e.Rr,!1),c.removeEventListener(e.Ar,"error",e.tn,!1)),e.Or=null,e.Ar=null,e.zt.fire(i.rendererEvents.ended.name,[t])};try{this.Pr.destroy(),this.Pr=null,n(),this.D.info("[%s] Flash player has been destroyed",this.$)}catch(t){e.D.error("[%s] Error while destroying Flash player [%s]",e.$,t.code,t),n(),e.zt.fire(i.rendererEvents.error.name,["flash-player",t])}}},d.prototype.getStats=function(){var t,e,n;return this.Or?(t={},e=this.Or.currentTime,n=(c.now()-this.Ne.originStartTime)/1e3,t.lag=Math.max(0,n-e),t.networkState=(0<t.estimatedBandwidth?i.networkStates.networkLoading:0<t.playTime?i.networkStates.networkIdle:t.video?i.networkStates.networkEmpty:i.networkStates.networkNoSource).id,t):{width:0,height:0,currentTime:0,lag:0,networkState:i.networkStates.networkNoSource.id}},d.prototype.setDataQualityChangedCallback=function(t){o.g(t,"callback"),this.dataQualityChangedCallback=t},d.prototype.getPlayer=function(){return this.Ir},d.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.gr.addVideoDisplayDimensionsChangedCallback(t,e)};var y=null;return d}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(2),n(13),n(3),n(20),n(30),n(32),n(89),n(6)],e=function(o,u,a,c,h,f,i,n,r,s,l){"use strict";function d(t,e,n,i,r,s){this.$=t,this.Ur=e,this.se=n,this.dr=i,this.Ne=r,this.D=s,this.vr=[],this.gr=null,this.zt=new a.NamedEvents,this.Dr=[],this.Fr=0,this.Nr=null,this.H=new c.DisposableList,this.It=0,this.jr=o.get(r,["iceConnectionTimeout"],12e3),this.H.add(h.onForeground(o.bind(p,this)));t=/(b=AS:([0-9]*)[\n\r]*)/gi.exec(n.remoteDescription);t&&3<=t.length&&(this.Fr=1e3*t[2]),o.addEventListener(n,"iceconnectionstatechange",o.bind(m,this))}function p(){var t;this.Nr&&(t=this.Nr,this.Nr=null,t())}function m(){var t=this,e=this.se.iceConnectionState;switch(e){case"checking":case"connecting":this.Lr||(this.Br=o.now(),this.Lr=setTimeout(function(){t.D.warn("[%s] Stream has not connected within [%s] ms",t.$,t.jr),t.zt.fire(l.streamEvents.playerError.name,["real-time",new Error("connection-timeout")])},t.jr));break;case"failed":this.Lr&&(clearTimeout(this.Lr),this.Lr=null),this.D.info("[%s] Stream has failed",t.$),this.zt.fire(l.streamEvents.playerError.name,["real-time",new Error("connection-failed")]);break;case"closed":case"disconnected":this.Lr&&t.D.warn("[%s] Stream closed before it was connected",t.$);break;case"connected":this.Lr&&(clearTimeout(this.Lr),this.Lr=null),this.It++,this.D.info("[%s] Ice Connection completed after [%s] ms for [%s] time",this.$,o.now()-this.Br,this.It),this.Br=null;break;default:this.D.info("[%s] Unsupported Ice Connection state [%s]",this.$,e)}}return d.prototype.on=function(t,e){this.zt.listen(t,e)},d.prototype.createRenderer=function(){var n=this,t=o.get(this.se,["remoteDescription","sdp"]),e=Object.assign({},this.Ne),i=((!t||this.Ne.capabilities.includes("audio-only"))&&this.Ne.capabilities.includes("video-only")||(t.includes("m=audio")||e.capabilities.push("video-only"),t.includes("m=video")||e.capabilities.push("audio-only"),t.split("m=").forEach(function(t){t.startsWith("audio")&&t.includes("a=inactive")&&e.capabilities.push("video-only"),t.startsWith("video")&&t.includes("a=inactive")&&e.capabilities.push("audio-only")})),new s(this.$,this.Ur,this.dr,e,this.D));return i.on(l.rendererEvents.error.name,function(t,e){n.zt.fire(l.streamEvents.playerError.name,[t,e])}),i.on(l.rendererEvents.ended.name,function(t){n.vr=o.filter(n.vr,function(t){return t!==i}),0===n.vr.length&&(n.dr.stop(),n.zt.fire(l.streamEvents.playerEnded.name,[t]))}),this.vr.push(i),i},d.prototype.select=function(t){u.g(t,"trackSelectCallback"),u.g(f.global.MediaStream,"rtc.global.MediaStream");for(var n,e,i=this.Ur.getTracks(),r=new f.global.MediaStream,s=0;s<i.length;s++)t(i[s],s)&&r.addTrack(i[s]);return 0===r.getTracks().length?this.D.warn("No tracks selected"):((e=new d((n=this).$,r,this.se,this.dr,this.Ne,this.D)).on(l.streamEvents.stopped.name,function(t){var e=n.Ur;o.reduce(e.getTracks(),function(t,e){return t&&(u.h(t=e,"track"),"ended"===t.readyState)},!0)&&n.zt.fire(l.streamEvents.stopped.name,[t])}),this.Dr.push(e),e)},d.prototype.setStreamEndedCallback=function(t){u.g(t,"callback"),this._r=t},d.prototype.setStreamErrorCallback=function(t){u.g(t,"callback"),this.Wr=t},d.prototype.streamEndedCallback=function(t,e,n){o.forEach(this.Dr,function(t){t.streamEndedCallback(e,n)}),o.g(this._r)&&this._r(this,e,n)},d.prototype.streamErrorCallback=function(t,e,n){o.forEach(this.Dr,function(t){t.streamErrorCallback(e,n)}),o.g(this.Wr)&&this.Wr(t,e,n)},d.prototype.stop=function(t){var e;this.isActive()&&(this.H.dispose(),(e=this.Ur)&&o.g(e.stop,"stream.stop")&&e.stop(),o.forEach(e&&e.getTracks?e.getTracks():[],function(t){t.stop()}),this.D.info("[%s] stop [real-time] media stream with reason [%s]",this.$,t),this.zt.fire(l.streamEvents.stopped.name,[t]),this.yr=!0)},d.prototype.monitor=function(t,i){u.h(t,"options"),u.g(i,"callback");var r=this,e=new n(r.$,r.se,r.D);return t.direction="inbound",e.start(t,function(){return r.isActive()},function t(e,n){return e&&r.D.warn("[%s] Media stream monitor triggered unrecoverable error [%s]",r.$,e),f.isIOS&&!h.isForeground()?(r.D.info("[%s] Media stream monitor triggered event while app is in the background. Waiting until foreground to trigger event.",r.$),r.Nr=t.bind(null,e,n)):(r.D.warn("[%s] Media stream triggered monitor condition for [%s] [%s]",r.$,n.type,n.reasons),i(r,"client-side-failure",n))}),this.ge=e},d.prototype.getMonitor=function(){return this.ge},d.prototype.addBitRateThreshold=function(t,e){var n=this;return new r("Media Stream",this.ge,function(){return n.Fr}).addThreshold(t,e)},d.prototype.getStream=function(){return this.Ur},d.prototype.isActive=function(){return!this.yr},d.prototype.getStreamId=function(){return this.$},d.prototype.getStats=function(e){u.g(e,"callback"),this._t||(this._t={});var n=this;return f.getStats(this.se,null,function(t){e(i.convertPeerConnectionStats(t,n._t))})},d.prototype.getRenderer=function(){return o.get(this.vr,[0],null)},d.prototype.toString=function(){return"PhenixRealTimeStream["+this.$+"]"},d}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(5),n(8),n(2),n(13),n(10),n(7),n(11),n(3),n(6)],e=function(s,e,o,t,u,a,c,h,f,r,l){"use strict";var i=1e3,d=200;function n(t,e,n,i,r){this.D=r,this.$=t,this.Ur=e,this.dr=n,this.Ne=i,this._=null,this.Ai=null,this.gr=new f(r),this.zt=new o.NamedEvents,this.H=new u.DisposableList,this.Fn=new c(s.get(h,["navigator","userAgent"],"")).detect(),this.Vr=!1,this.zr=0,this.Hr=0,this.H.add(a.onBackground(s.bind(v,this))),this.H.add(a.onForeground(s.bind(g,this))),this.Gr=s.bind(p,this),this.Rr=s.bind(m,this)}function p(t){var e=s.now()-this.zr<i;"pause"===t.type&&e&&(this.Vr=!0),this.Hr=s.now(),this.D.info("[%s] Loading Phenix Real-Time stream player stalling caused by [%s] event.",this.$,t.type)}function m(){this.D.info("[%s] Phenix Real-Time stream ended.",this.$)}function v(){var t,e;this.Ai&&(t=!1,e=s.now()-this.Hr<i,s.k(this.Ai.playing)?t=this.Ai.playing:s.k(this.Ai.paused)&&(t=!this.Ai.paused),this.Vr=t=!t&&e||t,this.zr=s.now())}function g(){var e,t,n;this.Ai&&((e=this).zr=0,this.Hr=0,this.Vr?(this.D.info("[%s] Resume playing after entering foreground [%s]",this.$,this.Fn.browser),"Safari"===this.Fn.browser&&r.isIOS&&(s.addEventListener(e.Ai,"pause",t=function(){e.D.info("Renderer was paused after entering foreground"),e.zt.fire(l.rendererEvents.failedToPlay.name,["paused-by-background"])}),n=setTimeout(function(){s.removeEventListener(e.Ai,"pause",t)},i),this.H.add(new u.Disposable(function(){clearTimeout(n)})),setTimeout(function(){e.Ai.play().catch(function(t){e.D.info("[%s] Unable to resume playback after entering foreground",e.$,t),e.Ai.src="",e.D.info("[%s] (Re)starting renderer",e.$),e.start(e.Ai)})},d))):this.D.info("[%s] Entering foreground with paused renderer [%s]",this.$,this.Fn.browser))}return n.prototype.on=function(t,e){if("userActionRequired"===t)throw new Error('"userActionRequired is no longer supported. See https://phenixrts.com/docs/web/#view-a-channel and https://phenixrts.com/docs/web/#channel-viewer');return this.zt.listen(t,e)},n.prototype.start=function(e){var n=this,i=!!s.find(this.Ur.getTracks(),function(t){return"audio"===t.kind});return this.Ne.canPlaybackAudio||(this.Ne.disableAudioIfNoOutputFound&&this.Ne.forcedAudioDisabled?this.D.warn("[%s] Missing audio playback device. Audio has been disabled on stream. Try setting up an audio device and re-subscribe in order to receive audio.",this.$):!this.Ne.disableAudioIfNoOutputFound&&i&&this.D.warn("[%s] Missing audio playback device. May experience audio and/or video failure. Try setting up an audio device OR pass the [disableAudioIfNoOutputFound] option when subscribing to disable audio playback when no devices are attached.",this.$)),this.Ai=r.attachMediaStream(e,this.Ur,function(t){if(t)return e.muted||!i?(n.D.warn("[%s] Failed to play muted stream.",n.$,t),n.zt.fire(l.rendererEvents.failedToPlay.name,["failed-to-play"])):n.Ne.disableAutoMuting?(n.D.warn("[%s] Failed to play unmuted stream.",n.$,t),n.zt.fire(l.rendererEvents.failedToPlay.name,["failed-to-play-unmuted"])):(n.D.debug("[%s] Failed to start playing stream. Auto muting the playback and trying again.",n.$),e.muted=!0,void(n.Ai=r.attachMediaStream(e,n.Ur,function(t){if(t)return n.D.warn("[%s] Failed to play even after auto muting.",n.$,t),e.muted=!1,n.zt.fire(l.rendererEvents.failedToPlay.name,["failed-to-play"]);n.D.info("[%s] Successfully started playing stream after auto muting. User may manually unmute with user triggered action.",n.$),n.zt.fire(l.rendererEvents.autoMuted.name,["retry-play-muted"])})));n.D.debug("[%s] Successfully started playing stream.",n.$)}),this.H.add(this.dr.recordTimeToFirstFrame(e)),this.H.add(this.dr.recordRebuffering(e)),this.H.add(this.dr.recordVideoResolutionChanges(this,e)),this.H.add(this.dr.recordVideoPlayingAndPausing(e)),!1===this.Ne.receiveAudio&&(e.muted=!0),s.addEventListener(e,"stalled",this.Gr,!1),s.addEventListener(e,"pause",this.Gr,!1),s.addEventListener(e,"suspend",this.Gr,!1),s.addEventListener(e,"ended",this.Rr,!1),this.Ne.capabilities.includes("audio-only")||this.gr.start(this,e),e},n.prototype.stop=function(t){this.gr.stop(),this.H.dispose(),this.Ai&&(s.removeEventListener(this.Ai,"stalled",this.Gr,!1),s.removeEventListener(this.Ai,"pause",this.Gr,!1),s.removeEventListener(this.Ai,"suspend",this.Gr,!1),s.removeEventListener(this.Ai,"ended",this.Rr,!1),s.g(this.Ai.pause)&&this.Ai.pause(),"Edge"===this.Fn.browser&&(this.Ai.src=""),this.Ai.src&&("IE"===this.Fn.browser?this.Ai.src=null:this.Ai.src=""),this.Ai.srcObject&&(this.Ai.srcObject=null),this.Ai=null),this.D.info("[%s] Phenix real-time renderer has been destroyed",this.$),this.zt.fire(l.rendererEvents.ended.name,[t])},n.prototype.getStats=function(){var t,e;return this.Ai?(t=(s.now()-this.Ne.originStartTime)/1e3,e=this.Ne.networkLag/1e3,{width:this.Ai.videoWidth||this.Ai.width,height:this.Ai.videoHeight||this.Ai.height,currentTime:t,lag:e,networkState:this.Ai.networkState}):{width:0,height:0,currentTime:0,lag:0,networkState:l.networkStates.networkNoSource.id}},n.prototype.setDataQualityChangedCallback=function(t){e.g(t,"callback"),this.dataQualityChangedCallback=t},n.prototype.addVideoDisplayDimensionsChangedCallback=function(t,e){return this.gr.addVideoDisplayDimensionsChangedCallback(t,e)},n}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(35)],e=function(n,t,r,c){"use strict";function e(t,e,n,i,r,s,o,u,a){this.init(t,e,n,i,r,s,o,u,a)}function s(){throw new Error("ImmutableRoom is Immutable")}function o(){throw new Error("Unable to subscribe to Immutable [ImmutableRoom]")}function h(t,e){n.isArray(t)?n.forEach(t,function(t){i(t,e)}):n.h(t)&&n.forOwn(t,function(t){n.includes(e,t)||i(t,e)})}function i(t,e){var n,i=e;((n=t)instanceof r.Observable||n instanceof r.ObservableArray)&&(n.setValue=s,n.subscribe=o,h(n.getValue(),i)),h(t,e)}return e.prototype.init=function(t,e,n,i,r,s,o,u,a){this.In=new c(t,e,n,i,r,s,o,u,a),h(this.In,[t])},e.prototype.getRoomId=function(){return this.In.getRoomId()},e.prototype.getObservableAlias=function(){return this.In.getObservableAlias()},e.prototype.getObservableName=function(){return this.In.getObservableName()},e.prototype.getObservableDescription=function(){return this.In.getObservableDescription()},e.prototype.getObservableType=function(){return this.In.getObservableType()},e.prototype.getObservableMembers=function(){return this.In.getObservableMembers()},e.prototype.getObservableBridgeId=function(){return this.In.getObservableBridgeId()},e.prototype.getObservablePin=function(){return this.In.getObservablePin()},e.prototype.toString=function(){return this.In.toString()},e.prototype.toJson=function(){return this.In.toJson()},e.prototype.commitChanges=s,e.prototype.reload=s,e.prototype.Y=s,e.prototype.Ie=s,e.prototype.Ee=s,e.prototype.Te=s,e}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(92)],e=function(s,e,n,i,r){"use strict";var o=100;function t(t){e.h(t,"roomService"),e.h(t.qe,"roomService._pcast"),this.Be=t,this.Jr=new n.ObservableArray([]),this.Kr=new n.Observable(null),this.H=new i.DisposableList,this.Qr=null,this.setPCast(t.qe)}function u(t){t&&this.Qr===t.getRoomId()||(c.call(this),t&&a.call(this))}function a(){c.call(this),this.Xr=function(t){var i=this.Be.getObservableActiveRoom().getValue().getRoomId(),r=(this.Qr=i,this);return this.Jr.setValue([]),this.Zr.subscribeAndLoadMessages(i,t,function(t,e){if(t)throw t;if("ok"!==e.status)throw new Error("Unable to subscribe to room chat. Status ["+e.status+"]");var n=r.Jr.getValue();s.forEach(e.chatMessages,function(t){for(var e=n.length;0<e&&t.messageId<s.get(n,[e-1,"messageId"]);)e--;0===e&&0<n.length?r.D.info("[%] Ignoring message [%s]/[%s] prior to current chat history to prevent gaps.",i,t.messageId,t.timestamp):0<e&&s.get(n,[e-1,"messageId"])===t.messageId?r.D.info("[%] Ignoring duplicate message [%s]/[%s]",i,t.messageId,t.timestamp):(n.splice(e,0,t),r.Kr.setValue(t))}),n.length>o&&n.splice(0,n.length-o),r.Jr.setValue(n)})}.call(this,this.$r)}function c(){this.Xr&&this.Xr.dispose&&this.Xr.dispose()}return t.prototype.setPCast=function(t){e.h(t,"pcast"),e.g(t.getLogger,"pcast.getLogger"),this.qe=t,this.D=t.getLogger(),this.Zr?this.Zr.setPCast(t):this.Zr=new r(t)},t.prototype.getBatchSize=function(){return this.$r},t.prototype.start=function(t){this.$r=t||0,this.Zr.start(),function(){var t=this.Be.getObservableActiveRoom().subscribe(s.bind(u,this));this.H.add(t)}.call(this),a.call(this)},t.prototype.stop=function(){this.Zr.stop(),c.call(this),this.H&&this.H.dispose()},t.prototype.getObservableChatMessages=function(){return this.Jr},t.prototype.getObservableLastChatMessage=function(){return this.Kr},t.prototype.getObservableChatEnabled=function(){return this.Zr.getObservableChatEnabled()},t.prototype.canSendMessage=function(){return this.Zr.canSendMessage()},t.prototype.sendMessageToRoom=function(t,e){var n,i,r,s=this.Be.getObservableActiveRoom().getValue();return s?(s=s.getRoomId(),(r=this.Be.we.getValue())?(n=r.getObservableScreenName().getValue(),i=r.getObservableRole().getValue(),r=r.getLastUpdate(),void this.Zr.sendMessageToRoom(s,n,i,r,t,e)):e(new Error("No record for oneself"),null)):e(new Error("Not in room"),null)},t.prototype.getMessages=function(t,e,n,i){var r=this.Be.getObservableActiveRoom().getValue().getRoomId();return this.Zr.getMessages(r,t,e,n,i)},t.prototype.toString=function(){return"RoomChatService"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(34)],e=function(e,u,n,r,i){"use strict";function t(t){u.h(t,"pcast"),u.g(t.getLogger,"pcast.getLogger"),u.g(t.getProtocol,"pcast.getProtocol"),this.qe=t,this.D=t.getLogger(),this.Tt=t.getProtocol(),this.bi=new n.Observable(!1),u.h(this.D,"this._logger"),u.h(this.Tt,"this._protocol"),this.Re=new i(t)}function s(t){var e;u.h(t,"event"),u.R(t.roomId,"event.roomId"),u.R(t.eventType,"event.eventType"),u.isArray(t.chatMessages,"event.chatMessages"),"Message"===t.eventType?(this.D.debug("[%s] Room messages [%s]",t.roomId,t.chatMessages),e=this.Yr[t.roomId],c(t.chatMessages),e&&e(null,{status:"ok",chatMessages:t.chatMessages})):this.D.warn("Unsupported room conversation event [%s]",t.eventType)}function o(t){}function a(){if(!this.bi.getValue())throw new Error("ChatService not Enabled. Please start before performing actions.")}function c(t){e.forEach(t,function(t){t.timestamp&&(t.timestamp=e.utc(t.timestamp)),t.from&&(t.from.lastUpdate=e.utc(t.from.lastUpdate))})}return t.prototype.setPCast=function(t){u.h(t,"pcast"),u.g(t.getLogger,"pcast.getLogger"),u.g(t.getProtocol,"pcast.getProtocol"),this.qe=t,this.D=t.getLogger(),this.Tt=t.getProtocol(),this.Re.setPCast(t)},t.prototype.start=function(){var t;this.bi.getValue()||(this.H=new r.DisposableList,this.Yr={},this.bi.setValue(!0),function(){var t=this.Re.getObservableStatus().subscribe(e.bind(o,this));this.H.add(t)}.call(this),t=this.Tt.onEvent("chat.RoomConversationEvent",e.bind(s,this)),this.H.add(t))},t.prototype.stop=function(){this.bi.getValue()&&(this.bi.setValue(!1),this.H)&&this.H.dispose()},t.prototype.getObservableChatEnabled=function(){return this.bi},t.prototype.canSendMessage=function(){return this.Re.checkAuthorized()},t.prototype.sendMessageToRoom=function(t,e,n,i,r,s){!function(t,e,n,i,r,s){u.R(t,"roomId"),u.R(e,"screenName"),u.R(n,"role"),u.v(i,"lastUpdate"),u.R(r,"message"),u.g(s,"callback"),a.call(this),this.Re.assertAuthorized();var n={messageId:"",timestamp:0,from:{sessionId:this.Re.getPCastSessionId(),screenName:e,role:n,lastUpdate:i},message:r},o=(this.D.info("Send message to room [%s] from [%s]",t,e),this);return this.Tt.sendMessageToRoom(t,n,function(t,e){if(t)return o.D.error("Send message to room failed with error [%s]",t),s(t,null);t={status:e.status};"ok"!==e.status&&o.D.warn("Send message to room failed with status [%s]",e.status),s(null,t)})}.call(this,t,e,n,i,r,s)},t.prototype.subscribeAndLoadMessages=function(t,e,n){n=function(t,e){var n=this,i=(this.Yr[t]=e,new r.Disposable(function(){n.Yr[t]===e&&delete n.Yr[t]}));return this.H.add(i),i}.call(this,t,n);return function(i,t){u.R(i,"roomId"),u.v(t,"batchSize"),a.call(this),this.Re.assertAuthorized();var e=this.Re.getPCastSessionId(),r=(this.D.info("Subscribe to room [%s] conversation with batch size of [%s]",i,t),this);this.Tt.subscribeToRoomConversation(e,i,t,function(t,e){var n=r.Yr[i];return n?t?(r.D.error("Subscribe to room conversation failed with error [%s]",t),n(t,null)):(t={status:e.status},"ok"!==e.status?(delete r.Yr[i],r.D.warn("Subscribe to room conversation failed with status [%s]",e.status),n(null,t)):(t.chatMessages=e.chatMessages,c(t.chatMessages),void n(null,t))):r.D.warn("No subscription callback set for room [%s]",i)})}.call(this,t,e),n},t.prototype.getMessages=function(t,e,n,i,r){!function(t,e,n,i,r){u.R(t,"roomId"),u.g(r,"callback"),i&&n||u.v(e,"batchSize"),i&&u.R(i,"beforeMessageId"),n&&u.R(n,"afterMessageId"),a.call(this),this.Re.assertAuthorized();var s=this.Re.getPCastSessionId(),o=(this.D.info("Get messages from room [%s] conversation with batch size of [%s], after [%s], and before [%s]",t,e,n,i),this);this.Tt.getMessages(s,t,e,n,i,function(t,e){return t?(o.D.error("Get messages from room conversation failed with error [%s]",t),r(t,null)):(t={status:e.status},"ok"!==e.status?(o.D.warn("Get messages from room conversation failed with status [%s]",e.status),r(null,t)):(t.chatMessages=e.chatMessages,c(t.chatMessages),void r(null,t)))})}.call(this,t,e,n,i,r)},t.prototype.toString=function(){return"ChatService"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(17),n(19),n(29),n(94),n(96)],e=function(n,i,r,s,o,u,a){"use strict";function t(t,e){i.isArray(t,"userMediaStreams"),this.V=(e=e||{}).uri||s.DefaultPCastUri,this.D=e.logger||r.createPCastLogger(this.V),this.ie=e.audioContext||new o,this.ts=this.ie.getNativeAudioContext(),this.es=null,this.ns=t,this.rs=!n.h(e.audioContext),this.ss=new u(this.D),n.forEach(this.ns,n.bind(c,this,e))}function c(t,e){i.h(e,"stream"),i.h(t,"options");var n=this.ss.getAudioVolumeMeter(e);n.init(this.ts,t.alpha),n.connect(e)}function h(t,e){i.h(e,"stream"),i.h(t,"options");var e=this.ss.getAudioVolumeMeter(e),n=new a(this.D);t.alpha&&e.setAlpha(t.alpha),n.onValue(this.es),n.startDetection(e,t)}return t.prototype.start=function(t,e){i.g(e,"callback"),this.es=e,n.forEach(this.ns,n.bind(h,this,t=t||{}))},t.prototype.stop=function(){n.forEach(this.getAudioVolumeMeters(),function(t){t.onValue(function(){})}),this.es=null},t.prototype.getAudioVolumeMeter=function(t){return i.h(t,"stream"),this.ss.getAudioVolumeMeter(t)},t.prototype.getAudioVolumeMeters=function(){return this.ss.getAudioVolumeMeters()},t.prototype.dispose=function(){this.rs&&this.ts.close(),this.ss.stopAllMeters(),this.ns=null},t.prototype.toString=function(){return"AudioSpeakerDetector"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(95)],e=function(t,e,n){"use strict";function i(t){e.h(t,"logger"),this.D=t,this.os={}}return i.prototype.stopAllMeters=function(){t.forOwn(this.os,function(t){t.stop()})},i.prototype.getAudioVolumeMeter=function(t){return e.h(t,"stream"),e.R(t.id,"streamId"),this.os[t.id]||(this.os[t.id]=new n(this.D)),this.os[t.id]},i.prototype.getAudioVolumeMeters=function(){return t.values(this.os)},i.prototype.toString=function(){return"AudioVolumeMeterFactory"},i}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(s,n){"use strict";function t(t){n.h(t,"logger"),this.D=t}function i(t){for(var e=t.inputBuffer.getChannelData(0),n=0,i=0,r=0;r<e.length;r++)n+=e[r]*e[r],.99<Math.abs(e[r])&&i++;this.us=Math.sqrt(n/e.length),this.cs=this.hs*this.us+(1-this.hs)*this.cs,this.fs=Math.max(this.us,this.hs*this.us+(1-this.hs)*this.fs),this.ls=i,this.ds&&this.ds.call(this,{date:s.now(),value:this.us,smoothedValue:this.cs,smoothedPeakValue:this.fs,clipped:this.ls})}return t.prototype.init=function(t,e){n.h(t,"context"),n.g(t.createScriptProcessor,"context.createScriptProcessor"),e=parseFloat(e||1/16),n.v(e,"alpha"),this.ps=t,this.hs=e,this.us=0,this.cs=0,this.fs=0,this.ls=0,this.vs=t.createScriptProcessor(4096,1,1),s.addEventListener(this.vs,"audioprocess",s.bind(i,this))},t.prototype.onValue=function(t){this.ds=t},t.prototype.getValue=function(){return this.us},t.prototype.getSmoothedValue=function(){return this.cs},t.prototype.getSmoothedPeakValue=function(){return this.fs},t.prototype.setAlpha=function(t){n.v(t,"alpha"),this.hs=parseFloat(t)},t.prototype.connect=function(t){return function(t){n.h(t,"stream"),0<t.getAudioTracks().length?(this.gs=this.ps.createMediaStreamSource(t),this.gs.connect(this.vs),this.vs.connect(this.ps.destination)):this.D.info("Stream has no audio tracks")}.call(this,t)},t.prototype.stop=function(){return function(){this.gs&&this.gs.disconnect(),this.vs.disconnect()}.call(this)},t.prototype.toString=function(){return"AudioVolumeMeter"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(l,d){"use strict";function t(t){d.h(t,"logger"),this.D=t,this.init()}return t.prototype.init=function(){},t.prototype.onValue=function(t){this.ds=t},t.prototype.startDetection=function(t,e){return function(s,t){d.h(s,"audioVolumeMeter");var o=this,u=(t=t||{}).speakingHysteresisInterval||50,a=t.silenceHysteresisInterval||1500,c=(d.v(u,"options.speakingHysteresisInterval"),d.v(a,"options.silenceHysteresisInterval"),!1),h=l.now()+u,f=l.now()+a;s.onValue(function(t){d.h(s,"audioVolumeMeter"),d.v(t.date,"value.date"),d.v(t.value,"value.value"),d.v(t.smoothedValue,"value.smoothedValue"),d.v(t.smoothedPeakValue,"value.smoothedPeakValue"),d.v(t.clipped,"value.clipped");var e=.01<t.value&&t.value>2*t.smoothedValue&&t.value>.25*t.smoothedPeakValue,n=t.value>.8*t.smoothedValue,i=t.value<.5*t.smoothedValue,r=!e;(e||c&&n)&&h<t.date?(f=l.utc(t.date)+a,c||(c=!0,o.D.info("Speaking detected"),o.ds&&o.ds("speaking"))):(i||!c&&r)&&f<t.date&&(h=l.utc(t.date)+u,c)&&(c=!1,o.D.info("Silence detected"),o.ds)&&o.ds("silence")})}.call(this,t,e)},t.prototype.toString=function(){return"AudioSpeakerDetection"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(17),n(19),n(98)],e=function(n,i,r,s,o){"use strict";function t(t,e){i.isArray(t,"userMediaStreams"),this.V=(e=e||{}).uri||s.DefaultPCastUri,this.D=e.logger||r.createPCastLogger(this.V),this.ys=[],this.xt=t}function u(t,e,n){n=new o(n);n.connect(t,e),this.ys.push(n)}return t.prototype.start=function(t,e){n.forEach(this.xt,n.bind(u,this,t,e=e||{}))},t.prototype.stop=function(){n.forEach(this.ys,function(t){t.close()}),this.ys=[]},t.prototype.toString=function(){return"BandwidthMonitor"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(n,i){"use strict";function t(t){this.init(t)}function r(t,e){if(this.ws&&this.ws.dispose(),!e)return this.bs.limitBandwidth(t);e=e.getObservableMembers();this.ws=e.subscribe(n.bind(s,this,t),{initial:"notify"})}function s(t,e){e.length!==this.ks&&(this.ks=e.length,e=t/Math.max(1,this.ks-1),this.bs.limitBandwidth(e))}return t.prototype.init=function(t){i.h(t,"publisher"),this.bs=t,this.ks=0,this.Ss=null,this.ws=null},t.prototype.connect=function(t,e){i.h(t,"roomService"),e=e||{};t=t.getObservableActiveRoom(),e=e.roomBandwidthLimit||5e6;this.Ss=t.subscribe(n.bind(r,this,e),{initial:"notify"})},t.prototype.close=function(){this.Ss&&this.Ss.dispose(),this.ws&&this.ws.dispose(),this.Ss=null,this.ws=null},t.prototype.toString=function(){return"PublisherBandwidthAdjuster"},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1)],e=function(f,i){"use strict";var l=[{"9x16":[{3840:2160},{1920:1080},{1366:768},{1280:720},{1024:576},{854:480},{640:360},{320:180}]},{"3x4":[{1600:1200},{1440:1080},{960:720},{800:600},{768:576},{640:480},{480:360},{352:288},{320:240},{176:144},{160:120}]},{"16x9":[{2160:3840},{1080:1920},{768:1366},{720:1280},{576:1024},{480:854},{360:640},{180:320}]},{"4x3":[{1200:1600},{1080:1440},{720:960},{600:800},{576:768},{480:640},{360:480},{288:352},{240:320},{144:176},{120:160}]}],r={fallbackToLower:{id:0,name:"fallbackToLower"},fallbackToHigher:{id:1,name:"fallbackToHigher"},fallbackToLowerThenHigher:{id:2,name:"fallbackToLowerThenHigher"},exact:{id:3,name:"exact"}};function t(t){i.h(t,"options"),t.resolutionSelectionStrategy&&i.M(t.resolutionSelectionStrategy,r,"options.resolutionSelectionStrategy"),t.aspectRatio&&i.R(t.aspectRatio,"options.aspectRatio"),t.resolution&&i.v(t.resolution,"options.resolution"),t.frameRate&&i.v(t.frameRate,"options.frameRate"),this.Rs=t.resolutionSelectionStrategy||r.fallbackToLowerThenHigher.name,this.Je=t.aspectRatio||"16x9",this.Es=parseInt(t.resolution,10)||720,this.Is=function(t,e){switch(i.R(t,"aspectRatio"),i.v(e,"resolution"),t){case"16x9":case"4x3":return e;case"9x16":return n(16/9*e);case"3x4":return n(4/3*e);default:throw new Error("Aspect Ratio not supported")}}.call(this,this.Je,this.Es),this.Ts=t.frameRate||15}function n(t){return i.v(t,"value"),2*Math.floor((t+1)/2)}function s(t,e){var n,i,r,s,o=d(e,l),e=p(e,l),u=p(t.toString(),o),a=0===u,c=l.length-1===e;if(u<0){if((u=h(t,o))<0)return null}else{if(a)return c||(i=d(n=m(++e,l),l),(u=h(this.Is,i))<0)?null:(r=m(u,o),s=this.calculateLongerDimensionByAspectRatio(r,n),{resolution:Math.min(r,s),aspectRatio:n,height:parseInt(r,10),width:parseInt(s,10)});u--}return n=m(e,l),r=m(u,i=v(e,l)),s=i[u][r],{resolution:Math.min(r,s),aspectRatio:n,height:parseInt(r,10),width:s}}function o(t,e){var n,i,r,s,o,u=d(e,l),e=p(e,l),a=p(t.toString(),u),c=a===u.length-1,h=l.length-1===e;if(f.v(a)){if(c)return h?null:(n=m(++e,l),i=this.Is,r=this.calculateLongerDimensionByAspectRatio(i,n),{resolution:Math.min(i,r),aspectRatio:n,height:parseInt(i,10),width:parseInt(r,10)});a++}else if(s=t,o=u,!(a=f.keys(o[o.length-1])[0]>s?null:f.reduce(o,function(t,e,n){var i;return t&&(i=f.keys(o[t])[0],e=f.keys(e)[0],s<e||!(Math.abs(s-e)<Math.abs(s-i)))?t:n})))return;return n=m(e,l),i=m(a,c=v(e,l)),r=c[a][i],{resolution:Math.min(i,r),aspectRatio:n,height:parseInt(i,10),width:parseInt(r,10)}}function d(e,t){t=f.find(t,function(t){return Object.prototype.hasOwnProperty.call(t,e)});return t?t[e]:null}function p(e,t){return f.findIndex(t,function(t){return Object.prototype.hasOwnProperty.call(t,e)})}function m(t,e){return f.keys(e[t])[0]}function v(t,e){var n=f.keys(e[t]);return e[t][n[0]]}function h(r,s){return f.keys(s[0])[0]<r?-1:f.reduce(s,function(t,e,n){var i;return t&&(i=f.keys(s[t])[0],(e=f.keys(e)[0])<r||!(Math.abs(r-e)<Math.abs(r-i)))?t:n})}return t.prototype.getDefaultResolution=function(){var t=this.calculateLongerDimensionByAspectRatio(this.Es,this.Je);switch(this.Je){case"9x16":case"3x4":return{resolution:this.Es,aspectRatio:this.Je,height:t,width:this.Es};default:return{resolution:this.Es,aspectRatio:this.Je,height:this.Es,width:t}}},t.prototype.getDefaultFrameRate=function(){return this.Ts},t.prototype.getNextResolution=function(t,e){switch(i.v(t,"height"),i.R(e,"aspectRatio"),this.Rs){case r.fallbackToLower.name:return o.call(this,t,e);case r.fallbackToHigher.name:return s.call(this,t,e);case r.fallbackToLowerThenHigher.name:var n=null;return t>this.Is?n=s.call(this,t,e):(n=o.call(this,t,e))&&n.height||(n=s.call(this,this.Es,this.Je)),n;default:return void r.exact.name}},t.prototype.canResolveNextResolution=function(){return this.Rs!==r.exact.name},t.prototype.calculateLongerDimensionByAspectRatio=function(t,e){switch(e){case"16x9":case"9x16":return n(16/9*t);case"4x3":case"3x4":return n(4/3*t);default:throw new Error("Aspect Ratio not supported")}},t}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){e=function(){"use strict";return{errorSeverity:{recoverable:{id:1,name:"RECOVERABLE"},critical:{id:2,name:"CRITICAL"}}}}.apply(e,[]);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(4),n(2),n(40),n(102),n(42),n(41),n(21),n(15),n(14),n(22)],e=function(y,i,t,e,n,r,s,o,u,w,b,a){"use strict";var c={reconnectOptions:{maxOfflineTime:864e5,maxReconnectFrequency:6e4}};function h(t){i.h(t,"options"),t.roomExpress&&i.h(t.roomExpress,"options.roomExpress"),this.Ms=y.assign(y.clone(c),t),this.Cs=t.roomExpress||new n(this.Ms),this.qs=!t.roomExpress,this.D=this.Cs.getPCastExpress().getPCast().getLogger()}function k(t,e,n){n&&y.hasIndexOrKey(n,"roomService")&&(n.channelService=n.roomService?new r(n.roomService):null,delete n.roomService),n&&y.hasIndexOrKey(n,"room")&&(n.channel=n.room?new s(n.room):null,delete n.room),t(e,n)}return h.prototype.dispose=function(){this.sn&&(this.sn.dispose(),this.sn=null),this.qs&&this.Cs.dispose(),this.D.info("Disposed channel express instance")},h.prototype.getRoomExpress=function(){return this.Cs},h.prototype.getPCastExpress=function(){return this.Cs.getPCastExpress()},h.prototype.joinChannel=function(a,s,c){if(i.h(a,"options"),i.g(s,"joinChannelCallback"),i.g(c,"subscriberCallback"),"capabilities"in a)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if("channelId"in a)throw new Error('"options.channelId" is no longer supported. Please use "options.token" instead.');if("alias"in a)throw new Error('"options.alias" is no longer supported. Please use "options.token" instead.');a.videoElement&&i.h(a.videoElement,"options.videoElement"),a.streamSelectionStrategy&&i.R(a.streamSelectionStrategy,"options.streamSelectionStrategy");function h(){null!==g&&(v.D.info("[%s] Clearing member selection backoff interval",m),clearTimeout(g),g=null);for(var t=0;t<r.length;t++)r[t].dispose();r=[]}var f,l,d,t=y.assign({type:w.types.channel.name,role:b.roles.audience.name},a),e=y.get(a,["failureCountForBanningAMember"]),n=y.get(a,["banMemberOnCapacityFailureCount"]),p=new o(a.streamSelectionStrategy,this.D,{failureCountForBanningAMember:e,banMemberOnCapacityFailureCount:n}),r=[],m="",v=this,g=null;v.Cs.joinRoom(t,function(t,e){var n,i,r=!e||y.assign({},e);v.sn&&(v.sn.dispose(),v.sn=null),e&&e.roomService&&(n=e.roomService.leaveRoom,i=e.roomService.getObservableActiveRoom().getValue(),d=e.roomService,m=i?i.getRoomId():"",v.D.info("Joined channel [%s] with [%s] selection strategy",m,p.getStrategy()),r.roomService.leaveRoom=function(t){f&&f.stop("leave-channel"),h(),n(t)}),k(s,t,r)},function i(o,u){h(),v.D.info("[%s] Members changed with status [%s]. Channel has [%s] active members.",m,u,o.length);for(var t=function(){var t=y.filter(o,function(t){return t.getObservableRole().getValue()===b.roles.presenter.name&&0<t.getObservableStreams().getValue().length}),e=p.getNext(t),e=e?e.getObservableStreams().getValue()[0]:null,n=e?e.getPCastStreamId():"";if(!e)return 0===t.length?(p.reset(),c(l=f=null,{status:"no-stream-playing"})):u?(v.D.info("Unable to find a new presenter to replace stream [%s] that ended in channel [%s] with status [%s] and [%s] black-listed members",l,m,u,p.getNumberOfMembersWithFailures()),l&&f&&f.isActive()&&f.stop("presenter-failure"),c(null,{status:u||"unable-to-recover"})):c(null,{status:"no-stream-playing"});if(!n)return v.D.info("Channel [%s] presenter has no stream",m),c(null,{status:"no-stream-playing"});if(l&&f)if(n===l){if(!u)return;v.D.info("[%s] Stream [%s] ended with status [%s], retrying",m,l,u),f.stop("same-presenter-failure")}else v.D.info("[%s] Stream [%s] ended with status [%s], failing over to stream [%s]",m,l,u,n),f.stop("change-presenter");function r(e){return null!==g&&(v.D.warn("[%s] Clearing backoff interval after triggering of another unexpected failure [%s]",m,e),clearTimeout(g),g=null),g=setTimeout(function(){g=null;var t=d?d.getObservableActiveRoom().getValue():null;if(t)return t=t.getObservableMembers().getValue(),i(t,e)},"capacity"===e?5e3:100)}var t=y.assign({},{monitor:{callback:y.bind(function(t,e,n){if(l!==t)v.D.info("[%s] Ignore old channel subscriber monitor stream [%s]. Active stream is [%s]",m,t,l);else{if(e)return r("unable-to-subscribe");if("app-background"===n.reason)return c(e,n);if(n.retry&&"high-availability"!==p.getStrategy())return v.D.info("Retrying to subscribe to channel [%s] after stream [%s] failed with reason [%s]",m,t,n.status),n.retry();var i=y.get(n,["status"],"");if("ok"!==i){if("custom"===n.reason&&"client-side-failure"!==n.description)return c(e,n);switch(i){case"ended":case"origin-ended":case"origin-stream-ended":p.markDead();break;default:p.markFailed({failedDueToCapacity:"capacity"===i})}return v.D.info("[%s] Monitor subscriber reported status [%s]. Trying next member",t,i),r(i)}}},this,n),options:{conditionCountForNotificationThreshold:8}}},a),s=l?u?"recovered-from-failure":"stream-override":"stream-started";l=n,v.Cs.subscribeToMemberStream(e,t,y.bind(function(t,e,n){if(l!==t)v.D.info("[%s] Ignore old media stream callback for stream [%s]. Active stream is [%s]",m,t,l);else{var i=y.get(n,["status"],"");if("ok"===i&&(n.reason=s),e||"ok"!==i){switch(v.D.info("[%s] Issue with stream [%s]. Trying next member",t,i,e),i){case"unauthorized":case"not-found":case"ended":case"origin-not-found":case"origin-ended":case"origin-stream-ended":case"unsupported-features":p.markDead();break;default:p.markFailed({failedDueToCapacity:"capacity"===i})}return r(i)}f=n&&n.mediaStream?n.mediaStream:l=null,c(e,n)}},this,n))},e=0;e<o.length;e++)r.push(o[e].getObservableScreenName().subscribe(t)),r.push(o[e].getObservableRole().subscribe(t)),r.push(o[e].getObservableStreams().subscribe(t));t()})},h.prototype.publishToChannel=function(t,e){if(i.h(t,"options"),i.g(e,"callback"),"capabilities"in t)throw new Error('"options.capabilities" is no longer supported. Please use "options.token" instead.');if("channel"in t)throw new Error('"options.channel" is no longer supported.');t=y.assign({memberRole:b.roles.presenter.name,streamType:a.types.presentation.name},t);this.Cs.publishToRoom(t,y.bind(k,null,e))},h.prototype.publishScreenToChannel=function(t,e){if(i.h(t,"options"),i.g(e,"callback"),"channel"in t)throw new Error('"options.channel" is no longer supported.');t=y.assign({memberRole:b.roles.presenter.name,streamType:a.types.presentation.name},t);this.Cs.publishScreenToRoom(t,y.bind(k,null,e))},h}.apply(e,n);void 0!==e&&(t.exports=e)},function(t,e,n){n=[n(0),n(1),n(42)],e=function(i,r,s){"use strict";function t(t){r.h(t,"roomService"),this.Be=t}function o(t,e,n){return n&&n.room&&(n.channel=new s(n.room),delete n.room),t(e,n)}return t.prototype.start=function(){return this.Be.start.apply(this.Be,arguments)},t.prototype.getChannelInfo=function(t,e,n){return t?r.R(t,"channelId"):r.R(e,"alias"),r.g(n,"callback"),this.Be.getRoomInfo(t,e,i.bind(o,null,n))},t.prototype.enterChannel=function(t,e,n){return t?r.R(t,"roomId"):r.R(e,"alias"),r.g(n,"callback"),this.Be.enterRoom(t,e,i.bind(o,null,n))},t.prototype.leaveChannel=function(){return this.Be.leaveRoom.apply(this.Be,arguments)},t.prototype.getChatService=function(){return this.Be.getChatService.apply(this.Be,arguments)},t.prototype.getSelf=function(){return this.Be.getSelf.apply(this.Be,arguments)},t.prototype.getObservableActiveChannel=function(){return this.Be.getObservableActiveRoom.apply(this.Be,arguments)},t.prototype.updateSelf=function(){return this.Be.updateSelf.apply(this.Be,arguments)},t.prototype.updateMember=function(){return this.Be.updateMember.apply(this.Be,arguments)},t.prototype.updateChannel=function(){return this.Be.updateRoom.apply(this.Be,arguments)},t.prototype.revertChannelChanges=function(){return this.Be.revertRoomChanges.apply(this.Be,arguments)},t.prototype.revertMemberChanges=function(){return this.Be.revertMemberChanges.apply(this.Be,arguments)},t.prototype.isInChannel=function(){return this.Be.isInRoom.apply(this.Be,arguments)},t.prototype.toString=function(){return"ChannelService"},t.prototype.stop=function(){return this.Be.stop.apply(this.Be,arguments)},t}.apply(e,n);void 0!==e&&(t.exports=e)}],i={},r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=43);function r(t){var e;return(i[t]||(e=i[t]={i:t,l:!1,exports:{}},n[t].call(e.exports,e,e.exports,r),e.l=!0,e)).exports}var n,i});